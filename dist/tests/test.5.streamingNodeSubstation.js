var _0xbfd9=['current|max|86400000','current|min|86400000','current|variance|86400000','voltage|ma|86400000','voltage|max|86400000','voltage|min|86400000','voltage|variance|86400000','current|ma|604800000','static','timeOfDay','weekEnd','dayAfterHoliday','dayBeforeHoliday','dayOfYear','weather','temperature1','humidity1','windSpeed1','cloudCover1','./db2/','createFolder','Base','createClean','nodes','close','initialization','base\x20saved','base','check\x20if\x20store\x20exists','equal','rawstore','name','check\x20store\x20structure','deepEqual','fields','Time','datetime','float','voltage','aggregates\x20initialized\x20-\x20number','keys','length','aggregates\x20initialized\x20-\x20key\x20names','current|tick','current|winbuf|3600000','current|winbuf|21600000','current|variance|21600000','current|winbuf|604800000','voltage|tick','voltage|winbuf|3600000','voltage|winbuf|86400000','voltage|winbuf|604800000','voltage|ma|604800000','config\x20saved','fusionNodeI\x20correctly\x20saved','fusionNodeI','callback\x20function\x20should\x20be\x20set','function','parent\x20saved','buffer','buffer\x20position\x20is\x200','position','master\x20flag\x20set\x20correctly','master','isMaster\x20function','isMaster','connectToKafka','broadcastAggregates\x20function\x20exists','broadcastAggregates','createAggregates\x20function\x20exists','createAggregates','offsetExists','deleteObsoleteRows','checkDataAvailability\x20function\x20exists','checkDataAvailability','setSlaveOffset\x20function\x20exists','setSlaveOffset','getOffsetTimestamp','getAggregates\x20function\x20exists','getAggregates','getPartialFeatureVector\x20function\x20exists','getPartialFeatureVector','master\x20set\x20correctly','setMasterOffset','data\x20record\x20saved\x20correctly','processRecord','{\x22timestamp\x22:1538737200000,\x22current\x22:12,\x22voltage\x22:232.45}','parse','{\x22timestamp\x22:1538737201000,\x22current\x22:13,\x22voltage\x22:242.45}','{\x22timestamp\x22:1538737202000,\x22current\x22:14,\x22voltage\x22:252.45}','{\x22timestamp\x22:1538737213000,\x22current\x22:15,\x22voltage\x22:262.45}','{\x22timestamp\x22:1538737200000,\x22current\x22:16,\x22voltage\x22:232.45}','{\x22timestamp\x22:1538737201000,\x22current\x22:17,\x22voltage\x22:242.45}','{\x22timestamp\x22:1538737202000,\x22current\x22:18,\x22voltage\x22:252.45}','{\x22timestamp\x22:1538737213000,\x22current\x22:19,\x22voltage\x22:262.45}','log','buffer\x20values','../nodes/streamingEnergyNode.js','../nodes/streamingWeatherNode.js','../nodes/streamingStaticNode.js','../utils/fileManager.js','qminer','assert','192.168.85.98:2181','current','winbuf','max','min','variance','holiday','N1_24h','kafka','Substation','value','current|ma|000','voltage|ma|000','current|ma|3600000','voltage|ma|3600000','current|ma|21600000','current|min|21600000','voltage|ma|21600000','voltage|max|21600000','voltage|min|21600000','voltage|variance|21600000','current|ma|86400000'];(function(_0x4dad4b,_0x380ba2){var _0x41fa00=function(_0x59cb7d){while(--_0x59cb7d){_0x4dad4b['push'](_0x4dad4b['shift']());}};var _0x124a8f=function(){var _0x587109={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x2c5317,_0x21917b,_0x16893b,_0x77f9a9){_0x77f9a9=_0x77f9a9||{};var _0x15a635=_0x21917b+'='+_0x16893b;var _0x46bc01=0x0;for(var _0x46bc01=0x0,_0x57c2b2=_0x2c5317['length'];_0x46bc01<_0x57c2b2;_0x46bc01++){var _0x293996=_0x2c5317[_0x46bc01];_0x15a635+=';\x20'+_0x293996;var _0x3aad85=_0x2c5317[_0x293996];_0x2c5317['push'](_0x3aad85);_0x57c2b2=_0x2c5317['length'];if(_0x3aad85!==!![]){_0x15a635+='='+_0x3aad85;}}_0x77f9a9['cookie']=_0x15a635;},'removeCookie':function(){return'dev';},'getCookie':function(_0xd52f0b,_0x31e2e5){_0xd52f0b=_0xd52f0b||function(_0x58e677){return _0x58e677;};var _0x3823a9=_0xd52f0b(new RegExp('(?:^|;\x20)'+_0x31e2e5['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x3f5862=function(_0x5e8d6f,_0x1c8857){_0x5e8d6f(++_0x1c8857);};_0x3f5862(_0x41fa00,_0x380ba2);return _0x3823a9?decodeURIComponent(_0x3823a9[0x1]):undefined;}};var _0x486fbf=function(){var _0x4d871f=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x4d871f['test'](_0x587109['removeCookie']['toString']());};_0x587109['updateCookie']=_0x486fbf;var _0x1ba61e='';var _0x2d63a9=_0x587109['updateCookie']();if(!_0x2d63a9){_0x587109['setCookie'](['*'],'counter',0x1);}else if(_0x2d63a9){_0x1ba61e=_0x587109['getCookie'](null,'counter');}else{_0x587109['removeCookie']();}};_0x124a8f();}(_0xbfd9,0xde));var _0x1ca4=function(_0x50b579,_0x1a4950){_0x50b579=_0x50b579-0x0;var _0x2267d5=_0xbfd9[_0x50b579];return _0x2267d5;};var _0x26879d=function(){var _0x3a034e=!![];return function(_0x42782b,_0x57a9e8){var _0x82727e=_0x3a034e?function(){if(_0x57a9e8){var _0x2e12ae=_0x57a9e8['apply'](_0x42782b,arguments);_0x57a9e8=null;return _0x2e12ae;}}:function(){};_0x3a034e=![];return _0x82727e;};}();var _0xf64f14=_0x26879d(this,function(){var _0xf34179=function(){return'\x64\x65\x76';},_0x5b6b9b=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0xe0020f=function(){var _0x6df83c=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x6df83c['\x74\x65\x73\x74'](_0xf34179['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x3dd9cc=function(){var _0x31d57f=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x31d57f['\x74\x65\x73\x74'](_0x5b6b9b['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x4f9c65=function(_0x534a58){var _0x3d4d53=~-0x1>>0x1+0xff%0x0;if(_0x534a58['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x3d4d53)){_0x3ce43a(_0x534a58);}};var _0x3ce43a=function(_0x521967){var _0x15d43f=~-0x4>>0x1+0xff%0x0;if(_0x521967['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x15d43f){_0x4f9c65(_0x521967);}};if(!_0xe0020f()){if(!_0x3dd9cc()){_0x4f9c65('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x4f9c65('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x4f9c65('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0xf64f14();const streamingNode=require('../nodes/streamingNode.js');const streamingEnergyNode=require(_0x1ca4('0x0'));const streamingWeatherNode=require(_0x1ca4('0x1'));const streamingStaticNode=require(_0x1ca4('0x2'));const streamingTrainNode=require('../nodes/streamingTrainNode.js');const streamingSubstationNode=require('../nodes/streamingSubstationNode.js');const fileManager=require(_0x1ca4('0x3'));const qm=require(_0x1ca4('0x4'));const fs=require('fs');var assert=require(_0x1ca4('0x5'));let connectionConfig={'zookeeper':_0x1ca4('0x6')};let aggrConfigs={'Substation':[{'field':_0x1ca4('0x7'),'tick':[{'type':_0x1ca4('0x8'),'winsize':0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]},{'type':_0x1ca4('0x8'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x1ca4('0x9')},{'type':_0x1ca4('0xa')},{'type':_0x1ca4('0xb')}]},{'type':_0x1ca4('0x8'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x1ca4('0x9')},{'type':_0x1ca4('0xa')},{'type':_0x1ca4('0xb')}]},{'type':_0x1ca4('0x8'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]},{'field':'voltage','tick':[{'type':'winbuf','winsize':0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]},{'type':_0x1ca4('0x8'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x1ca4('0x9')},{'type':_0x1ca4('0xa')},{'type':'variance'}]},{'type':'winbuf','winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x1ca4('0x9')},{'type':_0x1ca4('0xa')},{'type':_0x1ca4('0xb')}]},{'type':_0x1ca4('0x8'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}],'weather':[],'static':[{'field':_0x1ca4('0xc'),'tick':[{'type':'winbuf','winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]};let fusionConfig={'fusionModel':_0x1ca4('0xd'),'connection':{'type':_0x1ca4('0xe')},'fusionTick':0x3e8,'nodes':[{'type':_0x1ca4('0xf'),'fusionTick':0x3e8,'nodeid':'N1','aggrConfigId':'Substation','master':!![],'attributes':[{'time':0x0,'attributes':[{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x11')},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x12')}]},{'time':-0xe10*0x3e8,'attributes':[{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x13')},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x14')}]},{'time':-0x6*0xe10*0x3e8,'attributes':[{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x15')},{'type':_0x1ca4('0x10'),'name':'current|max|21600000'},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x16')},{'type':_0x1ca4('0x10'),'name':'current|variance|21600000'},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x17')},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x18')},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x19')},{'type':'value','name':_0x1ca4('0x1a')}]},{'time':-0x18*0xe10*0x3e8,'attributes':[{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x1b')},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x1c')},{'type':'value','name':_0x1ca4('0x1d')},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x1e')},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x1f')},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x20')},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x21')},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x22')}]},{'time':-0x7*0x18*0xe10*0x3e8,'attributes':[{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x23')},{'type':_0x1ca4('0x10'),'name':'voltage|ma|604800000'}]}]},{'type':_0x1ca4('0x24'),'nodeid':'S1','aggrConfigId':_0x1ca4('0x24'),'master':![],'attributes':[{'time':0x18*0x168*0x3e8,'attributes':[{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x25')},{'type':'value','name':_0x1ca4('0x26')},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0xc')},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x27')},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x28')},{'type':'value','name':'dayOfWeek'},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x29')},{'type':_0x1ca4('0x10'),'name':'monthOfYear'}]}]},{'type':_0x1ca4('0x2a'),'nodeid':'W1','aggrConfigId':'weather','master':![],'attributes':[{'time':0x0,'attributes':[{'type':'value','name':_0x1ca4('0x2b')},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x2c')},{'type':_0x1ca4('0x10'),'name':'pressure1'},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x2d')},{'type':_0x1ca4('0x10'),'name':'windBearing1'},{'type':_0x1ca4('0x10'),'name':_0x1ca4('0x2e')}]}]}]};function processRecordDummyCb(_0x36e72c,_0x2b01c3){return!![];}describe('streamingSubstationNode',function(){let _0x4ff27;let _0x20d9c3;before(function(){fileManager['removeFolder'](_0x1ca4('0x2f'));fileManager[_0x1ca4('0x30')](_0x1ca4('0x2f'));_0x4ff27=new qm[(_0x1ca4('0x31'))]({'dbPath':_0x1ca4('0x2f'),'mode':_0x1ca4('0x32')});sen=new streamingSubstationNode(_0x4ff27,connectionConfig,fusionConfig[_0x1ca4('0x33')][0x0],aggrConfigs,processRecordDummyCb,0x63,null);});after(function(){_0x4ff27[_0x1ca4('0x34')]();});describe(_0x1ca4('0x35'),function(){it(_0x1ca4('0x36'),function(){assert['equal'](_0x4ff27,sen[_0x1ca4('0x37')]);});it(_0x1ca4('0x38'),function(){assert[_0x1ca4('0x39')](sen[_0x1ca4('0x3a')][_0x1ca4('0x3b')],'N1');});it(_0x1ca4('0x3c'),function(){assert[_0x1ca4('0x3d')](sen['rawstore'][_0x1ca4('0x3e')],[{'id':0x0,'name':_0x1ca4('0x3f'),'type':_0x1ca4('0x40'),'nullable':![],'internal':![],'primary':![]},{'id':0x1,'name':'current','type':_0x1ca4('0x41'),'nullable':![],'internal':![],'primary':![]},{'id':0x2,'name':_0x1ca4('0x42'),'type':_0x1ca4('0x41'),'nullable':![],'internal':![],'primary':![]},{'id':0x3,'name':'power','type':_0x1ca4('0x41'),'nullable':![],'internal':![],'primary':![]}]);});it(_0x1ca4('0x43'),function(){assert[_0x1ca4('0x39')](Object[_0x1ca4('0x44')](sen['aggregate'])[_0x1ca4('0x45')],0x1e);});it(_0x1ca4('0x46'),function(){assert[_0x1ca4('0x3d')](Object['keys'](sen['aggregate']),[_0x1ca4('0x47'),_0x1ca4('0x48'),_0x1ca4('0x13'),_0x1ca4('0x49'),'current|ma|21600000','current|max|21600000','current|min|21600000',_0x1ca4('0x4a'),'current|winbuf|86400000','current|ma|86400000',_0x1ca4('0x1c'),_0x1ca4('0x1d'),_0x1ca4('0x1e'),_0x1ca4('0x4b'),_0x1ca4('0x23'),_0x1ca4('0x4c'),_0x1ca4('0x4d'),'voltage|ma|3600000','voltage|winbuf|21600000',_0x1ca4('0x17'),'voltage|max|21600000',_0x1ca4('0x19'),_0x1ca4('0x1a'),_0x1ca4('0x4e'),_0x1ca4('0x1f'),_0x1ca4('0x20'),_0x1ca4('0x21'),_0x1ca4('0x22'),_0x1ca4('0x4f'),_0x1ca4('0x50')]);});it(_0x1ca4('0x51'),function(){assert[_0x1ca4('0x3d')](sen['config'],fusionConfig['nodes'][0x0]);});it(_0x1ca4('0x52'),function(){assert[_0x1ca4('0x39')](sen[_0x1ca4('0x53')],0x63);});it(_0x1ca4('0x54'),function(){assert['equal'](typeof sen['processRecordCb'],_0x1ca4('0x55'));});it(_0x1ca4('0x56'),function(){assert[_0x1ca4('0x39')](sen['parent'],null);});it('buffer\x20empty',function(){assert[_0x1ca4('0x3d')](sen[_0x1ca4('0x57')],[]);});it(_0x1ca4('0x58'),function(){assert[_0x1ca4('0x39')](sen[_0x1ca4('0x59')],0x0);});it(_0x1ca4('0x5a'),function(){assert[_0x1ca4('0x39')](sen[_0x1ca4('0x5b')],!![]);});it(_0x1ca4('0x5c'),function(){assert['equal'](sen[_0x1ca4('0x5d')](),!![]);});it('connectToKafka\x20function\x20exists',function(){assert['equal'](typeof sen[_0x1ca4('0x5e')],_0x1ca4('0x55'));});it(_0x1ca4('0x5f'),function(){assert['equal'](typeof sen[_0x1ca4('0x60')],'function');});it(_0x1ca4('0x61'),function(){assert[_0x1ca4('0x39')](typeof sen[_0x1ca4('0x62')],_0x1ca4('0x55'));});it('offsetExists\x20function\x20exists',function(){assert['equal'](typeof sen[_0x1ca4('0x63')],'function');});it('deleteObsoleteRows\x20function\x20exists',function(){assert['equal'](typeof sen[_0x1ca4('0x64')],_0x1ca4('0x55'));});it(_0x1ca4('0x65'),function(){assert[_0x1ca4('0x39')](typeof sen[_0x1ca4('0x66')],_0x1ca4('0x55'));});it(_0x1ca4('0x67'),function(){assert[_0x1ca4('0x39')](typeof sen[_0x1ca4('0x68')],'function');});it('getOffsetTimestamp\x20function\x20exists',function(){assert[_0x1ca4('0x39')](typeof sen[_0x1ca4('0x69')],_0x1ca4('0x55'));});it('setMasterOffset\x20function\x20exists',function(){assert['equal'](typeof sen[_0x1ca4('0x69')],'function');});it(_0x1ca4('0x6a'),function(){assert[_0x1ca4('0x39')](typeof sen[_0x1ca4('0x6b')],_0x1ca4('0x55'));});it(_0x1ca4('0x6c'),function(){assert['equal'](typeof sen[_0x1ca4('0x6d')],_0x1ca4('0x55'));});it(_0x1ca4('0x6e'),function(){assert[_0x1ca4('0x39')](sen['isMaster'](),!![]);});it('master\x20offset\x20set\x20correctly',function(){sen[_0x1ca4('0x6f')]();assert['equal'](sen[_0x1ca4('0x59')],-0x1);});it('slave\x20offset\x20set\x20correctly:\x20no\x20data',function(){assert[_0x1ca4('0x39')](sen[_0x1ca4('0x68')](0x0),![]);});});describe('data\x20insertion',function(){it(_0x1ca4('0x70'),function(){sen[_0x1ca4('0x71')](JSON['parse'](_0x1ca4('0x72')));sen['processRecord'](JSON[_0x1ca4('0x73')](_0x1ca4('0x74')));sen[_0x1ca4('0x71')](JSON[_0x1ca4('0x73')](_0x1ca4('0x75')));sen['processRecord'](JSON[_0x1ca4('0x73')](_0x1ca4('0x76')));sen['processRecord'](JSON[_0x1ca4('0x73')](_0x1ca4('0x77')));sen[_0x1ca4('0x71')](JSON[_0x1ca4('0x73')](_0x1ca4('0x78')));sen[_0x1ca4('0x71')](JSON[_0x1ca4('0x73')](_0x1ca4('0x79')));sen[_0x1ca4('0x71')](JSON[_0x1ca4('0x73')](_0x1ca4('0x7a')));console[_0x1ca4('0x7b')](_0x1ca4('0x7c'));console['log'](sen[_0x1ca4('0x57')]);});});});