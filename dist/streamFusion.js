var _0x173a=['isMaster','getOffsetTimestamp','setSlaveOffset','checkDataAvailability','broadcastPrediction','broadcastFeatureVector','lastTimestamp','lastFeatureVector','cleanupData','buildFeatureVector','Can\x20not\x20be\x20generated!','concat','appendFileSync','./data/','.json','publish','deleteObsoleteRows','save','exports','qminer','./nodes/streamingNode.js','./streamModel.js','./brokers/brokers.js','config','parse','connectionConfig','stringify','masterNodeId','masterSatisfied','fusion_id','fusionModel','topic','features_','fusionTick','dbPath','./db/','existsSync','./db','mkdirSync','base','Base','createClean','nodes','substation','push','processRecordHook','type','energy','train','static','weather','log','ERROR:\x20Streaming\x20node\x20type\x20not\x20found!','Created\x20','length','\x20nodes.','model','streamModel','predictions_','connection','kafka','broker','addPublisher','buffer','allNodesAvailable'];(function(_0x24202e,_0x3a8ad5){var _0x3736c2=function(_0x483107){while(--_0x483107){_0x24202e['push'](_0x24202e['shift']());}};var _0x344d6e=function(){var _0x78ea0e={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x1591f0,_0x260b99,_0x208a3d,_0x1231aa){_0x1231aa=_0x1231aa||{};var _0x57dc27=_0x260b99+'='+_0x208a3d;var _0x53c345=0x0;for(var _0x53c345=0x0,_0x30527e=_0x1591f0['length'];_0x53c345<_0x30527e;_0x53c345++){var _0x2ead62=_0x1591f0[_0x53c345];_0x57dc27+=';\x20'+_0x2ead62;var _0xd9817f=_0x1591f0[_0x2ead62];_0x1591f0['push'](_0xd9817f);_0x30527e=_0x1591f0['length'];if(_0xd9817f!==!![]){_0x57dc27+='='+_0xd9817f;}}_0x1231aa['cookie']=_0x57dc27;},'removeCookie':function(){return'dev';},'getCookie':function(_0x3ba971,_0x34ff06){_0x3ba971=_0x3ba971||function(_0xff96a1){return _0xff96a1;};var _0x140648=_0x3ba971(new RegExp('(?:^|;\x20)'+_0x34ff06['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x1d3133=function(_0x5b9e8c,_0x38c469){_0x5b9e8c(++_0x38c469);};_0x1d3133(_0x3736c2,_0x3a8ad5);return _0x140648?decodeURIComponent(_0x140648[0x1]):undefined;}};var _0x409bd9=function(){var _0x37b65d=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x37b65d['test'](_0x78ea0e['removeCookie']['toString']());};_0x78ea0e['updateCookie']=_0x409bd9;var _0x2c8d1e='';var _0x44e88f=_0x78ea0e['updateCookie']();if(!_0x44e88f){_0x78ea0e['setCookie'](['*'],'counter',0x1);}else if(_0x44e88f){_0x2c8d1e=_0x78ea0e['getCookie'](null,'counter');}else{_0x78ea0e['removeCookie']();}};_0x344d6e();}(_0x173a,0x158));var _0x16e3=function(_0xc40c11,_0x32bbb2){_0xc40c11=_0xc40c11-0x0;var _0x4e269a=_0x173a[_0xc40c11];return _0x4e269a;};var _0x2ad1e6=function(){var _0x35e7a8=!![];return function(_0x1b176f,_0x34e05e){var _0x220b94=_0x35e7a8?function(){if(_0x34e05e){var _0x5947fe=_0x34e05e['apply'](_0x1b176f,arguments);_0x34e05e=null;return _0x5947fe;}}:function(){};_0x35e7a8=![];return _0x220b94;};}();var _0x5f37d6=_0x2ad1e6(this,function(){var _0x2db370=function(){return'\x64\x65\x76';},_0x510d2e=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x4e7797=function(){var _0x5a4767=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x5a4767['\x74\x65\x73\x74'](_0x2db370['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x5481f1=function(){var _0x16ce09=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x16ce09['\x74\x65\x73\x74'](_0x510d2e['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x194fb1=function(_0x2cedb4){var _0x49398b=~-0x1>>0x1+0xff%0x0;if(_0x2cedb4['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x49398b)){_0x1530a1(_0x2cedb4);}};var _0x1530a1=function(_0x10e19b){var _0x1587ff=~-0x4>>0x1+0xff%0x0;if(_0x10e19b['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x1587ff){_0x194fb1(_0x10e19b);}};if(!_0x4e7797()){if(!_0x5481f1()){_0x194fb1('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x194fb1('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x194fb1('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x5f37d6();const qm=require(_0x16e3('0x0'));const fs=require('fs');const streamingNode=require(_0x16e3('0x1'));const streamingEnergyNode=require('./nodes/streamingEnergyNode.js');const streamingSubstationNode=require('./nodes/streamingSubstationNode.js');const streamingTrainNode=require('./nodes/streamingTrainNode.js');const streamingWeatherNode=require('./nodes/streamingWeatherNode.js');const streamingStaticNode=require('./nodes/streamingStaticNode.js');const streamModel=require(_0x16e3('0x2'));const {AbstractBroker,KafkaNodeBroker,MQTTBroker,KafkaRDBroker}=require(_0x16e3('0x3'));class streamFusion{constructor(_0x3a2e7f,_0x34ebcc,_0x150877){let _0x20e25f=this;this[_0x16e3('0x4')]=JSON[_0x16e3('0x5')](JSON['stringify'](_0x34ebcc));this[_0x16e3('0x6')]=JSON['parse'](JSON[_0x16e3('0x7')](_0x3a2e7f));this['nodes']=[];this[_0x16e3('0x8')]=-0x1;this[_0x16e3('0x9')]=!![];this['lastTimestamp']=0x0;this['lastFeatureVector']=[];this['allNodesAvailable']=![];this[_0x16e3('0xa')]=_0x34ebcc[_0x16e3('0xb')];this[_0x16e3('0xc')]=_0x16e3('0xd')+this[_0x16e3('0xa')];this[_0x16e3('0xe')]=_0x34ebcc[_0x16e3('0xe')];this[_0x16e3('0xf')]=_0x16e3('0x10')+this['fusion_id'];if(!fs[_0x16e3('0x11')](_0x16e3('0x12'))){fs[_0x16e3('0x13')](_0x16e3('0x12'));}if(!fs[_0x16e3('0x11')](this['dbPath'])){fs[_0x16e3('0x13')](this[_0x16e3('0xf')]);}this[_0x16e3('0x14')]=new qm[(_0x16e3('0x15'))]({'dbPath':this[_0x16e3('0xf')],'mode':_0x16e3('0x16')});for(let _0x5b950a in _0x34ebcc[_0x16e3('0x17')]){let _0x4a3ff4=_0x34ebcc[_0x16e3('0x17')][_0x5b950a];_0x4a3ff4['fusionTick']=this[_0x16e3('0xe')];if(_0x4a3ff4['master']==!![])this[_0x16e3('0x8')]=_0x5b950a;if(_0x4a3ff4['type']==_0x16e3('0x18')){this[_0x16e3('0x17')][_0x16e3('0x19')](new streamingSubstationNode(this[_0x16e3('0x14')],this[_0x16e3('0x6')],_0x4a3ff4,_0x150877,_0x20e25f[_0x16e3('0x1a')],_0x5b950a,_0x20e25f));}else if(_0x4a3ff4[_0x16e3('0x1b')]==_0x16e3('0x1c')){this[_0x16e3('0x17')][_0x16e3('0x19')](new streamingEnergyNode(this[_0x16e3('0x14')],this[_0x16e3('0x6')],_0x4a3ff4,_0x150877,_0x20e25f[_0x16e3('0x1a')],_0x5b950a,_0x20e25f));}else if(_0x4a3ff4[_0x16e3('0x1b')]==_0x16e3('0x1d')){this[_0x16e3('0x17')]['push'](new streamingTrainNode(this['base'],this[_0x16e3('0x6')],_0x4a3ff4,_0x150877,_0x20e25f[_0x16e3('0x1a')],_0x5b950a,_0x20e25f));}else if(_0x4a3ff4['type']==_0x16e3('0x1e')){this['nodes']['push'](new streamingStaticNode(this[_0x16e3('0x14')],this[_0x16e3('0x6')],_0x4a3ff4,_0x150877,_0x20e25f[_0x16e3('0x1a')],_0x5b950a,_0x20e25f));}else if(_0x4a3ff4[_0x16e3('0x1b')]==_0x16e3('0x1f')){this[_0x16e3('0x17')]['push'](new streamingWeatherNode(this['base'],this['connectionConfig'],_0x4a3ff4,_0x150877,_0x20e25f[_0x16e3('0x1a')],_0x5b950a,_0x20e25f));}else{console[_0x16e3('0x20')](_0x16e3('0x21'));}}console[_0x16e3('0x20')](_0x16e3('0x22')+this[_0x16e3('0x17')][_0x16e3('0x23')]+_0x16e3('0x24'));if(_0x16e3('0x25')in _0x34ebcc){this[_0x16e3('0x26')]=new streamModel(_0x34ebcc,_0x20e25f);this[_0x16e3('0xc')]=_0x16e3('0x27')+this[_0x16e3('0xa')];}if(_0x16e3('0x28')in _0x34ebcc){if(_0x34ebcc['connection']['type']==_0x16e3('0x29')){this[_0x16e3('0x2a')]=new KafkaNodeBroker(this['connectionConfig'],this[_0x16e3('0xc')],this[_0x16e3('0xa')]);this['broker'][_0x16e3('0x2b')]();}else if(_0x34ebcc[_0x16e3('0x28')][_0x16e3('0x1b')]=='mqtt'){this[_0x16e3('0x2a')]=new MQTTBroker(this[_0x16e3('0x6')],this['topic'],this[_0x16e3('0xa')]);this[_0x16e3('0x2a')]['addPublisher']();}else{this[_0x16e3('0x2a')]=new AbstractBroker(this[_0x16e3('0x6')],this[_0x16e3('0xc')],this[_0x16e3('0xa')]);}}}[_0x16e3('0x1a')](_0x40660d,_0xe332){if(!_0xe332['allNodesAvailable']){for(let _0x7ee14a in _0xe332['nodes']){if(_0xe332['nodes'][_0x7ee14a][_0x16e3('0x2c')][_0x16e3('0x23')]==0x0){return null;}}_0xe332[_0x16e3('0x2d')]=!![];}if(_0xe332['nodes'][_0xe332[_0x16e3('0x8')]][_0x16e3('0x2c')][_0x16e3('0x23')]>0x0&&_0xe332['masterSatisfied']==![]){_0x40660d=_0xe332[_0x16e3('0x8')];};if(_0xe332[_0x16e3('0x17')][_0x40660d][_0x16e3('0x2e')]()==!![]){_0xe332[_0x16e3('0x17')][_0x40660d]['setMasterOffset']();let _0x1b7001=_0xe332[_0x16e3('0x17')][_0x40660d][_0x16e3('0x2f')]();let _0xed7343=!![];for(let _0x2e4f23 in _0xe332[_0x16e3('0x17')]){if(_0x2e4f23!=_0x40660d){if(_0xe332[_0x16e3('0x17')][_0x2e4f23][_0x16e3('0x30')](_0x1b7001)){if(!_0xe332[_0x16e3('0x17')][_0x2e4f23][_0x16e3('0x31')]()){_0xed7343=![];}}else{_0xed7343=![];}}}if(_0xed7343&&_0xe332['lastTimestamp']!=_0x1b7001){_0xe332[_0x16e3('0x9')]=!![];let _0x31f6e5=_0xe332['buildFeatureVector']();if('model'in _0xe332['config']){let _0x3f3b25;if(_0x31f6e5[_0x16e3('0x23')]!=0x0){_0x3f3b25=_0xe332['streamModel']['updateStream'](_0x31f6e5,_0x1b7001);_0xe332[_0x16e3('0x32')](_0x3f3b25[0x0],_0x3f3b25[0x1],_0x3f3b25[0x2]);}}else{_0xe332[_0x16e3('0x33')](_0x1b7001,_0x31f6e5);}_0xe332[_0x16e3('0x34')]=_0x1b7001;_0xe332[_0x16e3('0x35')]=_0x31f6e5;_0xe332[_0x16e3('0x36')]();}else{console['log']('Data\x20not\x20available.');_0xe332[_0x16e3('0x9')]=![];}}else{if(!_0xe332['masterSatisfied']){}}}[_0x16e3('0x37')](){let _0x4da4ef=[];for(let _0x3dbed9 in this['nodes']){let _0x4d6429=this['nodes'][_0x3dbed9][_0x16e3('0x31')]();if(_0x4d6429==![]){console[_0x16e3('0x20')](_0x16e3('0x38'));return[];}let _0x42d5f7=this[_0x16e3('0x17')][_0x3dbed9]['getPartialFeatureVector']();_0x4da4ef=_0x4da4ef[_0x16e3('0x39')](_0x42d5f7);}return _0x4da4ef;}[_0x16e3('0x33')](_0xa83253,_0x166bf4){let _0x1d802c=JSON['stringify']({'timestamp':_0xa83253,'ftr_vector':_0x166bf4});if(_0x166bf4!=[])fs[_0x16e3('0x3a')](_0x16e3('0x3b')+this[_0x16e3('0xa')]+_0x16e3('0x3c'),_0x1d802c+'\x0a');this[_0x16e3('0x2a')][_0x16e3('0x3d')](_0x1d802c);}['broadcastPrediction'](_0x2f04ef,_0x3262ac,_0x4686f1){let _0x3948ef={'timestamp':_0x2f04ef,'value':_0x3262ac,'horizon':_0x4686f1};this[_0x16e3('0x2a')][_0x16e3('0x3d')](_0x3948ef);}[_0x16e3('0x36')](){for(let _0x1d0020 in this[_0x16e3('0x17')]){this[_0x16e3('0x17')][_0x1d0020][_0x16e3('0x3e')]();}}[_0x16e3('0x3f')](){}}module[_0x16e3('0x40')]=streamFusion;