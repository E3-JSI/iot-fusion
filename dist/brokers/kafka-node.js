var _0x27f8=['log','StreamFusion\x20HLP\x20for\x20Kafka:\x20','topic','HighLevelProducer','config','zookeeper','producer','Consumer','client','Client','consumer','offset','Offset','message','parse','Error','outOfRange','maxNum','error','min','partition','setOffset','Feature\x20Vector\x20-->\x20Kafka:\x20(err)',',\x20(data)','exports','./abstract.js','kafka-node'];(function(_0x1326d9,_0x3e05fe){var _0x36abc1=function(_0x3c58b6){while(--_0x3c58b6){_0x1326d9['push'](_0x1326d9['shift']());}};var _0x251dbf=function(){var _0x1cf4e8={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x3ac3ab,_0xdf8f3d,_0x334c05,_0x2a8ba7){_0x2a8ba7=_0x2a8ba7||{};var _0x5ba9d6=_0xdf8f3d+'='+_0x334c05;var _0xd3d54e=0x0;for(var _0xd3d54e=0x0,_0x29e4ed=_0x3ac3ab['length'];_0xd3d54e<_0x29e4ed;_0xd3d54e++){var _0x1b8cb4=_0x3ac3ab[_0xd3d54e];_0x5ba9d6+=';\x20'+_0x1b8cb4;var _0x32781b=_0x3ac3ab[_0x1b8cb4];_0x3ac3ab['push'](_0x32781b);_0x29e4ed=_0x3ac3ab['length'];if(_0x32781b!==!![]){_0x5ba9d6+='='+_0x32781b;}}_0x2a8ba7['cookie']=_0x5ba9d6;},'removeCookie':function(){return'dev';},'getCookie':function(_0x28e254,_0x353cf0){_0x28e254=_0x28e254||function(_0x20d8a7){return _0x20d8a7;};var _0x348395=_0x28e254(new RegExp('(?:^|;\x20)'+_0x353cf0['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0xbe3243=function(_0x29c54f,_0x100181){_0x29c54f(++_0x100181);};_0xbe3243(_0x36abc1,_0x3e05fe);return _0x348395?decodeURIComponent(_0x348395[0x1]):undefined;}};var _0x4af5b4=function(){var _0x11e8a8=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x11e8a8['test'](_0x1cf4e8['removeCookie']['toString']());};_0x1cf4e8['updateCookie']=_0x4af5b4;var _0x4f6b7a='';var _0xd09f7=_0x1cf4e8['updateCookie']();if(!_0xd09f7){_0x1cf4e8['setCookie'](['*'],'counter',0x1);}else if(_0xd09f7){_0x4f6b7a=_0x1cf4e8['getCookie'](null,'counter');}else{_0x1cf4e8['removeCookie']();}};_0x251dbf();}(_0x27f8,0x1ae));var _0x38a4=function(_0x43f571,_0x173421){_0x43f571=_0x43f571-0x0;var _0x541bb1=_0x27f8[_0x43f571];return _0x541bb1;};var _0x18868d=function(){var _0x371a09=!![];return function(_0x16d8b0,_0x9f1abf){var _0x37d511=_0x371a09?function(){if(_0x9f1abf){var _0x4998da=_0x9f1abf['apply'](_0x16d8b0,arguments);_0x9f1abf=null;return _0x4998da;}}:function(){};_0x371a09=![];return _0x37d511;};}();var _0x15dbb2=_0x18868d(this,function(){var _0x238ba3=function(){return'\x64\x65\x76';},_0x5c3983=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x5dd677=function(){var _0x344134=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x344134['\x74\x65\x73\x74'](_0x238ba3['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0xbba347=function(){var _0xa918c7=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0xa918c7['\x74\x65\x73\x74'](_0x5c3983['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x1f1694=function(_0x593036){var _0x5534ec=~-0x1>>0x1+0xff%0x0;if(_0x593036['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x5534ec)){_0x34a28c(_0x593036);}};var _0x34a28c=function(_0x5b6251){var _0x452baa=~-0x4>>0x1+0xff%0x0;if(_0x5b6251['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x452baa){_0x1f1694(_0x5b6251);}};if(!_0x5dd677()){if(!_0xbba347()){_0x1f1694('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x1f1694('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x1f1694('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x15dbb2();let Broker=require(_0x38a4('0x0'));const kafka=require(_0x38a4('0x1'));class KafkaNodeBroker extends Broker{constructor(_0x23af94,_0x1c61e7,_0x5324f5){super(_0x23af94,_0x1c61e7,_0x5324f5);}['addPublisher'](){console[_0x38a4('0x2')](_0x38a4('0x3')+this[_0x38a4('0x4')]);let _0x27249f=kafka[_0x38a4('0x5')];let _0x5dbe63=new kafka['Client'](this[_0x38a4('0x6')][_0x38a4('0x7')],_0x38a4('0x8')+this['clientId']);this[_0x38a4('0x8')]=new _0x27249f(_0x5dbe63);}['addListener'](_0x2c854c){console[_0x38a4('0x2')]('Connecting\x20to\x20Kafka:\x20'+this[_0x38a4('0x4')]);this[_0x38a4('0x9')]=kafka[_0x38a4('0x9')];this[_0x38a4('0xa')]=new kafka[(_0x38a4('0xb'))](this[_0x38a4('0x6')][_0x38a4('0x7')],_0x38a4('0xc')+this['clientId']);this[_0x38a4('0xd')]=new kafka[(_0x38a4('0xe'))](this[_0x38a4('0xa')]);let _0x20cc38=this;this['consumer']=new this['Consumer'](this['client'],[{'topic':this['topic'],'partition':0x0}],{'groupId':this['id']});this[_0x38a4('0xc')]['on'](_0x38a4('0xf'),function(_0x24847f){try{let _0x53d8d7=JSON[_0x38a4('0x10')](_0x24847f['value']);_0x2c854c(_0x53d8d7);}catch(_0x33cce3){console[_0x38a4('0x2')]('ERROR',_0x33cce3);}});this['consumer']['on']('error',function(_0x109c15){console[_0x38a4('0x2')](_0x38a4('0x11'),_0x109c15);});this[_0x38a4('0xc')]['on']('offsetOutOfRange',function(_0x36f071){console['log'](_0x20cc38['id'],_0x38a4('0x12'),_0x36f071);_0x36f071[_0x38a4('0x13')]=0x2;_0x20cc38[_0x38a4('0xd')]['fetch']([_0x36f071],function(_0x3383ec,_0x4b566f){if(_0x3383ec){return console[_0x38a4('0x14')](_0x3383ec);}var _0x4ebb71=Math[_0x38a4('0x15')](_0x4b566f[_0x36f071['topic']][_0x36f071[_0x38a4('0x16')]]);console['log'](_0x20cc38);_0x20cc38[_0x38a4('0xc')][_0x38a4('0x17')](_0x36f071[_0x38a4('0x4')],_0x36f071[_0x38a4('0x16')],_0x4ebb71);});});}['publish'](_0x231e7e){this[_0x38a4('0x8')]['send']([{'topic':this['topic'],'messages':_0x231e7e}],function(_0x40588f,_0x177b70){console['log'](_0x38a4('0x18'),_0x40588f,_0x38a4('0x19'),_0x177b70);});}}module[_0x38a4('0x1a')]=KafkaNodeBroker;