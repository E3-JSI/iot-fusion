var _0x372a=['./nodes/streamingTimeValueNode.js','./nodes/streamingSmartLampNode.js','./nodes/streamingTrafficCounterNode.js','./nodes/streamingAirQualityNode.js','./nodes/streamingWeatherNode.js','./nodes/streamingStaticNode.js','./streamModel.js','config','parse','stringify','connectionConfig','nodes','masterSatisfied','lastTimestamp','lastFeatureVector','allNodesAvailable','features_','fusion_id','fusionTick','dbPath','./db','mkdirSync','base','Base','createClean','master','masterNodeId','type','airquality','push','processRecordHook','trafficcounter','smartlamp','timevalue','substation','log','ERROR:\x20Streaming\x20node\x20type\x20not\x20found!','Created\x20','\x20nodes.','model','streamModel','predictions_','connection','kafka','broker','topic','addPublisher','mqtt','length','isMaster','setMasterOffset','checkDataAvailability','buildFeatureVector','updateStream','broadcastPrediction','broadcastFeatureVector','cleanupData','Data\x20not\x20available.','Can\x20not\x20be\x20generated!','getPartialFeatureVector','appendFileSync','./data/','publish','deleteObsoleteRows','save','qminer','./nodes/streamingNode.js','./nodes/streamingTrainNode.js'];(function(_0xf0fdbb,_0x45763b){var _0x31c613=function(_0x5e85a6){while(--_0x5e85a6){_0xf0fdbb['push'](_0xf0fdbb['shift']());}};var _0x5c8bbc=function(){var _0x563316={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x428303,_0x17c4cd,_0x1fee69,_0x8e6357){_0x8e6357=_0x8e6357||{};var _0x5c7312=_0x17c4cd+'='+_0x1fee69;var _0x26d419=0x0;for(var _0x26d419=0x0,_0x565127=_0x428303['length'];_0x26d419<_0x565127;_0x26d419++){var _0x45fe6e=_0x428303[_0x26d419];_0x5c7312+=';\x20'+_0x45fe6e;var _0x41bf4f=_0x428303[_0x45fe6e];_0x428303['push'](_0x41bf4f);_0x565127=_0x428303['length'];if(_0x41bf4f!==!![]){_0x5c7312+='='+_0x41bf4f;}}_0x8e6357['cookie']=_0x5c7312;},'removeCookie':function(){return'dev';},'getCookie':function(_0x542cc3,_0x56c630){_0x542cc3=_0x542cc3||function(_0x589798){return _0x589798;};var _0x44b4c6=_0x542cc3(new RegExp('(?:^|;\x20)'+_0x56c630['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0xb11125=function(_0x490710,_0x5e5482){_0x490710(++_0x5e5482);};_0xb11125(_0x31c613,_0x45763b);return _0x44b4c6?decodeURIComponent(_0x44b4c6[0x1]):undefined;}};var _0x5170ac=function(){var _0x114237=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x114237['test'](_0x563316['removeCookie']['toString']());};_0x563316['updateCookie']=_0x5170ac;var _0x1ce1d1='';var _0x4d415c=_0x563316['updateCookie']();if(!_0x4d415c){_0x563316['setCookie'](['*'],'counter',0x1);}else if(_0x4d415c){_0x1ce1d1=_0x563316['getCookie'](null,'counter');}else{_0x563316['removeCookie']();}};_0x5c8bbc();}(_0x372a,0x195));var _0x363a=function(_0x12472b,_0xb701a){_0x12472b=_0x12472b-0x0;var _0x119c64=_0x372a[_0x12472b];return _0x119c64;};var _0x35a1b4=function(){var _0x15e0db=!![];return function(_0x5296af,_0x587482){var _0x4b863d=_0x15e0db?function(){if(_0x587482){var _0x237fee=_0x587482['apply'](_0x5296af,arguments);_0x587482=null;return _0x237fee;}}:function(){};_0x15e0db=![];return _0x4b863d;};}();var _0x1b0e03=_0x35a1b4(this,function(){var _0x4e0d44=function(){return'\x64\x65\x76';},_0x3e0f74=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x144078=function(){var _0x1a94df=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x1a94df['\x74\x65\x73\x74'](_0x4e0d44['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x1f109f=function(){var _0x5e8552=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x5e8552['\x74\x65\x73\x74'](_0x3e0f74['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x48bafa=function(_0x37f793){var _0x39eca8=~-0x1>>0x1+0xff%0x0;if(_0x37f793['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x39eca8)){_0x389a2d(_0x37f793);}};var _0x389a2d=function(_0x45fa8c){var _0x1e5ed6=~-0x4>>0x1+0xff%0x0;if(_0x45fa8c['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x1e5ed6){_0x48bafa(_0x45fa8c);}};if(!_0x144078()){if(!_0x1f109f()){_0x48bafa('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x48bafa('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x48bafa('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x1b0e03();const qm=require(_0x363a('0x0'));const fs=require('fs');const streamingNode=require(_0x363a('0x1'));const streamingEnergyNode=require('./nodes/streamingEnergyNode.js');const streamingSubstationNode=require('./nodes/streamingSubstationNode.js');const streamingTrainNode=require(_0x363a('0x2'));const streamingTimeValueNode=require(_0x363a('0x3'));const streamingSmartLampNode=require(_0x363a('0x4'));const streamingTrafficCounterNode=require(_0x363a('0x5'));const streamingAirQualityNode=require(_0x363a('0x6'));const streamingWeatherNode=require(_0x363a('0x7'));const streamingStaticNode=require(_0x363a('0x8'));const streamModel=require(_0x363a('0x9'));const {AbstractBroker,KafkaNodeBroker,MQTTBroker,KafkaRDBroker}=require('./common/brokers/brokers.js');class streamFusion{constructor(_0x5452cc,_0x1d7a51,_0x330ddb){let _0x22aabf=this;this[_0x363a('0xa')]=JSON[_0x363a('0xb')](JSON[_0x363a('0xc')](_0x1d7a51));this[_0x363a('0xd')]=JSON[_0x363a('0xb')](JSON[_0x363a('0xc')](_0x5452cc));this[_0x363a('0xe')]=[];this['masterNodeId']=-0x1;this[_0x363a('0xf')]=!![];this[_0x363a('0x10')]=0x0;this[_0x363a('0x11')]=[];this[_0x363a('0x12')]=![];this['fusion_id']=_0x1d7a51['fusionModel'];this['topic']=_0x363a('0x13')+this[_0x363a('0x14')];this[_0x363a('0x15')]=_0x1d7a51[_0x363a('0x15')];this[_0x363a('0x16')]='./db/'+this[_0x363a('0x14')];if(!fs['existsSync'](_0x363a('0x17'))){fs['mkdirSync'](_0x363a('0x17'));}if(!fs['existsSync'](this[_0x363a('0x16')])){fs[_0x363a('0x18')](this['dbPath']);}this[_0x363a('0x19')]=new qm[(_0x363a('0x1a'))]({'dbPath':this[_0x363a('0x16')],'mode':_0x363a('0x1b')});for(let _0x5c8483 in _0x1d7a51[_0x363a('0xe')]){let _0x5204ee=_0x1d7a51['nodes'][_0x5c8483];_0x5204ee[_0x363a('0x15')]=this[_0x363a('0x15')];if(_0x5204ee[_0x363a('0x1c')]==!![])this[_0x363a('0x1d')]=_0x5c8483;if(_0x5204ee[_0x363a('0x1e')]==_0x363a('0x1f')){this[_0x363a('0xe')][_0x363a('0x20')](new streamingAirQualityNode(this['base'],this[_0x363a('0xd')],_0x5204ee,_0x330ddb,_0x22aabf[_0x363a('0x21')],_0x5c8483,_0x22aabf));}else if(_0x5204ee[_0x363a('0x1e')]==_0x363a('0x22')){this[_0x363a('0xe')][_0x363a('0x20')](new streamingTrafficCounterNode(this['base'],this['connectionConfig'],_0x5204ee,_0x330ddb,_0x22aabf['processRecordHook'],_0x5c8483,_0x22aabf));}else if(_0x5204ee[_0x363a('0x1e')]==_0x363a('0x23')){this['nodes']['push'](new streamingSmartLampNode(this[_0x363a('0x19')],this['connectionConfig'],_0x5204ee,_0x330ddb,_0x22aabf['processRecordHook'],_0x5c8483,_0x22aabf));}else if(_0x5204ee[_0x363a('0x1e')]==_0x363a('0x24')){this['nodes']['push'](new streamingTimeValueNode(this[_0x363a('0x19')],this[_0x363a('0xd')],_0x5204ee,_0x330ddb,_0x22aabf['processRecordHook'],_0x5c8483,_0x22aabf));}else if(_0x5204ee[_0x363a('0x1e')]==_0x363a('0x25')){this[_0x363a('0xe')][_0x363a('0x20')](new streamingSubstationNode(this[_0x363a('0x19')],this[_0x363a('0xd')],_0x5204ee,_0x330ddb,_0x22aabf['processRecordHook'],_0x5c8483,_0x22aabf));}else if(_0x5204ee['type']=='energy'){this[_0x363a('0xe')][_0x363a('0x20')](new streamingEnergyNode(this[_0x363a('0x19')],this[_0x363a('0xd')],_0x5204ee,_0x330ddb,_0x22aabf[_0x363a('0x21')],_0x5c8483,_0x22aabf));}else if(_0x5204ee[_0x363a('0x1e')]=='train'){this[_0x363a('0xe')][_0x363a('0x20')](new streamingTrainNode(this[_0x363a('0x19')],this['connectionConfig'],_0x5204ee,_0x330ddb,_0x22aabf[_0x363a('0x21')],_0x5c8483,_0x22aabf));}else if(_0x5204ee['type']=='static'){this[_0x363a('0xe')][_0x363a('0x20')](new streamingStaticNode(this[_0x363a('0x19')],this['connectionConfig'],_0x5204ee,_0x330ddb,_0x22aabf[_0x363a('0x21')],_0x5c8483,_0x22aabf));}else if(_0x5204ee[_0x363a('0x1e')]=='weather'){this[_0x363a('0xe')][_0x363a('0x20')](new streamingWeatherNode(this[_0x363a('0x19')],this[_0x363a('0xd')],_0x5204ee,_0x330ddb,_0x22aabf[_0x363a('0x21')],_0x5c8483,_0x22aabf));}else{console[_0x363a('0x26')](_0x363a('0x27'));}}console[_0x363a('0x26')](_0x363a('0x28')+this[_0x363a('0xe')]['length']+_0x363a('0x29'));if(_0x363a('0x2a')in _0x1d7a51){this[_0x363a('0x2b')]=new streamModel(_0x1d7a51,_0x22aabf);this['topic']=_0x363a('0x2c')+this[_0x363a('0x14')];}if(_0x363a('0x2d')in _0x1d7a51){if(_0x1d7a51['connection']['type']==_0x363a('0x2e')){this[_0x363a('0x2f')]=new KafkaNodeBroker(this[_0x363a('0xd')],this[_0x363a('0x30')],this[_0x363a('0x14')]);this[_0x363a('0x2f')][_0x363a('0x31')]();}else if(_0x1d7a51[_0x363a('0x2d')]['type']==_0x363a('0x32')){this[_0x363a('0x2f')]=new MQTTBroker(this['connectionConfig'],this[_0x363a('0x30')],this['fusion_id']);this[_0x363a('0x2f')]['addPublisher']();}else{this['broker']=new AbstractBroker(this[_0x363a('0xd')],this['topic'],this[_0x363a('0x14')]);}}}['processRecordHook'](_0x310dbb,_0x409260){if(!_0x409260[_0x363a('0x12')]){for(let _0x529cbb in _0x409260[_0x363a('0xe')]){if(_0x409260[_0x363a('0xe')][_0x529cbb]['buffer'][_0x363a('0x33')]==0x0){return null;}}_0x409260[_0x363a('0x12')]=!![];}if(_0x409260[_0x363a('0xe')][_0x409260[_0x363a('0x1d')]]['buffer'][_0x363a('0x33')]>0x0&&_0x409260[_0x363a('0xf')]==![]){_0x310dbb=_0x409260[_0x363a('0x1d')];};if(_0x409260[_0x363a('0xe')][_0x310dbb][_0x363a('0x34')]()==!![]){_0x409260['nodes'][_0x310dbb][_0x363a('0x35')]();let _0x1b7bf6=_0x409260['nodes'][_0x310dbb]['getOffsetTimestamp']();let _0x40564e=!![];for(let _0x577634 in _0x409260['nodes']){if(_0x577634!=_0x310dbb){if(_0x409260[_0x363a('0xe')][_0x577634]['setSlaveOffset'](_0x1b7bf6)){if(!_0x409260[_0x363a('0xe')][_0x577634][_0x363a('0x36')]()){_0x40564e=![];}}else{_0x40564e=![];}}}if(_0x40564e&&_0x409260[_0x363a('0x10')]!=_0x1b7bf6){_0x409260[_0x363a('0xf')]=!![];let _0x49112d=_0x409260[_0x363a('0x37')]();if(_0x363a('0x2a')in _0x409260[_0x363a('0xa')]){let _0x365627;if(_0x49112d[_0x363a('0x33')]!=0x0){_0x365627=_0x409260[_0x363a('0x2b')][_0x363a('0x38')](_0x49112d,_0x1b7bf6);_0x409260[_0x363a('0x39')](_0x365627[0x0],_0x365627[0x1],_0x365627[0x2]);}}else{_0x409260[_0x363a('0x3a')](_0x1b7bf6,_0x49112d);}_0x409260[_0x363a('0x10')]=_0x1b7bf6;_0x409260[_0x363a('0x11')]=_0x49112d;_0x409260[_0x363a('0x3b')]();}else{console['log'](_0x363a('0x3c'));_0x409260[_0x363a('0xf')]=![];}}else{if(!_0x409260[_0x363a('0xf')]){}}}[_0x363a('0x37')](){let _0x1dd262=[];for(let _0x1a2d0d in this['nodes']){let _0x28e2d3=this[_0x363a('0xe')][_0x1a2d0d]['checkDataAvailability']();if(_0x28e2d3==![]){console[_0x363a('0x26')](_0x363a('0x3d'));return[];}let _0x130c56=this[_0x363a('0xe')][_0x1a2d0d][_0x363a('0x3e')]();_0x1dd262=_0x1dd262['concat'](_0x130c56);}return _0x1dd262;}['broadcastFeatureVector'](_0x184a74,_0x44e101){let _0x5ed62e=JSON['stringify']({'timestamp':_0x184a74,'ftr_vector':_0x44e101});if(_0x44e101!=[])fs[_0x363a('0x3f')](_0x363a('0x40')+this[_0x363a('0x14')]+'.json',_0x5ed62e+'\x0a');this[_0x363a('0x2f')][_0x363a('0x41')](_0x5ed62e);}[_0x363a('0x39')](_0xc43507,_0xc99be,_0x2d9bba){let _0x12792c={'timestamp':_0xc43507,'value':_0xc99be,'horizon':_0x2d9bba};this[_0x363a('0x2f')][_0x363a('0x41')](_0x12792c);}[_0x363a('0x3b')](){for(let _0x1c76c8 in this[_0x363a('0xe')]){this[_0x363a('0xe')][_0x1c76c8][_0x363a('0x42')]();}}[_0x363a('0x43')](){}}module['exports']=streamFusion;