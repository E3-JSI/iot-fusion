const a0_0x2bdf=['Data\x20not\x20available.','lastFeatureVector','topic','parse','./nodes/streamingWeatherNode.js','masterNodeId','Created\x20','dbPath','./data/','getPartialFeatureVector','./nodes/streamingTrafficCounterNode.js','energy','predictions_','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','config','./nodes/streamingSmartLampNode.js','setMasterOffset','masterSatisfied','processRecordHook','./nodes/streamingTrainNode.js','setSlaveOffset','push','updateStream','unknown','features_','./nodes/streamingEnergyNode.js','addPublisher','mkdirSync','log','appendFileSync','return\x20/\x22\x20+\x20this\x20+\x20\x22/','getOffsetTimestamp','ERROR:\x20Streaming\x20node\x20type\x20not\x20found!','./db','lastTimestamp','deleteObsoleteRows','mqtt','buffer','./nodes/staticCalculatedNode.js','weather','allNodesAvailable','test','existsSync','train','./db/','constructor','fusion_id','save','checkDataAvailability','base','length','broadcastPrediction','type','publish','streamModel','connectionConfig','value','./nodes/streamingNode.js','cleanupData','isMaster','airquality','./models/IncrementalLearning.js','broker','horizon','buildFeatureVector','connection','broadcastFeatureVector','fusionTick','stringify','\x20nodes.','./nodes/streamingStaticNode.js','model','options','calculated','apply','attributes','fusionModel','name','Can\x20not\x20be\x20generated!','nodes','substation'];(function(_0x3b6fa9,_0x2bdfae){const _0x347921=function(_0x1d22ab){while(--_0x1d22ab){_0x3b6fa9['push'](_0x3b6fa9['shift']());}},_0x105a22=function(){const _0x3ed1cd={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x35dc7f,_0x3d0413,_0x1c74d8,_0x330e7a){_0x330e7a=_0x330e7a||{};let _0x522a6b=_0x3d0413+'='+_0x1c74d8,_0x16ece4=0x0;for(let _0x29c630=0x0,_0x33afc0=_0x35dc7f['length'];_0x29c630<_0x33afc0;_0x29c630++){const _0x8c8910=_0x35dc7f[_0x29c630];_0x522a6b+=';\x20'+_0x8c8910;const _0x40067a=_0x35dc7f[_0x8c8910];_0x35dc7f['push'](_0x40067a),_0x33afc0=_0x35dc7f['length'],_0x40067a!==!![]&&(_0x522a6b+='='+_0x40067a);}_0x330e7a['cookie']=_0x522a6b;},'removeCookie':function(){return'dev';},'getCookie':function(_0x5b8dcb,_0x2ad2e8){_0x5b8dcb=_0x5b8dcb||function(_0x2dec27){return _0x2dec27;};const _0x40ce26=_0x5b8dcb(new RegExp('(?:^|;\x20)'+_0x2ad2e8['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x4d996f=function(_0x5b0d1b,_0x18616a){_0x5b0d1b(++_0x18616a);};return _0x4d996f(_0x347921,_0x2bdfae),_0x40ce26?decodeURIComponent(_0x40ce26[0x1]):undefined;}},_0x4f2532=function(){const _0x3fbd57=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x3fbd57['test'](_0x3ed1cd['removeCookie']['toString']());};_0x3ed1cd['updateCookie']=_0x4f2532;let _0x1954ba='';const _0x3101ef=_0x3ed1cd['updateCookie']();if(!_0x3101ef)_0x3ed1cd['setCookie'](['*'],'counter',0x1);else _0x3101ef?_0x1954ba=_0x3ed1cd['getCookie'](null,'counter'):_0x3ed1cd['removeCookie']();};_0x105a22();}(a0_0x2bdf,0x15d));const a0_0x3479=function(_0x3b6fa9,_0x2bdfae){_0x3b6fa9=_0x3b6fa9-0x0;let _0x347921=a0_0x2bdf[_0x3b6fa9];return _0x347921;};const a0_0x1c74d8=function(){let _0x516eb9=!![];return function(_0x569acc,_0x4d0e7f){const _0x1a18d3=_0x516eb9?function(){if(_0x4d0e7f){const _0x20e9b3=_0x4d0e7f[a0_0x3479('0x31')](_0x569acc,arguments);return _0x4d0e7f=null,_0x20e9b3;}}:function(){};return _0x516eb9=![],_0x1a18d3;};}(),a0_0x3d0413=a0_0x1c74d8(this,function(){const _0x1b2e76=function(){const _0x48f2be=_0x1b2e76[a0_0x3479('0x14')](a0_0x3479('0x5'))()[a0_0x3479('0x14')](a0_0x3479('0x45'));return!_0x48f2be[a0_0x3479('0x10')](a0_0x3d0413);};return _0x1b2e76();});a0_0x3d0413();const qm=require('qminer'),fs=require('fs'),streamingNode=require(a0_0x3479('0x20')),streamingEnergyNode=require(a0_0x3479('0x0')),streamingSubstationNode=require('./nodes/streamingSubstationNode.js'),streamingTrainNode=require(a0_0x3479('0x4b')),streamingTimeValueNode=require('./nodes/streamingTimeValueNode.js'),streamingSmartLampNode=require(a0_0x3479('0x47')),streamingTrafficCounterNode=require(a0_0x3479('0x42')),streamingAirQualityNode=require('./nodes/streamingAirQualityNode.js'),streamingWeatherNode=require(a0_0x3479('0x3c')),streamingStaticNode=require(a0_0x3479('0x2d')),staticCalculatedNode=require(a0_0x3479('0xd')),IncrementalLearning=require(a0_0x3479('0x24')),{AbstractBroker,KafkaNodeBroker,MQTTBroker,KafkaRDBroker}=require('./common/brokers/brokers.js');class streamFusion{constructor(_0x54a2d9,_0x270b3c,_0x2d5d42){let _0x2dd227=this;this['config']=JSON[a0_0x3479('0x3b')](JSON['stringify'](_0x270b3c)),this['connectionConfig']=JSON[a0_0x3479('0x3b')](JSON['stringify'](_0x54a2d9)),this[a0_0x3479('0x36')]=[],this[a0_0x3479('0x3d')]=-0x1,this[a0_0x3479('0x49')]=!![],this[a0_0x3479('0x9')]=0x0,this[a0_0x3479('0x39')]=[],this['allNodesAvailable']=![],this[a0_0x3479('0x15')]=_0x270b3c[a0_0x3479('0x33')],this[a0_0x3479('0x3a')]=a0_0x3479('0x50')+this[a0_0x3479('0x15')],this[a0_0x3479('0x2a')]=_0x270b3c[a0_0x3479('0x2a')],this[a0_0x3479('0x3f')]=a0_0x3479('0x13')+this[a0_0x3479('0x15')];!fs[a0_0x3479('0x11')](a0_0x3479('0x8'))&&fs[a0_0x3479('0x2')](a0_0x3479('0x8'));!fs[a0_0x3479('0x11')](this[a0_0x3479('0x3f')])&&fs['mkdirSync'](this[a0_0x3479('0x3f')]);this['base']=new qm['Base']({'dbPath':this[a0_0x3479('0x3f')],'mode':'createClean'});for(let _0x267ec5 in _0x270b3c['nodes']){let _0x329c33=_0x270b3c[a0_0x3479('0x36')][_0x267ec5];_0x329c33[a0_0x3479('0x2a')]=this[a0_0x3479('0x2a')];if(_0x329c33['master']==!![])this[a0_0x3479('0x3d')]=_0x267ec5;if(_0x329c33[a0_0x3479('0x1b')]==a0_0x3479('0x23'))this['nodes'][a0_0x3479('0x4d')](new streamingAirQualityNode(this[a0_0x3479('0x18')],this['connectionConfig'],_0x329c33,_0x2d5d42,_0x2dd227[a0_0x3479('0x4a')],_0x267ec5,_0x2dd227));else{if(_0x329c33[a0_0x3479('0x1b')]=='trafficcounter')this['nodes'][a0_0x3479('0x4d')](new streamingTrafficCounterNode(this[a0_0x3479('0x18')],this['connectionConfig'],_0x329c33,_0x2d5d42,_0x2dd227['processRecordHook'],_0x267ec5,_0x2dd227));else{if(_0x329c33['type']=='smartlamp')this[a0_0x3479('0x36')][a0_0x3479('0x4d')](new streamingSmartLampNode(this[a0_0x3479('0x18')],this[a0_0x3479('0x1e')],_0x329c33,_0x2d5d42,_0x2dd227[a0_0x3479('0x4a')],_0x267ec5,_0x2dd227));else{if(_0x329c33[a0_0x3479('0x1b')]=='timevalue')this[a0_0x3479('0x36')][a0_0x3479('0x4d')](new streamingTimeValueNode(this[a0_0x3479('0x18')],this[a0_0x3479('0x1e')],_0x329c33,_0x2d5d42,_0x2dd227[a0_0x3479('0x4a')],_0x267ec5,_0x2dd227));else{if(_0x329c33[a0_0x3479('0x1b')]==a0_0x3479('0x37'))this[a0_0x3479('0x36')][a0_0x3479('0x4d')](new streamingSubstationNode(this['base'],this[a0_0x3479('0x1e')],_0x329c33,_0x2d5d42,_0x2dd227[a0_0x3479('0x4a')],_0x267ec5,_0x2dd227));else{if(_0x329c33[a0_0x3479('0x1b')]==a0_0x3479('0x43'))this['nodes']['push'](new streamingEnergyNode(this['base'],this[a0_0x3479('0x1e')],_0x329c33,_0x2d5d42,_0x2dd227[a0_0x3479('0x4a')],_0x267ec5,_0x2dd227));else{if(_0x329c33[a0_0x3479('0x1b')]==a0_0x3479('0x12'))this[a0_0x3479('0x36')][a0_0x3479('0x4d')](new streamingTrainNode(this[a0_0x3479('0x18')],this['connectionConfig'],_0x329c33,_0x2d5d42,_0x2dd227[a0_0x3479('0x4a')],_0x267ec5,_0x2dd227));else{if(_0x329c33[a0_0x3479('0x1b')]=='static')this['nodes']['push'](new streamingStaticNode(this[a0_0x3479('0x18')],this[a0_0x3479('0x1e')],_0x329c33,_0x2d5d42,_0x2dd227[a0_0x3479('0x4a')],_0x267ec5,_0x2dd227));else{if(_0x329c33[a0_0x3479('0x1b')]==a0_0x3479('0x30'))this[a0_0x3479('0x36')][a0_0x3479('0x4d')](new staticCalculatedNode(this[a0_0x3479('0x18')],this[a0_0x3479('0x1e')],_0x329c33,_0x2d5d42,_0x2dd227[a0_0x3479('0x4a')],_0x267ec5,_0x2dd227));else _0x329c33[a0_0x3479('0x1b')]==a0_0x3479('0xe')?this['nodes']['push'](new streamingWeatherNode(this[a0_0x3479('0x18')],this['connectionConfig'],_0x329c33,_0x2d5d42,_0x2dd227['processRecordHook'],_0x267ec5,_0x2dd227)):console[a0_0x3479('0x3')](a0_0x3479('0x7'));}}}}}}}}}console[a0_0x3479('0x3')](a0_0x3479('0x3e')+this[a0_0x3479('0x36')][a0_0x3479('0x19')]+a0_0x3479('0x2c'));a0_0x3479('0x2e')in _0x270b3c&&(this[a0_0x3479('0x1d')]=new IncrementalLearning(_0x270b3c,_0x2dd227),this[a0_0x3479('0x3a')]=a0_0x3479('0x44')+this[a0_0x3479('0x15')],_0x270b3c[a0_0x3479('0x2e')][a0_0x3479('0x3a')]!==undefined&&(this['topic']=_0x270b3c['model']['topic']));if(a0_0x3479('0x28')in _0x270b3c){if(_0x270b3c[a0_0x3479('0x28')][a0_0x3479('0x1b')]=='kafka')this[a0_0x3479('0x25')]=new KafkaNodeBroker(this[a0_0x3479('0x1e')],this['topic'],this[a0_0x3479('0x15')]),this['broker'][a0_0x3479('0x1')]();else _0x270b3c[a0_0x3479('0x28')][a0_0x3479('0x1b')]==a0_0x3479('0xb')?(this[a0_0x3479('0x25')]=new MQTTBroker(this['connectionConfig'],this[a0_0x3479('0x3a')],this[a0_0x3479('0x15')]),this[a0_0x3479('0x25')][a0_0x3479('0x1')]()):this[a0_0x3479('0x25')]=new AbstractBroker(this[a0_0x3479('0x1e')],this[a0_0x3479('0x3a')],this[a0_0x3479('0x15')]);}}['processRecordHook'](_0x2ec224,_0x4af428){if(!_0x4af428[a0_0x3479('0xf')]){for(let _0x43ce86 in _0x4af428[a0_0x3479('0x36')]){if(_0x4af428['nodes'][_0x43ce86][a0_0x3479('0xc')]['length']==0x0)return null;}_0x4af428[a0_0x3479('0xf')]=!![];}_0x4af428['nodes'][_0x4af428[a0_0x3479('0x3d')]][a0_0x3479('0xc')][a0_0x3479('0x19')]>0x0&&_0x4af428[a0_0x3479('0x49')]==![]&&(_0x2ec224=_0x4af428[a0_0x3479('0x3d')]);;if(_0x4af428[a0_0x3479('0x36')][_0x2ec224][a0_0x3479('0x22')]()==!![]){_0x4af428[a0_0x3479('0x36')][_0x2ec224][a0_0x3479('0x48')]();let _0x366170=_0x4af428[a0_0x3479('0x36')][_0x2ec224][a0_0x3479('0x6')](),_0x26133f=!![];for(let _0x26b932 in _0x4af428[a0_0x3479('0x36')]){_0x26b932!=_0x2ec224&&(_0x4af428[a0_0x3479('0x36')][_0x26b932][a0_0x3479('0x4c')](_0x366170)?!_0x4af428[a0_0x3479('0x36')][_0x26b932][a0_0x3479('0x17')]()&&(_0x26133f=![]):_0x26133f=![]);}if(_0x26133f&&_0x4af428[a0_0x3479('0x9')]!=_0x366170){_0x4af428[a0_0x3479('0x49')]=!![];let _0x3b9d1d=_0x4af428[a0_0x3479('0x27')]();if(a0_0x3479('0x2e')in _0x4af428[a0_0x3479('0x46')]){let _0x309d28;if(_0x3b9d1d[a0_0x3479('0x19')]!=0x0){_0x309d28=_0x4af428[a0_0x3479('0x1d')][a0_0x3479('0x4e')](_0x3b9d1d,_0x366170);const _0x130e54=_0x4af428[a0_0x3479('0x46')]['nodes'][0x0][a0_0x3479('0x32')][0x0][a0_0x3479('0x32')][0x0][a0_0x3479('0x34')]!==undefined?_0x4af428[a0_0x3479('0x46')][a0_0x3479('0x36')][0x0][a0_0x3479('0x32')][0x0]['attributes'][0x0][a0_0x3479('0x34')]:'uknown',_0x122752=_0x4af428[a0_0x3479('0x46')][a0_0x3479('0x2e')][a0_0x3479('0x2f')]['method']!==undefined?_0x4af428[a0_0x3479('0x46')][a0_0x3479('0x2e')][a0_0x3479('0x2f')]['method']:a0_0x3479('0x4f');_0x4af428[a0_0x3479('0x1a')](_0x309d28['ts'],_0x309d28[a0_0x3479('0x1f')],_0x309d28[a0_0x3479('0x26')],_0x130e54,_0x122752);}}else _0x4af428[a0_0x3479('0x29')](_0x366170,_0x3b9d1d);_0x4af428[a0_0x3479('0x9')]=_0x366170,_0x4af428[a0_0x3479('0x39')]=_0x3b9d1d,_0x4af428[a0_0x3479('0x21')]();}else console['log'](a0_0x3479('0x38')),_0x4af428['masterSatisfied']=![];}else{if(!_0x4af428[a0_0x3479('0x49')]){}}}['buildFeatureVector'](){let _0x2c983c=[];for(let _0x1d3108 in this['nodes']){let _0x2771e0=this[a0_0x3479('0x36')][_0x1d3108][a0_0x3479('0x17')]();if(_0x2771e0==![])return console['log'](a0_0x3479('0x35')),[];let _0x1f97a6=this[a0_0x3479('0x36')][_0x1d3108][a0_0x3479('0x41')]();_0x2c983c=_0x2c983c['concat'](_0x1f97a6);}return _0x2c983c;}[a0_0x3479('0x29')](_0x2ec32a,_0x48d40e){let _0xc47bf1=JSON[a0_0x3479('0x2b')]({'timestamp':_0x2ec32a,'ftr_vector':_0x48d40e});if(_0x48d40e!=[])fs[a0_0x3479('0x4')](a0_0x3479('0x40')+this[a0_0x3479('0x15')]+'.json',_0xc47bf1+'\x0a');this['broker']['publish'](_0xc47bf1);}[a0_0x3479('0x1a')](_0x29d3c7,_0x1fea74,_0x6ffe73,_0x509a60,_0x984421){let _0x7263a3=JSON['stringify']({'stampm':_0x29d3c7,'value':_0x1fea74,'sensor_id':_0x509a60,'method':_0x984421,'horizon':_0x6ffe73});this['broker'][a0_0x3479('0x1c')](_0x7263a3);}['cleanupData'](){for(let _0x1c338f in this[a0_0x3479('0x36')]){this[a0_0x3479('0x36')][_0x1c338f][a0_0x3479('0xa')]();}}[a0_0x3479('0x16')](){}}module['exports']=streamFusion;