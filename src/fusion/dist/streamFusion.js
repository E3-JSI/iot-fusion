const a0_0x50a3=['./nodes/streamingAirQualityNode.js','options','isMaster','existsSync','./nodes/streamingTrainNode.js','Base','concat','base','broker','mqtt','lastTimestamp','train','fusion_id','push','trafficcounter','stringify','energy','./nodes/streamingEnergyNode.js','./nodes/streamingWeatherNode.js','save','static','buffer','\x20nodes.','publish','name','parse','connectionConfig','master','broadcastFeatureVector','type','apply','processRecordHook','method','./nodes/streamingStaticNode.js','config','log','./nodes/streamingSmartLampNode.js','fusionTick','topic','Can\x20not\x20be\x20generated!','airquality','buildFeatureVector','weather','./db','value','updateStream','mkdirSync','createClean','setSlaveOffset','cleanupData','Created\x20','broadcastPrediction','addPublisher','lastFeatureVector','deleteObsoleteRows','setMasterOffset','kafka','substation','uknown','nodes','constructor','./db/','length','allNodesAvailable','return\x20/\x22\x20+\x20this\x20+\x20\x22/','getPartialFeatureVector','dbPath','getOffsetTimestamp','./data/','connection','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','masterSatisfied','model','timevalue','./models/IncrementalLearning.js','masterNodeId','./common/brokers/brokers.js','ERROR:\x20Streaming\x20node\x20type\x20not\x20found!','attributes','Data\x20not\x20available.'];(function(_0x2cd86c,_0x50a399){const _0x501647=function(_0xbeefc1){while(--_0xbeefc1){_0x2cd86c['push'](_0x2cd86c['shift']());}},_0x352b21=function(){const _0x33123f={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x14cab9,_0xded5d8,_0x333e66,_0x4beec6){_0x4beec6=_0x4beec6||{};let _0xe961f5=_0xded5d8+'='+_0x333e66,_0x4efdd5=0x0;for(let _0x3b259e=0x0,_0x945c9c=_0x14cab9['length'];_0x3b259e<_0x945c9c;_0x3b259e++){const _0x65bb86=_0x14cab9[_0x3b259e];_0xe961f5+=';\x20'+_0x65bb86;const _0x5c9aa3=_0x14cab9[_0x65bb86];_0x14cab9['push'](_0x5c9aa3),_0x945c9c=_0x14cab9['length'],_0x5c9aa3!==!![]&&(_0xe961f5+='='+_0x5c9aa3);}_0x4beec6['cookie']=_0xe961f5;},'removeCookie':function(){return'dev';},'getCookie':function(_0x57fb35,_0x58ce15){_0x57fb35=_0x57fb35||function(_0x195635){return _0x195635;};const _0x2df47f=_0x57fb35(new RegExp('(?:^|;\x20)'+_0x58ce15['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x500b7d=function(_0x5ec408,_0x27d106){_0x5ec408(++_0x27d106);};return _0x500b7d(_0x501647,_0x50a399),_0x2df47f?decodeURIComponent(_0x2df47f[0x1]):undefined;}},_0x5323bc=function(){const _0x5a85e5=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x5a85e5['test'](_0x33123f['removeCookie']['toString']());};_0x33123f['updateCookie']=_0x5323bc;let _0x38561c='';const _0x1380cb=_0x33123f['updateCookie']();if(!_0x1380cb)_0x33123f['setCookie'](['*'],'counter',0x1);else _0x1380cb?_0x38561c=_0x33123f['getCookie'](null,'counter'):_0x33123f['removeCookie']();};_0x352b21();}(a0_0x50a3,0x6f));const a0_0x5016=function(_0x2cd86c,_0x50a399){_0x2cd86c=_0x2cd86c-0x0;let _0x501647=a0_0x50a3[_0x2cd86c];return _0x501647;};const a0_0x333e66=function(){let _0x3b90fb=!![];return function(_0x4739ab,_0x2b1361){const _0x5a215e=_0x3b90fb?function(){if(_0x2b1361){const _0x2e206c=_0x2b1361[a0_0x5016('0x4f')](_0x4739ab,arguments);return _0x2b1361=null,_0x2e206c;}}:function(){};return _0x3b90fb=![],_0x5a215e;};}(),a0_0xded5d8=a0_0x333e66(this,function(){const _0x4e2689=function(){const _0x555d64=_0x4e2689['constructor'](a0_0x5016('0x21'))()[a0_0x5016('0x1d')](a0_0x5016('0x27'));return!_0x555d64['test'](a0_0xded5d8);};return _0x4e2689();});a0_0xded5d8();const qm=require('qminer'),fs=require('fs'),streamingNode=require('./nodes/streamingNode.js'),streamingEnergyNode=require(a0_0x5016('0x42')),streamingSubstationNode=require('./nodes/streamingSubstationNode.js'),streamingTrainNode=require(a0_0x5016('0x35')),streamingTimeValueNode=require('./nodes/streamingTimeValueNode.js'),streamingSmartLampNode=require(a0_0x5016('0x5')),streamingTrafficCounterNode=require('./nodes/streamingTrafficCounterNode.js'),streamingAirQualityNode=require(a0_0x5016('0x31')),streamingWeatherNode=require(a0_0x5016('0x43')),streamingStaticNode=require(a0_0x5016('0x2')),staticCalculatedNode=require('./nodes/staticCalculatedNode.js'),IncrementalLearning=require(a0_0x5016('0x2b')),{AbstractBroker,KafkaNodeBroker,MQTTBroker,KafkaRDBroker}=require(a0_0x5016('0x2d'));class streamFusion{constructor(_0x4594af,_0x164814,_0x5d7142){let _0x5b0dd1=this;this['config']=JSON[a0_0x5016('0x4a')](JSON[a0_0x5016('0x40')](_0x164814)),this[a0_0x5016('0x4b')]=JSON[a0_0x5016('0x4a')](JSON['stringify'](_0x4594af)),this[a0_0x5016('0x1c')]=[],this['masterNodeId']=-0x1,this[a0_0x5016('0x28')]=!![],this[a0_0x5016('0x3b')]=0x0,this[a0_0x5016('0x16')]=[],this['allNodesAvailable']=![],this[a0_0x5016('0x3d')]=_0x164814['fusionModel'],this[a0_0x5016('0x7')]='features_'+this[a0_0x5016('0x3d')],this[a0_0x5016('0x6')]=_0x164814['fusionTick'],this['dbPath']=a0_0x5016('0x1e')+this[a0_0x5016('0x3d')];!fs[a0_0x5016('0x34')]('./db')&&fs['mkdirSync'](a0_0x5016('0xc'));!fs[a0_0x5016('0x34')](this[a0_0x5016('0x23')])&&fs[a0_0x5016('0xf')](this[a0_0x5016('0x23')]);this['base']=new qm[(a0_0x5016('0x36'))]({'dbPath':this['dbPath'],'mode':a0_0x5016('0x10')});for(let _0x14fe63 in _0x164814[a0_0x5016('0x1c')]){let _0x59872d=_0x164814[a0_0x5016('0x1c')][_0x14fe63];_0x59872d[a0_0x5016('0x6')]=this[a0_0x5016('0x6')];if(_0x59872d[a0_0x5016('0x4c')]==!![])this[a0_0x5016('0x2c')]=_0x14fe63;if(_0x59872d['type']==a0_0x5016('0x9'))this['nodes']['push'](new streamingAirQualityNode(this[a0_0x5016('0x38')],this[a0_0x5016('0x4b')],_0x59872d,_0x5d7142,_0x5b0dd1[a0_0x5016('0x0')],_0x14fe63,_0x5b0dd1));else{if(_0x59872d[a0_0x5016('0x4e')]==a0_0x5016('0x3f'))this[a0_0x5016('0x1c')][a0_0x5016('0x3e')](new streamingTrafficCounterNode(this['base'],this[a0_0x5016('0x4b')],_0x59872d,_0x5d7142,_0x5b0dd1[a0_0x5016('0x0')],_0x14fe63,_0x5b0dd1));else{if(_0x59872d[a0_0x5016('0x4e')]=='smartlamp')this[a0_0x5016('0x1c')][a0_0x5016('0x3e')](new streamingSmartLampNode(this['base'],this['connectionConfig'],_0x59872d,_0x5d7142,_0x5b0dd1[a0_0x5016('0x0')],_0x14fe63,_0x5b0dd1));else{if(_0x59872d[a0_0x5016('0x4e')]==a0_0x5016('0x2a'))this[a0_0x5016('0x1c')][a0_0x5016('0x3e')](new streamingTimeValueNode(this[a0_0x5016('0x38')],this[a0_0x5016('0x4b')],_0x59872d,_0x5d7142,_0x5b0dd1[a0_0x5016('0x0')],_0x14fe63,_0x5b0dd1));else{if(_0x59872d[a0_0x5016('0x4e')]==a0_0x5016('0x1a'))this['nodes'][a0_0x5016('0x3e')](new streamingSubstationNode(this[a0_0x5016('0x38')],this[a0_0x5016('0x4b')],_0x59872d,_0x5d7142,_0x5b0dd1[a0_0x5016('0x0')],_0x14fe63,_0x5b0dd1));else{if(_0x59872d[a0_0x5016('0x4e')]==a0_0x5016('0x41'))this[a0_0x5016('0x1c')][a0_0x5016('0x3e')](new streamingEnergyNode(this[a0_0x5016('0x38')],this[a0_0x5016('0x4b')],_0x59872d,_0x5d7142,_0x5b0dd1[a0_0x5016('0x0')],_0x14fe63,_0x5b0dd1));else{if(_0x59872d['type']==a0_0x5016('0x3c'))this['nodes'][a0_0x5016('0x3e')](new streamingTrainNode(this['base'],this[a0_0x5016('0x4b')],_0x59872d,_0x5d7142,_0x5b0dd1[a0_0x5016('0x0')],_0x14fe63,_0x5b0dd1));else{if(_0x59872d[a0_0x5016('0x4e')]==a0_0x5016('0x45'))this[a0_0x5016('0x1c')]['push'](new streamingStaticNode(this[a0_0x5016('0x38')],this[a0_0x5016('0x4b')],_0x59872d,_0x5d7142,_0x5b0dd1['processRecordHook'],_0x14fe63,_0x5b0dd1));else{if(_0x59872d['type']=='calculated')this[a0_0x5016('0x1c')][a0_0x5016('0x3e')](new staticCalculatedNode(this[a0_0x5016('0x38')],this[a0_0x5016('0x4b')],_0x59872d,_0x5d7142,_0x5b0dd1[a0_0x5016('0x0')],_0x14fe63,_0x5b0dd1));else _0x59872d['type']==a0_0x5016('0xb')?this[a0_0x5016('0x1c')][a0_0x5016('0x3e')](new streamingWeatherNode(this[a0_0x5016('0x38')],this[a0_0x5016('0x4b')],_0x59872d,_0x5d7142,_0x5b0dd1[a0_0x5016('0x0')],_0x14fe63,_0x5b0dd1)):console[a0_0x5016('0x4')](a0_0x5016('0x2e'));}}}}}}}}}console[a0_0x5016('0x4')](a0_0x5016('0x13')+this['nodes']['length']+a0_0x5016('0x47'));a0_0x5016('0x29')in _0x164814&&(this['streamModel']=new IncrementalLearning(_0x164814,_0x5b0dd1),this[a0_0x5016('0x7')]='predictions_'+this[a0_0x5016('0x3d')],_0x164814[a0_0x5016('0x29')]['topic']!==undefined&&(this[a0_0x5016('0x7')]=_0x164814[a0_0x5016('0x29')][a0_0x5016('0x7')]));if(a0_0x5016('0x26')in _0x164814){if(_0x164814['connection'][a0_0x5016('0x4e')]==a0_0x5016('0x19'))this[a0_0x5016('0x39')]=new KafkaNodeBroker(this['connectionConfig'],this['topic'],this[a0_0x5016('0x3d')]),this[a0_0x5016('0x39')][a0_0x5016('0x15')]();else _0x164814[a0_0x5016('0x26')][a0_0x5016('0x4e')]==a0_0x5016('0x3a')?(this[a0_0x5016('0x39')]=new MQTTBroker(this[a0_0x5016('0x4b')],this[a0_0x5016('0x7')],this[a0_0x5016('0x3d')]),this[a0_0x5016('0x39')][a0_0x5016('0x15')]()):this[a0_0x5016('0x39')]=new AbstractBroker(this['connectionConfig'],this[a0_0x5016('0x7')],this[a0_0x5016('0x3d')]);}}[a0_0x5016('0x0')](_0x4f03a1,_0x30fa25){if(!_0x30fa25[a0_0x5016('0x20')]){for(let _0x45e1f9 in _0x30fa25[a0_0x5016('0x1c')]){if(_0x30fa25['nodes'][_0x45e1f9][a0_0x5016('0x46')][a0_0x5016('0x1f')]==0x0)return null;}_0x30fa25[a0_0x5016('0x20')]=!![];}_0x30fa25[a0_0x5016('0x1c')][_0x30fa25[a0_0x5016('0x2c')]][a0_0x5016('0x46')][a0_0x5016('0x1f')]>0x0&&_0x30fa25[a0_0x5016('0x28')]==![]&&(_0x4f03a1=_0x30fa25[a0_0x5016('0x2c')]);;if(_0x30fa25[a0_0x5016('0x1c')][_0x4f03a1][a0_0x5016('0x33')]()==!![]){_0x30fa25[a0_0x5016('0x1c')][_0x4f03a1][a0_0x5016('0x18')]();let _0x536dbe=_0x30fa25['nodes'][_0x4f03a1][a0_0x5016('0x24')](),_0x31aaa4=!![];for(let _0x50ac2e in _0x30fa25[a0_0x5016('0x1c')]){_0x50ac2e!=_0x4f03a1&&(_0x30fa25['nodes'][_0x50ac2e][a0_0x5016('0x11')](_0x536dbe)?!_0x30fa25[a0_0x5016('0x1c')][_0x50ac2e]['checkDataAvailability']()&&(_0x31aaa4=![]):_0x31aaa4=![]);}if(_0x31aaa4&&_0x30fa25[a0_0x5016('0x3b')]!=_0x536dbe){_0x30fa25[a0_0x5016('0x28')]=!![];let _0x5d2486=_0x30fa25[a0_0x5016('0xa')]();if(a0_0x5016('0x29')in _0x30fa25[a0_0x5016('0x3')]){let _0x4e013e;if(_0x5d2486[a0_0x5016('0x1f')]!=0x0){_0x4e013e=_0x30fa25['streamModel'][a0_0x5016('0xe')](_0x5d2486,_0x536dbe);const _0x3facda=_0x30fa25[a0_0x5016('0x3')][a0_0x5016('0x1c')][0x0][a0_0x5016('0x2f')][0x0][a0_0x5016('0x2f')][0x0][a0_0x5016('0x49')]!==undefined?_0x30fa25[a0_0x5016('0x3')][a0_0x5016('0x1c')][0x0][a0_0x5016('0x2f')][0x0]['attributes'][0x0][a0_0x5016('0x49')]:a0_0x5016('0x1b'),_0x1d6db0=_0x30fa25['config'][a0_0x5016('0x29')][a0_0x5016('0x32')][a0_0x5016('0x1')]!==undefined?_0x30fa25[a0_0x5016('0x3')][a0_0x5016('0x29')][a0_0x5016('0x32')]['method']:'unknown';_0x30fa25[a0_0x5016('0x14')](_0x4e013e['ts'],_0x4e013e[a0_0x5016('0xd')],_0x4e013e['horizon'],_0x3facda,_0x1d6db0);}}else _0x30fa25['broadcastFeatureVector'](_0x536dbe,_0x5d2486);_0x30fa25['lastTimestamp']=_0x536dbe,_0x30fa25[a0_0x5016('0x16')]=_0x5d2486,_0x30fa25[a0_0x5016('0x12')]();}else console['log'](a0_0x5016('0x30')),_0x30fa25[a0_0x5016('0x28')]=![];}else{if(!_0x30fa25[a0_0x5016('0x28')]){}}}[a0_0x5016('0xa')](){let _0x578b27=[];for(let _0x2b65c1 in this[a0_0x5016('0x1c')]){let _0xda4397=this[a0_0x5016('0x1c')][_0x2b65c1]['checkDataAvailability']();if(_0xda4397==![])return console[a0_0x5016('0x4')](a0_0x5016('0x8')),[];let _0x59c7f4=this[a0_0x5016('0x1c')][_0x2b65c1][a0_0x5016('0x22')]();_0x578b27=_0x578b27[a0_0x5016('0x37')](_0x59c7f4);}return _0x578b27;}[a0_0x5016('0x4d')](_0x44b394,_0x1012fa){let _0x2b153b=JSON[a0_0x5016('0x40')]({'timestamp':_0x44b394,'ftr_vector':_0x1012fa});if(_0x1012fa!=[])fs['appendFileSync'](a0_0x5016('0x25')+this['fusion_id']+'.json',_0x2b153b+'\x0a');this['broker'][a0_0x5016('0x48')](_0x2b153b);}['broadcastPrediction'](_0x26c942,_0x40d6ea,_0x389313,_0xbe0424,_0x344545){let _0x383223=JSON[a0_0x5016('0x40')]({'stampm':_0x26c942,'value':_0x40d6ea,'sensor_id':_0xbe0424,'method':_0x344545,'horizon':_0x389313});this[a0_0x5016('0x39')][a0_0x5016('0x48')](_0x383223);}[a0_0x5016('0x12')](){for(let _0x1c0a5c in this['nodes']){this['nodes'][_0x1c0a5c][a0_0x5016('0x17')]();}}[a0_0x5016('0x44')](){}}module['exports']=streamFusion;