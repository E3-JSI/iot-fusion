const a0_0x21a3=['allNodesAvailable','./nodes/streamingTrafficCounterNode.js','length','options','buffer','fusionTick','apply','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','Created\x20','model','publish','appendFileSync','cleanupData','addPublisher','airquality','uknown','static','existsSync','./data/','Base','log','buildFeatureVector','lastFeatureVector','setMasterOffset','name','connectionConfig','setSlaveOffset','method','./db','topic','masterNodeId','processRecordHook','master','fusion_id','./nodes/streamingEnergyNode.js','mkdirSync','./nodes/staticCalculatedNode.js','push','return\x20/\x22\x20+\x20this\x20+\x20\x22/','updateStream','nodes','ERROR:\x20Streaming\x20node\x20type\x20not\x20found!','./nodes/streamingWeatherNode.js','streamModel','lastTimestamp','createClean','substation','Data\x20not\x20available.','energy','concat','broker','calculated','parse','horizon','features_','checkDataAvailability','Can\x20not\x20be\x20generated!','constructor','broadcastFeatureVector','stringify','attributes','unknown','dbPath','masterSatisfied','./db/','./nodes/streamingTrainNode.js','connection','weather','./nodes/streamingTimeValueNode.js','\x20nodes.','deleteObsoleteRows','./nodes/streamingNode.js','save','trafficcounter','smartlamp','train','type','./nodes/streamingStaticNode.js','predictions_','./nodes/streamingSubstationNode.js','getPartialFeatureVector','fusionModel','base','config','./nodes/streamingSmartLampNode.js','kafka'];(function(_0x5418bd,_0x21a31e){const _0x339225=function(_0x26cd95){while(--_0x26cd95){_0x5418bd['push'](_0x5418bd['shift']());}},_0x290a81=function(){const _0xf3f0d0={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x3e1f93,_0x2779dc,_0x46c75f,_0x1ef5f5){_0x1ef5f5=_0x1ef5f5||{};let _0x330253=_0x2779dc+'='+_0x46c75f,_0x532cc4=0x0;for(let _0x4917c5=0x0,_0x1a274c=_0x3e1f93['length'];_0x4917c5<_0x1a274c;_0x4917c5++){const _0x383e58=_0x3e1f93[_0x4917c5];_0x330253+=';\x20'+_0x383e58;const _0x562def=_0x3e1f93[_0x383e58];_0x3e1f93['push'](_0x562def),_0x1a274c=_0x3e1f93['length'],_0x562def!==!![]&&(_0x330253+='='+_0x562def);}_0x1ef5f5['cookie']=_0x330253;},'removeCookie':function(){return'dev';},'getCookie':function(_0x583fb8,_0x2379a3){_0x583fb8=_0x583fb8||function(_0x1eb785){return _0x1eb785;};const _0x21bc9b=_0x583fb8(new RegExp('(?:^|;\x20)'+_0x2379a3['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x3c1d34=function(_0x3c005d,_0x165b19){_0x3c005d(++_0x165b19);};return _0x3c1d34(_0x339225,_0x21a31e),_0x21bc9b?decodeURIComponent(_0x21bc9b[0x1]):undefined;}},_0x548a63=function(){const _0xc3b8c4=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0xc3b8c4['test'](_0xf3f0d0['removeCookie']['toString']());};_0xf3f0d0['updateCookie']=_0x548a63;let _0x583b30='';const _0x4a9392=_0xf3f0d0['updateCookie']();if(!_0x4a9392)_0xf3f0d0['setCookie'](['*'],'counter',0x1);else _0x4a9392?_0x583b30=_0xf3f0d0['getCookie'](null,'counter'):_0xf3f0d0['removeCookie']();};_0x290a81();}(a0_0x21a3,0x1c5));const a0_0x3392=function(_0x5418bd,_0x21a31e){_0x5418bd=_0x5418bd-0x0;let _0x339225=a0_0x21a3[_0x5418bd];return _0x339225;};const a0_0x46c75f=function(){let _0x155483=!![];return function(_0x5a0fb7,_0x376c02){const _0x587cca=_0x155483?function(){if(_0x376c02){const _0x30d326=_0x376c02[a0_0x3392('0x45')](_0x5a0fb7,arguments);return _0x376c02=null,_0x30d326;}}:function(){};return _0x155483=![],_0x587cca;};}(),a0_0x2779dc=a0_0x46c75f(this,function(){const _0x36d6e0=function(){const _0x40c2d2=_0x36d6e0['constructor'](a0_0x3392('0xf'))()[a0_0x3392('0x22')](a0_0x3392('0x46'));return!_0x40c2d2['test'](a0_0x2779dc);};return _0x36d6e0();});a0_0x2779dc();const qm=require('qminer'),fs=require('fs'),streamingNode=require(a0_0x3392('0x30')),streamingEnergyNode=require(a0_0x3392('0xb')),streamingSubstationNode=require(a0_0x3392('0x38')),streamingTrainNode=require(a0_0x3392('0x2a')),streamingTimeValueNode=require(a0_0x3392('0x2d')),streamingSmartLampNode=require(a0_0x3392('0x3d')),streamingTrafficCounterNode=require(a0_0x3392('0x40')),streamingAirQualityNode=require('./nodes/streamingAirQualityNode.js'),streamingWeatherNode=require(a0_0x3392('0x13')),streamingStaticNode=require(a0_0x3392('0x36')),staticCalculatedNode=require(a0_0x3392('0xd')),IncrementalLearning=require('./models/IncrementalLearning.js'),{AbstractBroker,KafkaNodeBroker,MQTTBroker,KafkaRDBroker}=require('./common/brokers/brokers.js');class streamFusion{constructor(_0xd14dfd,_0x5a8fec,_0x56ad99){let _0xeb5a2d=this;this[a0_0x3392('0x3c')]=JSON[a0_0x3392('0x1d')](JSON['stringify'](_0x5a8fec)),this['connectionConfig']=JSON['parse'](JSON[a0_0x3392('0x24')](_0xd14dfd)),this[a0_0x3392('0x11')]=[],this['masterNodeId']=-0x1,this[a0_0x3392('0x28')]=!![],this[a0_0x3392('0x15')]=0x0,this[a0_0x3392('0x55')]=[],this[a0_0x3392('0x3f')]=![],this[a0_0x3392('0xa')]=_0x5a8fec[a0_0x3392('0x3a')],this[a0_0x3392('0x6')]=a0_0x3392('0x1f')+this[a0_0x3392('0xa')],this['fusionTick']=_0x5a8fec[a0_0x3392('0x44')],this[a0_0x3392('0x27')]=a0_0x3392('0x29')+this[a0_0x3392('0xa')];!fs[a0_0x3392('0x50')](a0_0x3392('0x5'))&&fs[a0_0x3392('0xc')]('./db');!fs[a0_0x3392('0x50')](this[a0_0x3392('0x27')])&&fs[a0_0x3392('0xc')](this['dbPath']);this[a0_0x3392('0x3b')]=new qm[(a0_0x3392('0x52'))]({'dbPath':this[a0_0x3392('0x27')],'mode':a0_0x3392('0x16')});for(let _0x37ffbe in _0x5a8fec[a0_0x3392('0x11')]){let _0x1cee88=_0x5a8fec[a0_0x3392('0x11')][_0x37ffbe];_0x1cee88[a0_0x3392('0x44')]=this[a0_0x3392('0x44')];if(_0x1cee88[a0_0x3392('0x9')]==!![])this[a0_0x3392('0x7')]=_0x37ffbe;if(_0x1cee88[a0_0x3392('0x35')]==a0_0x3392('0x4d'))this['nodes'][a0_0x3392('0xe')](new streamingAirQualityNode(this['base'],this[a0_0x3392('0x2')],_0x1cee88,_0x56ad99,_0xeb5a2d[a0_0x3392('0x8')],_0x37ffbe,_0xeb5a2d));else{if(_0x1cee88[a0_0x3392('0x35')]==a0_0x3392('0x32'))this[a0_0x3392('0x11')][a0_0x3392('0xe')](new streamingTrafficCounterNode(this[a0_0x3392('0x3b')],this[a0_0x3392('0x2')],_0x1cee88,_0x56ad99,_0xeb5a2d['processRecordHook'],_0x37ffbe,_0xeb5a2d));else{if(_0x1cee88[a0_0x3392('0x35')]==a0_0x3392('0x33'))this[a0_0x3392('0x11')][a0_0x3392('0xe')](new streamingSmartLampNode(this[a0_0x3392('0x3b')],this['connectionConfig'],_0x1cee88,_0x56ad99,_0xeb5a2d[a0_0x3392('0x8')],_0x37ffbe,_0xeb5a2d));else{if(_0x1cee88[a0_0x3392('0x35')]=='timevalue')this[a0_0x3392('0x11')][a0_0x3392('0xe')](new streamingTimeValueNode(this[a0_0x3392('0x3b')],this[a0_0x3392('0x2')],_0x1cee88,_0x56ad99,_0xeb5a2d[a0_0x3392('0x8')],_0x37ffbe,_0xeb5a2d));else{if(_0x1cee88[a0_0x3392('0x35')]==a0_0x3392('0x17'))this['nodes'][a0_0x3392('0xe')](new streamingSubstationNode(this[a0_0x3392('0x3b')],this['connectionConfig'],_0x1cee88,_0x56ad99,_0xeb5a2d[a0_0x3392('0x8')],_0x37ffbe,_0xeb5a2d));else{if(_0x1cee88[a0_0x3392('0x35')]==a0_0x3392('0x19'))this[a0_0x3392('0x11')][a0_0x3392('0xe')](new streamingEnergyNode(this[a0_0x3392('0x3b')],this[a0_0x3392('0x2')],_0x1cee88,_0x56ad99,_0xeb5a2d[a0_0x3392('0x8')],_0x37ffbe,_0xeb5a2d));else{if(_0x1cee88[a0_0x3392('0x35')]==a0_0x3392('0x34'))this[a0_0x3392('0x11')][a0_0x3392('0xe')](new streamingTrainNode(this[a0_0x3392('0x3b')],this[a0_0x3392('0x2')],_0x1cee88,_0x56ad99,_0xeb5a2d[a0_0x3392('0x8')],_0x37ffbe,_0xeb5a2d));else{if(_0x1cee88[a0_0x3392('0x35')]==a0_0x3392('0x4f'))this[a0_0x3392('0x11')][a0_0x3392('0xe')](new streamingStaticNode(this[a0_0x3392('0x3b')],this[a0_0x3392('0x2')],_0x1cee88,_0x56ad99,_0xeb5a2d[a0_0x3392('0x8')],_0x37ffbe,_0xeb5a2d));else{if(_0x1cee88[a0_0x3392('0x35')]==a0_0x3392('0x1c'))this[a0_0x3392('0x11')][a0_0x3392('0xe')](new staticCalculatedNode(this['base'],this[a0_0x3392('0x2')],_0x1cee88,_0x56ad99,_0xeb5a2d['processRecordHook'],_0x37ffbe,_0xeb5a2d));else _0x1cee88[a0_0x3392('0x35')]==a0_0x3392('0x2c')?this[a0_0x3392('0x11')][a0_0x3392('0xe')](new streamingWeatherNode(this['base'],this['connectionConfig'],_0x1cee88,_0x56ad99,_0xeb5a2d[a0_0x3392('0x8')],_0x37ffbe,_0xeb5a2d)):console[a0_0x3392('0x53')](a0_0x3392('0x12'));}}}}}}}}}console['log'](a0_0x3392('0x47')+this[a0_0x3392('0x11')][a0_0x3392('0x41')]+a0_0x3392('0x2e'));a0_0x3392('0x48')in _0x5a8fec&&(this['streamModel']=new IncrementalLearning(_0x5a8fec,_0xeb5a2d),this[a0_0x3392('0x6')]=a0_0x3392('0x37')+this['fusion_id'],_0x5a8fec[a0_0x3392('0x48')][a0_0x3392('0x6')]!==undefined&&(this['topic']=_0x5a8fec[a0_0x3392('0x48')][a0_0x3392('0x6')]));if(a0_0x3392('0x2b')in _0x5a8fec){if(_0x5a8fec[a0_0x3392('0x2b')][a0_0x3392('0x35')]==a0_0x3392('0x3e'))this[a0_0x3392('0x1b')]=new KafkaNodeBroker(this[a0_0x3392('0x2')],this[a0_0x3392('0x6')],this[a0_0x3392('0xa')]),this[a0_0x3392('0x1b')][a0_0x3392('0x4c')]();else _0x5a8fec['connection']['type']=='mqtt'?(this[a0_0x3392('0x1b')]=new MQTTBroker(this['connectionConfig'],this['topic'],this[a0_0x3392('0xa')]),this['broker'][a0_0x3392('0x4c')]()):this[a0_0x3392('0x1b')]=new AbstractBroker(this[a0_0x3392('0x2')],this['topic'],this[a0_0x3392('0xa')]);}}[a0_0x3392('0x8')](_0x1414e4,_0x36cfa4){if(!_0x36cfa4[a0_0x3392('0x3f')]){for(let _0x3cb9ab in _0x36cfa4['nodes']){if(_0x36cfa4[a0_0x3392('0x11')][_0x3cb9ab][a0_0x3392('0x43')][a0_0x3392('0x41')]==0x0)return null;}_0x36cfa4[a0_0x3392('0x3f')]=!![];}_0x36cfa4[a0_0x3392('0x11')][_0x36cfa4[a0_0x3392('0x7')]]['buffer'][a0_0x3392('0x41')]>0x0&&_0x36cfa4[a0_0x3392('0x28')]==![]&&(_0x1414e4=_0x36cfa4[a0_0x3392('0x7')]);;if(_0x36cfa4[a0_0x3392('0x11')][_0x1414e4]['isMaster']()==!![]){_0x36cfa4[a0_0x3392('0x11')][_0x1414e4][a0_0x3392('0x0')]();let _0x205258=_0x36cfa4[a0_0x3392('0x11')][_0x1414e4]['getOffsetTimestamp'](),_0x55bef7=!![];for(let _0x3e081d in _0x36cfa4[a0_0x3392('0x11')]){_0x3e081d!=_0x1414e4&&(_0x36cfa4[a0_0x3392('0x11')][_0x3e081d][a0_0x3392('0x3')](_0x205258)?!_0x36cfa4[a0_0x3392('0x11')][_0x3e081d][a0_0x3392('0x20')]()&&(_0x55bef7=![]):_0x55bef7=![]);}if(_0x55bef7&&_0x36cfa4[a0_0x3392('0x15')]!=_0x205258){_0x36cfa4[a0_0x3392('0x28')]=!![];let _0x360cc2=_0x36cfa4[a0_0x3392('0x54')]();if(a0_0x3392('0x48')in _0x36cfa4[a0_0x3392('0x3c')]){let _0x3d3af5;if(_0x360cc2[a0_0x3392('0x41')]!=0x0){_0x3d3af5=_0x36cfa4[a0_0x3392('0x14')][a0_0x3392('0x10')](_0x360cc2,_0x205258);const _0x4319d5=_0x36cfa4['config'][a0_0x3392('0x11')][0x0][a0_0x3392('0x25')][0x0][a0_0x3392('0x25')][0x0]['name']!==undefined?_0x36cfa4['config'][a0_0x3392('0x11')][0x0]['attributes'][0x0][a0_0x3392('0x25')][0x0][a0_0x3392('0x1')]:a0_0x3392('0x4e'),_0x387d3e=_0x36cfa4['config']['model'][a0_0x3392('0x42')][a0_0x3392('0x4')]!==undefined?_0x36cfa4['config'][a0_0x3392('0x48')]['options'][a0_0x3392('0x4')]:a0_0x3392('0x26');_0x36cfa4['broadcastPrediction'](_0x3d3af5['ts'],_0x3d3af5['value'],_0x3d3af5[a0_0x3392('0x1e')],_0x4319d5,_0x387d3e);}}else _0x36cfa4[a0_0x3392('0x23')](_0x205258,_0x360cc2);_0x36cfa4[a0_0x3392('0x15')]=_0x205258,_0x36cfa4['lastFeatureVector']=_0x360cc2,_0x36cfa4[a0_0x3392('0x4b')]();}else console[a0_0x3392('0x53')](a0_0x3392('0x18')),_0x36cfa4[a0_0x3392('0x28')]=![];}else{if(!_0x36cfa4[a0_0x3392('0x28')]){}}}[a0_0x3392('0x54')](){let _0x3ccc9f=[];for(let _0x4ceabd in this[a0_0x3392('0x11')]){let _0x3cbd5b=this[a0_0x3392('0x11')][_0x4ceabd][a0_0x3392('0x20')]();if(_0x3cbd5b==![])return console['log'](a0_0x3392('0x21')),[];let _0x570619=this[a0_0x3392('0x11')][_0x4ceabd][a0_0x3392('0x39')]();_0x3ccc9f=_0x3ccc9f[a0_0x3392('0x1a')](_0x570619);}return _0x3ccc9f;}[a0_0x3392('0x23')](_0x46e193,_0x4d5e0e){let _0x558ac6=JSON[a0_0x3392('0x24')]({'timestamp':_0x46e193,'ftr_vector':_0x4d5e0e});if(_0x4d5e0e!=[])fs[a0_0x3392('0x4a')](a0_0x3392('0x51')+this[a0_0x3392('0xa')]+'.json',_0x558ac6+'\x0a');this[a0_0x3392('0x1b')][a0_0x3392('0x49')](_0x558ac6);}['broadcastPrediction'](_0x369177,_0xba4f39,_0xafb976,_0x5c30e6,_0x601441){let _0x2c424c=JSON[a0_0x3392('0x24')]({'stampm':_0x369177,'value':_0xba4f39,'sensor_id':_0x5c30e6,'method':_0x601441,'horizon':_0xafb976});this['broker'][a0_0x3392('0x49')](_0x2c424c);}[a0_0x3392('0x4b')](){for(let _0x2d890d in this[a0_0x3392('0x11')]){this[a0_0x3392('0x11')][_0x2d890d][a0_0x3392('0x2f')]();}}[a0_0x3392('0x31')](){}}module['exports']=streamFusion;