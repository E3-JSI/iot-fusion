var _0x5ec0=['Can\x20not\x20be\x20generated!','appendFileSync','./data/','.json','publish','deleteObsoleteRows','save','exports','./nodes/streamingNode.js','./nodes/streamingEnergyNode.js','./nodes/streamingSubstationNode.js','./nodes/streamingTrainNode.js','./nodes/streamingSmartLampNode.js','./nodes/streamingAirQualityNode.js','./nodes/streamingWeatherNode.js','./nodes/streamingStaticNode.js','./streamModel.js','./common/brokers/brokers.js','parse','stringify','connectionConfig','nodes','masterSatisfied','lastTimestamp','allNodesAvailable','fusion_id','fusionModel','topic','features_','fusionTick','dbPath','./db/','./db','existsSync','mkdirSync','base','Base','createClean','master','masterNodeId','type','airquality','push','trafficcounter','smartlamp','timevalue','processRecordHook','substation','energy','train','log','Created\x20','model','streamModel','predictions_','connection','kafka','broker','addPublisher','mqtt','buffer','isMaster','setMasterOffset','setSlaveOffset','checkDataAvailability','buildFeatureVector','length','updateStream','broadcastFeatureVector','lastFeatureVector','cleanupData','Data\x20not\x20available.'];(function(_0x93d2c5,_0x504800){var _0x48b7e4=function(_0x24d01f){while(--_0x24d01f){_0x93d2c5['push'](_0x93d2c5['shift']());}};var _0x51f836=function(){var _0xaa8830={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x273416,_0x21d2c6,_0x4f5e28,_0x209dfb){_0x209dfb=_0x209dfb||{};var _0xf46449=_0x21d2c6+'='+_0x4f5e28;var _0xdde2b3=0x0;for(var _0xdde2b3=0x0,_0x56c9ee=_0x273416['length'];_0xdde2b3<_0x56c9ee;_0xdde2b3++){var _0x5f12d8=_0x273416[_0xdde2b3];_0xf46449+=';\x20'+_0x5f12d8;var _0x1537a7=_0x273416[_0x5f12d8];_0x273416['push'](_0x1537a7);_0x56c9ee=_0x273416['length'];if(_0x1537a7!==!![]){_0xf46449+='='+_0x1537a7;}}_0x209dfb['cookie']=_0xf46449;},'removeCookie':function(){return'dev';},'getCookie':function(_0x35bca8,_0x286bd3){_0x35bca8=_0x35bca8||function(_0x34bad5){return _0x34bad5;};var _0x56e08b=_0x35bca8(new RegExp('(?:^|;\x20)'+_0x286bd3['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x308bbd=function(_0x5c1baa,_0x5337ca){_0x5c1baa(++_0x5337ca);};_0x308bbd(_0x48b7e4,_0x504800);return _0x56e08b?decodeURIComponent(_0x56e08b[0x1]):undefined;}};var _0x52a4f4=function(){var _0x5dea84=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x5dea84['test'](_0xaa8830['removeCookie']['toString']());};_0xaa8830['updateCookie']=_0x52a4f4;var _0x3c5511='';var _0x49cc5f=_0xaa8830['updateCookie']();if(!_0x49cc5f){_0xaa8830['setCookie'](['*'],'counter',0x1);}else if(_0x49cc5f){_0x3c5511=_0xaa8830['getCookie'](null,'counter');}else{_0xaa8830['removeCookie']();}};_0x51f836();}(_0x5ec0,0x170));var _0x551f=function(_0x56b940,_0x36d4eb){_0x56b940=_0x56b940-0x0;var _0x3ca384=_0x5ec0[_0x56b940];return _0x3ca384;};var _0x2da9ec=function(){var _0x2ed0d9=!![];return function(_0xed24b3,_0x581247){var _0x39c70f=_0x2ed0d9?function(){if(_0x581247){var _0x164968=_0x581247['apply'](_0xed24b3,arguments);_0x581247=null;return _0x164968;}}:function(){};_0x2ed0d9=![];return _0x39c70f;};}();var _0x2a422a=_0x2da9ec(this,function(){var _0x3fabd5=function(){return'\x64\x65\x76';},_0x389a3f=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x2f2d17=function(){var _0x2d7a6d=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x2d7a6d['\x74\x65\x73\x74'](_0x3fabd5['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x53255a=function(){var _0x4a7211=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x4a7211['\x74\x65\x73\x74'](_0x389a3f['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x5a90a0=function(_0x2268ad){var _0x72b31e=~-0x1>>0x1+0xff%0x0;if(_0x2268ad['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x72b31e)){_0x34a587(_0x2268ad);}};var _0x34a587=function(_0x5eaaf5){var _0x560b18=~-0x4>>0x1+0xff%0x0;if(_0x5eaaf5['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x560b18){_0x5a90a0(_0x5eaaf5);}};if(!_0x2f2d17()){if(!_0x53255a()){_0x5a90a0('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x5a90a0('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x5a90a0('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x2a422a();const qm=require('qminer');const fs=require('fs');const streamingNode=require(_0x551f('0x0'));const streamingEnergyNode=require(_0x551f('0x1'));const streamingSubstationNode=require(_0x551f('0x2'));const streamingTrainNode=require(_0x551f('0x3'));const streamingTimeValueNode=require('./nodes/streamingTimeValueNode.js');const streamingSmartLampNode=require(_0x551f('0x4'));const streamingTrafficCounterNode=require('./nodes/streamingTrafficCounterNode.js');const streamingAirQualityNode=require(_0x551f('0x5'));const streamingWeatherNode=require(_0x551f('0x6'));const streamingStaticNode=require(_0x551f('0x7'));const streamModel=require(_0x551f('0x8'));const {AbstractBroker,KafkaNodeBroker,MQTTBroker,KafkaRDBroker}=require(_0x551f('0x9'));class streamFusion{constructor(_0x434f30,_0x2f4ece,_0xfbb64b){let _0x477725=this;this['config']=JSON[_0x551f('0xa')](JSON[_0x551f('0xb')](_0x2f4ece));this[_0x551f('0xc')]=JSON[_0x551f('0xa')](JSON[_0x551f('0xb')](_0x434f30));this[_0x551f('0xd')]=[];this['masterNodeId']=-0x1;this[_0x551f('0xe')]=!![];this[_0x551f('0xf')]=0x0;this['lastFeatureVector']=[];this[_0x551f('0x10')]=![];this[_0x551f('0x11')]=_0x2f4ece[_0x551f('0x12')];this[_0x551f('0x13')]=_0x551f('0x14')+this[_0x551f('0x11')];this[_0x551f('0x15')]=_0x2f4ece[_0x551f('0x15')];this[_0x551f('0x16')]=_0x551f('0x17')+this[_0x551f('0x11')];if(!fs['existsSync'](_0x551f('0x18'))){fs['mkdirSync'](_0x551f('0x18'));}if(!fs[_0x551f('0x19')](this[_0x551f('0x16')])){fs[_0x551f('0x1a')](this[_0x551f('0x16')]);}this[_0x551f('0x1b')]=new qm[(_0x551f('0x1c'))]({'dbPath':this[_0x551f('0x16')],'mode':_0x551f('0x1d')});for(let _0x2ab627 in _0x2f4ece[_0x551f('0xd')]){let _0x44fb96=_0x2f4ece[_0x551f('0xd')][_0x2ab627];_0x44fb96[_0x551f('0x15')]=this[_0x551f('0x15')];if(_0x44fb96[_0x551f('0x1e')]==!![])this[_0x551f('0x1f')]=_0x2ab627;if(_0x44fb96[_0x551f('0x20')]==_0x551f('0x21')){this[_0x551f('0xd')][_0x551f('0x22')](new streamingAirQualityNode(this['base'],this[_0x551f('0xc')],_0x44fb96,_0xfbb64b,_0x477725['processRecordHook'],_0x2ab627,_0x477725));}else if(_0x44fb96[_0x551f('0x20')]==_0x551f('0x23')){this['nodes']['push'](new streamingTrafficCounterNode(this['base'],this[_0x551f('0xc')],_0x44fb96,_0xfbb64b,_0x477725['processRecordHook'],_0x2ab627,_0x477725));}else if(_0x44fb96['type']==_0x551f('0x24')){this[_0x551f('0xd')][_0x551f('0x22')](new streamingSmartLampNode(this['base'],this[_0x551f('0xc')],_0x44fb96,_0xfbb64b,_0x477725['processRecordHook'],_0x2ab627,_0x477725));}else if(_0x44fb96[_0x551f('0x20')]==_0x551f('0x25')){this[_0x551f('0xd')][_0x551f('0x22')](new streamingTimeValueNode(this[_0x551f('0x1b')],this[_0x551f('0xc')],_0x44fb96,_0xfbb64b,_0x477725[_0x551f('0x26')],_0x2ab627,_0x477725));}else if(_0x44fb96['type']==_0x551f('0x27')){this['nodes'][_0x551f('0x22')](new streamingSubstationNode(this[_0x551f('0x1b')],this[_0x551f('0xc')],_0x44fb96,_0xfbb64b,_0x477725[_0x551f('0x26')],_0x2ab627,_0x477725));}else if(_0x44fb96[_0x551f('0x20')]==_0x551f('0x28')){this[_0x551f('0xd')]['push'](new streamingEnergyNode(this[_0x551f('0x1b')],this[_0x551f('0xc')],_0x44fb96,_0xfbb64b,_0x477725[_0x551f('0x26')],_0x2ab627,_0x477725));}else if(_0x44fb96[_0x551f('0x20')]==_0x551f('0x29')){this[_0x551f('0xd')][_0x551f('0x22')](new streamingTrainNode(this[_0x551f('0x1b')],this['connectionConfig'],_0x44fb96,_0xfbb64b,_0x477725[_0x551f('0x26')],_0x2ab627,_0x477725));}else if(_0x44fb96[_0x551f('0x20')]=='static'){this[_0x551f('0xd')][_0x551f('0x22')](new streamingStaticNode(this[_0x551f('0x1b')],this['connectionConfig'],_0x44fb96,_0xfbb64b,_0x477725[_0x551f('0x26')],_0x2ab627,_0x477725));}else if(_0x44fb96[_0x551f('0x20')]=='weather'){this[_0x551f('0xd')]['push'](new streamingWeatherNode(this[_0x551f('0x1b')],this['connectionConfig'],_0x44fb96,_0xfbb64b,_0x477725['processRecordHook'],_0x2ab627,_0x477725));}else{console[_0x551f('0x2a')]('ERROR:\x20Streaming\x20node\x20type\x20not\x20found!');}}console[_0x551f('0x2a')](_0x551f('0x2b')+this[_0x551f('0xd')]['length']+'\x20nodes.');if(_0x551f('0x2c')in _0x2f4ece){this[_0x551f('0x2d')]=new streamModel(_0x2f4ece,_0x477725);this['topic']=_0x551f('0x2e')+this[_0x551f('0x11')];}if(_0x551f('0x2f')in _0x2f4ece){if(_0x2f4ece[_0x551f('0x2f')][_0x551f('0x20')]==_0x551f('0x30')){this[_0x551f('0x31')]=new KafkaNodeBroker(this['connectionConfig'],this[_0x551f('0x13')],this[_0x551f('0x11')]);this[_0x551f('0x31')][_0x551f('0x32')]();}else if(_0x2f4ece[_0x551f('0x2f')]['type']==_0x551f('0x33')){this['broker']=new MQTTBroker(this[_0x551f('0xc')],this[_0x551f('0x13')],this[_0x551f('0x11')]);this['broker'][_0x551f('0x32')]();}else{this[_0x551f('0x31')]=new AbstractBroker(this['connectionConfig'],this[_0x551f('0x13')],this[_0x551f('0x11')]);}}}[_0x551f('0x26')](_0x1f7cd8,_0xd77d96){if(!_0xd77d96[_0x551f('0x10')]){for(let _0x4d81eb in _0xd77d96[_0x551f('0xd')]){if(_0xd77d96['nodes'][_0x4d81eb][_0x551f('0x34')]['length']==0x0){return null;}}_0xd77d96[_0x551f('0x10')]=!![];}if(_0xd77d96['nodes'][_0xd77d96[_0x551f('0x1f')]][_0x551f('0x34')]['length']>0x0&&_0xd77d96['masterSatisfied']==![]){_0x1f7cd8=_0xd77d96['masterNodeId'];};if(_0xd77d96['nodes'][_0x1f7cd8][_0x551f('0x35')]()==!![]){_0xd77d96[_0x551f('0xd')][_0x1f7cd8][_0x551f('0x36')]();let _0x42c2ed=_0xd77d96['nodes'][_0x1f7cd8]['getOffsetTimestamp']();let _0x6f15d3=!![];for(let _0x5922bb in _0xd77d96[_0x551f('0xd')]){if(_0x5922bb!=_0x1f7cd8){if(_0xd77d96[_0x551f('0xd')][_0x5922bb][_0x551f('0x37')](_0x42c2ed)){if(!_0xd77d96[_0x551f('0xd')][_0x5922bb][_0x551f('0x38')]()){_0x6f15d3=![];}}else{_0x6f15d3=![];}}}if(_0x6f15d3&&_0xd77d96[_0x551f('0xf')]!=_0x42c2ed){_0xd77d96[_0x551f('0xe')]=!![];let _0x28b2b4=_0xd77d96[_0x551f('0x39')]();if('model'in _0xd77d96['config']){let _0x5d26be;if(_0x28b2b4[_0x551f('0x3a')]!=0x0){_0x5d26be=_0xd77d96['streamModel'][_0x551f('0x3b')](_0x28b2b4,_0x42c2ed);_0xd77d96['broadcastPrediction'](_0x5d26be[0x0],_0x5d26be[0x1],_0x5d26be[0x2]);}}else{_0xd77d96[_0x551f('0x3c')](_0x42c2ed,_0x28b2b4);}_0xd77d96[_0x551f('0xf')]=_0x42c2ed;_0xd77d96[_0x551f('0x3d')]=_0x28b2b4;_0xd77d96[_0x551f('0x3e')]();}else{console['log'](_0x551f('0x3f'));_0xd77d96[_0x551f('0xe')]=![];}}else{if(!_0xd77d96[_0x551f('0xe')]){}}}[_0x551f('0x39')](){let _0x7d92aa=[];for(let _0x450a08 in this['nodes']){let _0x69f060=this[_0x551f('0xd')][_0x450a08][_0x551f('0x38')]();if(_0x69f060==![]){console[_0x551f('0x2a')](_0x551f('0x40'));return[];}let _0x144d37=this[_0x551f('0xd')][_0x450a08]['getPartialFeatureVector']();_0x7d92aa=_0x7d92aa['concat'](_0x144d37);}return _0x7d92aa;}[_0x551f('0x3c')](_0x29c7ac,_0x4c08d6){let _0x2bf906=JSON[_0x551f('0xb')]({'timestamp':_0x29c7ac,'ftr_vector':_0x4c08d6});if(_0x4c08d6!=[])fs[_0x551f('0x41')](_0x551f('0x42')+this[_0x551f('0x11')]+_0x551f('0x43'),_0x2bf906+'\x0a');this[_0x551f('0x31')][_0x551f('0x44')](_0x2bf906);}['broadcastPrediction'](_0x37800a,_0x17510c,_0x4a76bb){let _0x338e80={'timestamp':_0x37800a,'value':_0x17510c,'horizon':_0x4a76bb};this['broker'][_0x551f('0x44')](_0x338e80);}[_0x551f('0x3e')](){for(let _0xc71270 in this[_0x551f('0xd')]){this[_0x551f('0xd')][_0xc71270][_0x551f('0x45')]();}}[_0x551f('0x46')](){}}module[_0x551f('0x47')]=streamFusion;