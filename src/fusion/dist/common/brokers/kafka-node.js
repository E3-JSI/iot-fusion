const a0_0x4244=['error','kafka-node','partition','outOfRange','Consumer','consumer','setOffset','exports','client','log','Consumer\x20Error:\x20','min','kafka','topic','Message\x20Error:\x20','addPublisher','./abstract.js','constructor','StreamFusion\x20HLP\x20for\x20Kafka:\x20','Connecting\x20to\x20Kafka:\x20','producer','return\x20/\x22\x20+\x20this\x20+\x20\x22/','send','value','config',',\x20(data)','Offset','parse','offset','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','message','Publish\x20to\x20Kafka:\x20(err)','maxNum'];(function(_0x58517f,_0x4244c8){const _0x5712bc=function(_0x1efe74){while(--_0x1efe74){_0x58517f['push'](_0x58517f['shift']());}},_0x9a40e6=function(){const _0x4ebe0e={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x31078e,_0x55a9ab,_0x516e64,_0x5241de){_0x5241de=_0x5241de||{};let _0x5f2bf5=_0x55a9ab+'='+_0x516e64,_0x23f67b=0x0;for(let _0x1bbf41=0x0,_0x9510c7=_0x31078e['length'];_0x1bbf41<_0x9510c7;_0x1bbf41++){const _0x45b433=_0x31078e[_0x1bbf41];_0x5f2bf5+=';\x20'+_0x45b433;const _0x4fb0bd=_0x31078e[_0x45b433];_0x31078e['push'](_0x4fb0bd),_0x9510c7=_0x31078e['length'],_0x4fb0bd!==!![]&&(_0x5f2bf5+='='+_0x4fb0bd);}_0x5241de['cookie']=_0x5f2bf5;},'removeCookie':function(){return'dev';},'getCookie':function(_0x35df3e,_0xa9e99e){_0x35df3e=_0x35df3e||function(_0x27e020){return _0x27e020;};const _0x45cb50=_0x35df3e(new RegExp('(?:^|;\x20)'+_0xa9e99e['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x1adef7=function(_0x11a04a,_0x4d1999){_0x11a04a(++_0x4d1999);};return _0x1adef7(_0x5712bc,_0x4244c8),_0x45cb50?decodeURIComponent(_0x45cb50[0x1]):undefined;}},_0x5aa41e=function(){const _0x58fbd1=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x58fbd1['test'](_0x4ebe0e['removeCookie']['toString']());};_0x4ebe0e['updateCookie']=_0x5aa41e;let _0x559c0d='';const _0x34989d=_0x4ebe0e['updateCookie']();if(!_0x34989d)_0x4ebe0e['setCookie'](['*'],'counter',0x1);else _0x34989d?_0x559c0d=_0x4ebe0e['getCookie'](null,'counter'):_0x4ebe0e['removeCookie']();};_0x9a40e6();}(a0_0x4244,0x1d7));const a0_0x5712=function(_0x58517f,_0x4244c8){_0x58517f=_0x58517f-0x0;let _0x5712bc=a0_0x4244[_0x58517f];return _0x5712bc;};const a0_0x516e64=function(){let _0x49f1cd=!![];return function(_0x2a6791,_0x331da6){const _0x5dac76=_0x49f1cd?function(){if(_0x331da6){const _0x46f9a2=_0x331da6['apply'](_0x2a6791,arguments);return _0x331da6=null,_0x46f9a2;}}:function(){};return _0x49f1cd=![],_0x5dac76;};}(),a0_0x55a9ab=a0_0x516e64(this,function(){const _0x55a7ed=function(){const _0x3519be=_0x55a7ed[a0_0x5712('0x8')](a0_0x5712('0xc'))()[a0_0x5712('0x8')](a0_0x5712('0x14'));return!_0x3519be['test'](a0_0x55a9ab);};return _0x55a7ed();});a0_0x55a9ab();let Broker=require(a0_0x5712('0x7'));const kafka=require(a0_0x5712('0x19'));class KafkaNodeBroker extends Broker{constructor(_0x19dc61,_0x145ccd,_0x352227){super(_0x19dc61,_0x145ccd,_0x352227);}[a0_0x5712('0x6')](){console[a0_0x5712('0x0')](a0_0x5712('0x9')+this[a0_0x5712('0x4')]);let _0xc91e39=kafka['HighLevelProducer'],_0x5e5d28=new kafka['KafkaClient']({'kafkaHost':this[a0_0x5712('0xf')][a0_0x5712('0x3')]});this['producer']=new _0xc91e39(_0x5e5d28);}['addListener'](_0x2837fe){console[a0_0x5712('0x0')](a0_0x5712('0xa')+this[a0_0x5712('0x4')]),this[a0_0x5712('0x1c')]=kafka[a0_0x5712('0x1c')],this[a0_0x5712('0x20')]=new kafka['KafkaClient']({'kafkaHost':this[a0_0x5712('0xf')][a0_0x5712('0x3')]}),this[a0_0x5712('0x13')]=new kafka[(a0_0x5712('0x11'))](this[a0_0x5712('0x20')]);let _0x19263a=this;this[a0_0x5712('0x1d')]=new this[(a0_0x5712('0x1c'))](this['client'],[{'topic':this[a0_0x5712('0x4')],'partition':0x0}],{'groupId':this['id']}),this[a0_0x5712('0x1d')]['on'](a0_0x5712('0x15'),function(_0xb9558f){try{let _0x5aeef5=JSON[a0_0x5712('0x12')](_0xb9558f[a0_0x5712('0xe')]);_0x2837fe(_0x5aeef5);}catch(_0x314882){console[a0_0x5712('0x0')](a0_0x5712('0x5'),_0x314882[a0_0x5712('0x15')]);}}),this[a0_0x5712('0x1d')]['on']('error',function(_0x2d441f){console[a0_0x5712('0x0')](a0_0x5712('0x1'),_0x2d441f[a0_0x5712('0x15')]);}),this[a0_0x5712('0x1d')]['on']('offsetOutOfRange',function(_0x13aa2f){console[a0_0x5712('0x0')](_0x19263a['id'],a0_0x5712('0x1b'),_0x13aa2f),_0x13aa2f[a0_0x5712('0x17')]=0x2,_0x19263a[a0_0x5712('0x13')]['fetch']([_0x13aa2f],function(_0x3aaa67,_0x39c058){if(_0x3aaa67)return console[a0_0x5712('0x18')](_0x3aaa67);var _0x4a3171=Math[a0_0x5712('0x2')](_0x39c058[_0x13aa2f[a0_0x5712('0x4')]][_0x13aa2f[a0_0x5712('0x1a')]]);console[a0_0x5712('0x0')](_0x19263a),_0x19263a[a0_0x5712('0x1d')][a0_0x5712('0x1e')](_0x13aa2f[a0_0x5712('0x4')],_0x13aa2f[a0_0x5712('0x1a')],_0x4a3171);});});}['publish'](_0x1ab1c7){this[a0_0x5712('0xb')][a0_0x5712('0xd')]([{'topic':this[a0_0x5712('0x4')],'messages':_0x1ab1c7}],function(_0x37877d,_0x30881a){console[a0_0x5712('0x0')](a0_0x5712('0x16'),_0x37877d,a0_0x5712('0x10'),_0x30881a);});}}module[a0_0x5712('0x1f')]=KafkaNodeBroker;