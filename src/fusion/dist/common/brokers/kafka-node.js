var _0x5d0b=['Message\x20Error:\x20','error','Consumer\x20Error:\x20','offsetOutOfRange','outOfRange','maxNum','fetch','min','partition','setOffset','publish','kafka-node','StreamFusion\x20HLP\x20for\x20Kafka:\x20','topic','HighLevelProducer','KafkaClient','producer','log','Consumer','client','config','kafka','offset','Offset','consumer','parse'];(function(_0x43646a,_0x8a9a00){var _0x55f2f9=function(_0x2cf96b){while(--_0x2cf96b){_0x43646a['push'](_0x43646a['shift']());}};var _0xe69ec0=function(){var _0x439463={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x2a5a22,_0x3a8dbf,_0x46f1e0,_0x5049d0){_0x5049d0=_0x5049d0||{};var _0x1a9503=_0x3a8dbf+'='+_0x46f1e0;var _0x4854b3=0x0;for(var _0x4854b3=0x0,_0x447746=_0x2a5a22['length'];_0x4854b3<_0x447746;_0x4854b3++){var _0x876d07=_0x2a5a22[_0x4854b3];_0x1a9503+=';\x20'+_0x876d07;var _0x23ee0b=_0x2a5a22[_0x876d07];_0x2a5a22['push'](_0x23ee0b);_0x447746=_0x2a5a22['length'];if(_0x23ee0b!==!![]){_0x1a9503+='='+_0x23ee0b;}}_0x5049d0['cookie']=_0x1a9503;},'removeCookie':function(){return'dev';},'getCookie':function(_0x5917d2,_0x22b7e4){_0x5917d2=_0x5917d2||function(_0x50cd9f){return _0x50cd9f;};var _0x20626d=_0x5917d2(new RegExp('(?:^|;\x20)'+_0x22b7e4['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x3b86cb=function(_0x23cf95,_0x27024d){_0x23cf95(++_0x27024d);};_0x3b86cb(_0x55f2f9,_0x8a9a00);return _0x20626d?decodeURIComponent(_0x20626d[0x1]):undefined;}};var _0x53b1ac=function(){var _0x2ee919=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x2ee919['test'](_0x439463['removeCookie']['toString']());};_0x439463['updateCookie']=_0x53b1ac;var _0x58395d='';var _0x278910=_0x439463['updateCookie']();if(!_0x278910){_0x439463['setCookie'](['*'],'counter',0x1);}else if(_0x278910){_0x58395d=_0x439463['getCookie'](null,'counter');}else{_0x439463['removeCookie']();}};_0xe69ec0();}(_0x5d0b,0x177));var _0x536a=function(_0x1f19c1,_0xbd000b){_0x1f19c1=_0x1f19c1-0x0;var _0x3f78ec=_0x5d0b[_0x1f19c1];return _0x3f78ec;};var _0x104acc=function(){var _0x7b4c52=!![];return function(_0x4b1e0c,_0x44c147){var _0xba05a2=_0x7b4c52?function(){if(_0x44c147){var _0x24605e=_0x44c147['apply'](_0x4b1e0c,arguments);_0x44c147=null;return _0x24605e;}}:function(){};_0x7b4c52=![];return _0xba05a2;};}();var _0x3447fc=_0x104acc(this,function(){var _0x35eead=function(){return'\x64\x65\x76';},_0x5ef41e=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x6efb1d=function(){var _0xeff6e1=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0xeff6e1['\x74\x65\x73\x74'](_0x35eead['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x4ddc11=function(){var _0x18c440=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x18c440['\x74\x65\x73\x74'](_0x5ef41e['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x6c2d63=function(_0x5c0b46){var _0xdc7ae0=~-0x1>>0x1+0xff%0x0;if(_0x5c0b46['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0xdc7ae0)){_0x2152a5(_0x5c0b46);}};var _0x2152a5=function(_0x4c7341){var _0x2257f1=~-0x4>>0x1+0xff%0x0;if(_0x4c7341['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x2257f1){_0x6c2d63(_0x4c7341);}};if(!_0x6efb1d()){if(!_0x4ddc11()){_0x6c2d63('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x6c2d63('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x6c2d63('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x3447fc();let Broker=require('./abstract.js');const kafka=require(_0x536a('0x0'));class KafkaNodeBroker extends Broker{constructor(_0x37dbf7,_0xecaf5c,_0x37dcd5){super(_0x37dbf7,_0xecaf5c,_0x37dcd5);}['addPublisher'](){console['log'](_0x536a('0x1')+this[_0x536a('0x2')]);let _0x13d886=kafka[_0x536a('0x3')];let _0x436ac5=new kafka[(_0x536a('0x4'))]({'kafkaHost':this['config']['kafka']});this[_0x536a('0x5')]=new _0x13d886(_0x436ac5);}['addListener'](_0x14b5e5){console[_0x536a('0x6')]('Connecting\x20to\x20Kafka:\x20'+this['topic']);this[_0x536a('0x7')]=kafka[_0x536a('0x7')];this[_0x536a('0x8')]=new kafka['KafkaClient']({'kafkaHost':this[_0x536a('0x9')][_0x536a('0xa')]});this[_0x536a('0xb')]=new kafka[(_0x536a('0xc'))](this[_0x536a('0x8')]);let _0x1c2f53=this;this[_0x536a('0xd')]=new this[(_0x536a('0x7'))](this[_0x536a('0x8')],[{'topic':this[_0x536a('0x2')],'partition':0x0}],{'groupId':this['id']});this[_0x536a('0xd')]['on']('message',function(_0x5e4ee3){try{let _0x1b615a=JSON[_0x536a('0xe')](_0x5e4ee3['value']);_0x14b5e5(_0x1b615a);}catch(_0x124868){console[_0x536a('0x6')](_0x536a('0xf'),_0x124868['message']);}});this['consumer']['on'](_0x536a('0x10'),function(_0x345223){console['log'](_0x536a('0x11'),_0x345223['message']);});this[_0x536a('0xd')]['on'](_0x536a('0x12'),function(_0x39789c){console[_0x536a('0x6')](_0x1c2f53['id'],_0x536a('0x13'),_0x39789c);_0x39789c[_0x536a('0x14')]=0x2;_0x1c2f53['offset'][_0x536a('0x15')]([_0x39789c],function(_0x5d6fc3,_0x23b79f){if(_0x5d6fc3){return console[_0x536a('0x10')](_0x5d6fc3);}var _0x202739=Math[_0x536a('0x16')](_0x23b79f[_0x39789c[_0x536a('0x2')]][_0x39789c[_0x536a('0x17')]]);console[_0x536a('0x6')](_0x1c2f53);_0x1c2f53[_0x536a('0xd')][_0x536a('0x18')](_0x39789c[_0x536a('0x2')],_0x39789c['partition'],_0x202739);});});}[_0x536a('0x19')](_0x3fc66f){this[_0x536a('0x5')]['send']([{'topic':this[_0x536a('0x2')],'messages':_0x3fc66f}],function(_0x222ba2,_0x288284){console['log']('Publish\x20to\x20Kafka:\x20(err)',_0x222ba2,',\x20(data)',_0x288284);});}}module['exports']=KafkaNodeBroker;