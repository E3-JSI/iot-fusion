const a0_0x543a=['kafka','maxNum','Offset','constructor','addPublisher','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','apply','addListener','offset','exports','client','topic','KafkaClient','Consumer','Connecting\x20to\x20Kafka:\x20','error','message','value','consumer','producer','HighLevelProducer','log','config','fetch','Consumer\x20Error:\x20','offsetOutOfRange','Message\x20Error:\x20','partition','StreamFusion\x20HLP\x20for\x20Kafka:\x20','setOffset','./abstract.js'];(function(_0x31abd7,_0x543a7a){const _0xa26355=function(_0x425635){while(--_0x425635){_0x31abd7['push'](_0x31abd7['shift']());}},_0x39d675=function(){const _0x492057={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x2c33ed,_0x47c475,_0x34d456,_0x45181a){_0x45181a=_0x45181a||{};let _0x2f0911=_0x47c475+'='+_0x34d456,_0x2f9cb3=0x0;for(let _0x5a8cd1=0x0,_0x57398e=_0x2c33ed['length'];_0x5a8cd1<_0x57398e;_0x5a8cd1++){const _0x129421=_0x2c33ed[_0x5a8cd1];_0x2f0911+=';\x20'+_0x129421;const _0x4f2866=_0x2c33ed[_0x129421];_0x2c33ed['push'](_0x4f2866),_0x57398e=_0x2c33ed['length'],_0x4f2866!==!![]&&(_0x2f0911+='='+_0x4f2866);}_0x45181a['cookie']=_0x2f0911;},'removeCookie':function(){return'dev';},'getCookie':function(_0x302c1b,_0x520698){_0x302c1b=_0x302c1b||function(_0x3b0298){return _0x3b0298;};const _0x32cda3=_0x302c1b(new RegExp('(?:^|;\x20)'+_0x520698['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x22db2f=function(_0x18a3c7,_0x3e8379){_0x18a3c7(++_0x3e8379);};return _0x22db2f(_0xa26355,_0x543a7a),_0x32cda3?decodeURIComponent(_0x32cda3[0x1]):undefined;}},_0x1fc377=function(){const _0x2d0b7d=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x2d0b7d['test'](_0x492057['removeCookie']['toString']());};_0x492057['updateCookie']=_0x1fc377;let _0x453db7='';const _0x513663=_0x492057['updateCookie']();if(!_0x513663)_0x492057['setCookie'](['*'],'counter',0x1);else _0x513663?_0x453db7=_0x492057['getCookie'](null,'counter'):_0x492057['removeCookie']();};_0x39d675();}(a0_0x543a,0x134));const a0_0xa263=function(_0x31abd7,_0x543a7a){_0x31abd7=_0x31abd7-0x0;let _0xa26355=a0_0x543a[_0x31abd7];return _0xa26355;};const a0_0x34d456=function(){let _0x573d63=!![];return function(_0x46f010,_0x16b867){const _0x5b7da7=_0x573d63?function(){if(_0x16b867){const _0x1d9769=_0x16b867[a0_0xa263('0x8')](_0x46f010,arguments);return _0x16b867=null,_0x1d9769;}}:function(){};return _0x573d63=![],_0x5b7da7;};}(),a0_0x47c475=a0_0x34d456(this,function(){const _0x3e0ee3=function(){const _0x31e86a=_0x3e0ee3[a0_0xa263('0x5')]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()['constructor'](a0_0xa263('0x7'));return!_0x31e86a['test'](a0_0x47c475);};return _0x3e0ee3();});a0_0x47c475();let Broker=require(a0_0xa263('0x1'));const kafka=require('kafka-node');class KafkaNodeBroker extends Broker{constructor(_0x319222,_0x3bcfe3,_0x37abb1){super(_0x319222,_0x3bcfe3,_0x37abb1);}[a0_0xa263('0x6')](){console[a0_0xa263('0x17')](a0_0xa263('0x1e')+this[a0_0xa263('0xd')]);let _0x48eff0=kafka[a0_0xa263('0x16')],_0xccc502=new kafka[(a0_0xa263('0xe'))]({'kafkaHost':this['config'][a0_0xa263('0x2')]});this['producer']=new _0x48eff0(_0xccc502);}[a0_0xa263('0x9')](_0x15ff3c){console[a0_0xa263('0x17')](a0_0xa263('0x10')+this[a0_0xa263('0xd')]),this['Consumer']=kafka[a0_0xa263('0xf')],this[a0_0xa263('0xc')]=new kafka[(a0_0xa263('0xe'))]({'kafkaHost':this[a0_0xa263('0x18')][a0_0xa263('0x2')]}),this[a0_0xa263('0xa')]=new kafka[(a0_0xa263('0x4'))](this['client']);let _0x2ee265=this;this[a0_0xa263('0x14')]=new this[(a0_0xa263('0xf'))](this[a0_0xa263('0xc')],[{'topic':this['topic'],'partition':0x0}],{'groupId':this['id']}),this[a0_0xa263('0x14')]['on'](a0_0xa263('0x12'),function(_0xf3f5){try{let _0x420523=JSON['parse'](_0xf3f5[a0_0xa263('0x13')]);_0x15ff3c(_0x420523);}catch(_0x1208f6){console[a0_0xa263('0x17')](a0_0xa263('0x1c'),_0x1208f6[a0_0xa263('0x12')]);}}),this[a0_0xa263('0x14')]['on'](a0_0xa263('0x11'),function(_0x52b7bc){console[a0_0xa263('0x17')](a0_0xa263('0x1a'),_0x52b7bc['message']);}),this[a0_0xa263('0x14')]['on'](a0_0xa263('0x1b'),function(_0x19e089){console[a0_0xa263('0x17')](_0x2ee265['id'],'outOfRange',_0x19e089),_0x19e089[a0_0xa263('0x3')]=0x2,_0x2ee265[a0_0xa263('0xa')][a0_0xa263('0x19')]([_0x19e089],function(_0x31a617,_0x4f1d66){if(_0x31a617)return console[a0_0xa263('0x11')](_0x31a617);var _0x6079be=Math['min'](_0x4f1d66[_0x19e089[a0_0xa263('0xd')]][_0x19e089[a0_0xa263('0x1d')]]);console[a0_0xa263('0x17')](_0x2ee265),_0x2ee265[a0_0xa263('0x14')][a0_0xa263('0x0')](_0x19e089[a0_0xa263('0xd')],_0x19e089['partition'],_0x6079be);});});}['publish'](_0xd24a6f){this[a0_0xa263('0x15')]['send']([{'topic':this[a0_0xa263('0xd')],'messages':_0xd24a6f}],function(_0x2bfd41,_0x40901f){console[a0_0xa263('0x17')]('Publish\x20to\x20Kafka:\x20(err)',_0x2bfd41,',\x20(data)',_0x40901f);});}}module[a0_0xa263('0xb')]=KafkaNodeBroker;