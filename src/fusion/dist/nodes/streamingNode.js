var _0xaf69=['\x20-\x20(','deleteObsoleteRows','Rows\x20to\x20delete\x20(','):\x20','\x20/\x20','shift','createAggregates','tick','addStreamAggr','timeSeriesTick','Time','|tick','aggregate','ema','interval','rawstore','previous','winsize','timeSeriesWinBufVector','|winbuf|','sub','variance','|variance|','|ma|','winBufMin','|min|','max','winBufMax','indexOf','winbuf','getPartialFeatureVector','name','timeDiff','push','exports','../../common/brokers/brokers.js','master','config','stringify','parse','topic','measurements_node_','nodeid','processRecordCb','parent','fusionTick','nodeId','buffer','position','postConstructor','type','kafka','fusion_id','broker','processRecord','bind','mqtt','connectionConfig','client','addListener','PROBLEM:\x20No\x20connection\x20(OK\x20for\x20tests)!','log','isMaster','connectToKafka','Connecting\x20to\x20Kafka:\x20','Consumer','zookeeper','offset','consumer','message','value','ERROR','Error','offsetOutOfRange','outOfRange','fetch','error','min','partition','setOffset','broadcastAggregates','setMasterOffset','getOffsetTimestamp','setSlaveOffset','length','setSlaveIndex:\x20there\x20is\x20no\x20data\x20-\x20','stampm','Diff\x20ticks:','setSlaveOffset:\x20index\x20does\x20not\x20exist\x20(too\x20small)\x20-\x20','setSlaveOffset:\x20index\x20does\x20not\x20exist\x20(too\x20big)\x20-\x20','floor','setSlaveOffset:\x20zeroIndex\x20is\x20not\x20a\x20whole\x20number\x20-\x20','\x0aZero\x20index,\x20last\x20offset:\x20','\x0aDifference\x20(buffer\x20-\x20zero):\x20','\x20-\x20','\x0a\x0a\x0a','checkDataAvailability','maxNegativeOffset','attributes','time','offsetExists','offsetExists:\x20index\x20does\x20not\x20exist\x20(too\x20small)\x20-\x20'];(function(_0x192c81,_0x4b5c27){var _0x586dd7=function(_0x28f45e){while(--_0x28f45e){_0x192c81['push'](_0x192c81['shift']());}};var _0x253708=function(){var _0x8723a6={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x5488f0,_0x3fdf20,_0x4550d6,_0x5aae11){_0x5aae11=_0x5aae11||{};var _0x19119a=_0x3fdf20+'='+_0x4550d6;var _0x5ac53e=0x0;for(var _0x5ac53e=0x0,_0x332dfc=_0x5488f0['length'];_0x5ac53e<_0x332dfc;_0x5ac53e++){var _0x172226=_0x5488f0[_0x5ac53e];_0x19119a+=';\x20'+_0x172226;var _0x45590d=_0x5488f0[_0x172226];_0x5488f0['push'](_0x45590d);_0x332dfc=_0x5488f0['length'];if(_0x45590d!==!![]){_0x19119a+='='+_0x45590d;}}_0x5aae11['cookie']=_0x19119a;},'removeCookie':function(){return'dev';},'getCookie':function(_0x35f7e9,_0x371c48){_0x35f7e9=_0x35f7e9||function(_0x44d4ea){return _0x44d4ea;};var _0x5ef47d=_0x35f7e9(new RegExp('(?:^|;\x20)'+_0x371c48['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x23f5e9=function(_0x23c28d,_0x3ad972){_0x23c28d(++_0x3ad972);};_0x23f5e9(_0x586dd7,_0x4b5c27);return _0x5ef47d?decodeURIComponent(_0x5ef47d[0x1]):undefined;}};var _0x2f12fc=function(){var _0x426a77=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x426a77['test'](_0x8723a6['removeCookie']['toString']());};_0x8723a6['updateCookie']=_0x2f12fc;var _0x2a9434='';var _0xabd146=_0x8723a6['updateCookie']();if(!_0xabd146){_0x8723a6['setCookie'](['*'],'counter',0x1);}else if(_0xabd146){_0x2a9434=_0x8723a6['getCookie'](null,'counter');}else{_0x8723a6['removeCookie']();}};_0x253708();}(_0xaf69,0xef));var _0x45ef=function(_0x581e23,_0xd59411){_0x581e23=_0x581e23-0x0;var _0x23217b=_0xaf69[_0x581e23];return _0x23217b;};var _0x365ccc=function(){var _0x4e1d7f=!![];return function(_0xe92291,_0x245404){var _0x467555=_0x4e1d7f?function(){if(_0x245404){var _0x5f4ab3=_0x245404['apply'](_0xe92291,arguments);_0x245404=null;return _0x5f4ab3;}}:function(){};_0x4e1d7f=![];return _0x467555;};}();var _0x2af60e=_0x365ccc(this,function(){var _0x387123=function(){return'\x64\x65\x76';},_0x29c413=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x697162=function(){var _0x226d04=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x226d04['\x74\x65\x73\x74'](_0x387123['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x2c125d=function(){var _0x9be6ec=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x9be6ec['\x74\x65\x73\x74'](_0x29c413['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x546ea3=function(_0x51cc46){var _0x5b76a2=~-0x1>>0x1+0xff%0x0;if(_0x51cc46['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x5b76a2)){_0x9dcbc8(_0x51cc46);}};var _0x9dcbc8=function(_0x3a3e5a){var _0x15fb35=~-0x4>>0x1+0xff%0x0;if(_0x3a3e5a['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x15fb35){_0x546ea3(_0x3a3e5a);}};if(!_0x697162()){if(!_0x2c125d()){_0x546ea3('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x546ea3('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x546ea3('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x2af60e();const {KafkaNodeBroker,MQTTBroker,KafkaRDBroker}=require(_0x45ef('0x0'));class streamingNode{constructor(_0x27d63c,_0x488e84,_0x1ffe77,_0xd4706f,_0x213d71,_0x5477de,_0x530154){this['base']=_0x27d63c;this['aggregate']={};this[_0x45ef('0x1')]=_0x1ffe77['master'];this[_0x45ef('0x2')]=JSON['parse'](JSON[_0x45ef('0x3')](_0x1ffe77));this['connectionConfig']=JSON[_0x45ef('0x4')](JSON[_0x45ef('0x3')](_0x488e84));this[_0x45ef('0x5')]=_0x45ef('0x6')+this['config'][_0x45ef('0x7')];this['fusionNodeI']=_0x5477de;this[_0x45ef('0x8')]=_0x213d71;this[_0x45ef('0x9')]=_0x530154;this['fusionTick']=_0x1ffe77[_0x45ef('0xa')];this[_0x45ef('0xb')]=_0x1ffe77[_0x45ef('0x7')];this[_0x45ef('0xc')]=[];this[_0x45ef('0xd')]=0x0;}[_0x45ef('0xe')](){let _0xea6220=this;if(this[_0x45ef('0x9')]!=null){if(this[_0x45ef('0x9')][_0x45ef('0x2')]['connection'][_0x45ef('0xf')]==_0x45ef('0x10')){this['broker']=new KafkaNodeBroker(this['connectionConfig'],this[_0x45ef('0x5')],'client'+this[_0x45ef('0x9')][_0x45ef('0x11')]+this[_0x45ef('0xb')]);this[_0x45ef('0x12')]['addListener'](_0xea6220[_0x45ef('0x13')][_0x45ef('0x14')](_0xea6220));}else if(this['parent'][_0x45ef('0x2')]['connection']['type']==_0x45ef('0x15')){this[_0x45ef('0x12')]=new MQTTBroker(this[_0x45ef('0x16')],this[_0x45ef('0x5')],_0x45ef('0x17')+this[_0x45ef('0x9')][_0x45ef('0x11')]+this[_0x45ef('0xb')]);this['broker'][_0x45ef('0x18')](_0xea6220['processRecord']['bind'](_0xea6220));}else{console['log'](_0x45ef('0x19'));}}else{console[_0x45ef('0x1a')]('PROBLEM:\x20No\x20parent\x20defined.\x20No\x20connection\x20(OK\x20for\x20tests).');}}[_0x45ef('0x1b')](){return this[_0x45ef('0x1')];}[_0x45ef('0x1c')](){console[_0x45ef('0x1a')](_0x45ef('0x1d')+this[_0x45ef('0x5')]);this[_0x45ef('0x1e')]=kafka['Consumer'];this[_0x45ef('0x17')]=new kafka['Client'](this['connectionConfig'][_0x45ef('0x1f')],this['id']);this[_0x45ef('0x20')]=new kafka['Offset'](this['client']);let _0x5a66d0=this;this[_0x45ef('0x21')]=new this[(_0x45ef('0x1e'))](this['client'],[{'topic':this[_0x45ef('0x5')],'partition':0x0}],{'groupId':this['id']});this[_0x45ef('0x21')]['on'](_0x45ef('0x22'),function(_0x5e8abf){try{console['log']('Message\x20receieved.');let _0x3c9a0f=JSON[_0x45ef('0x4')](_0x5e8abf[_0x45ef('0x23')]);_0x5a66d0[_0x45ef('0x13')](_0x3c9a0f);}catch(_0x13b723){console[_0x45ef('0x1a')](_0x45ef('0x24'),_0x13b723);}});this[_0x45ef('0x21')]['on']('error',function(_0x3c5da3){console[_0x45ef('0x1a')](_0x45ef('0x25'),_0x3c5da3);});this[_0x45ef('0x21')]['on'](_0x45ef('0x26'),function(_0x18d0c7){console[_0x45ef('0x1a')](_0x5a66d0['id'],_0x45ef('0x27'),_0x18d0c7);_0x18d0c7['maxNum']=0x2;_0x5a66d0[_0x45ef('0x20')][_0x45ef('0x28')]([_0x18d0c7],function(_0x5c214d,_0x1950f8){if(_0x5c214d){return console[_0x45ef('0x29')](_0x5c214d);}var _0x839e55=Math[_0x45ef('0x2a')](_0x1950f8[_0x18d0c7[_0x45ef('0x5')]][_0x18d0c7[_0x45ef('0x2b')]]);console[_0x45ef('0x1a')](_0x5a66d0);_0x5a66d0[_0x45ef('0x21')][_0x45ef('0x2c')](_0x18d0c7[_0x45ef('0x5')],_0x18d0c7[_0x45ef('0x2b')],_0x839e55);});});}[_0x45ef('0x2d')](_0x561004){}[_0x45ef('0x2e')](){this[_0x45ef('0xd')]=this[_0x45ef('0xc')]['length']-0x1;}[_0x45ef('0x2f')](){return this[_0x45ef('0xc')][this[_0x45ef('0xd')]]['stampm'];}[_0x45ef('0x30')](_0x5cea51){if(this[_0x45ef('0xc')][_0x45ef('0x31')]==0x0){console[_0x45ef('0x1a')](_0x45ef('0x32')+this[_0x45ef('0xb')]);return![];}let _0x252a2c=this[_0x45ef('0xc')][_0x45ef('0x31')]-0x1;let _0x1c934f=this['buffer'][_0x252a2c][_0x45ef('0x33')];let _0x1d0fcc=(_0x1c934f-_0x5cea51)/this[_0x45ef('0xa')];console[_0x45ef('0x1a')]('Fusion\x20tick',this['fusionTick'],_0x45ef('0x34'),_0x1d0fcc);let _0x263df2=_0x252a2c-_0x1d0fcc;if(_0x263df2<0x0){console[_0x45ef('0x1a')](_0x45ef('0x35')+this[_0x45ef('0xb')]+'('+_0x263df2+'/'+_0x252a2c+')@'+this[_0x45ef('0x9')][_0x45ef('0x11')]);return![];}else if(_0x263df2>_0x252a2c){console['log'](_0x45ef('0x36')+this[_0x45ef('0xb')]+'('+_0x263df2+'/'+_0x252a2c+')@'+this[_0x45ef('0x9')][_0x45ef('0x11')]);return![];}else if(_0x263df2!=Math[_0x45ef('0x37')](_0x263df2)){console['log'](_0x45ef('0x38')+_0x263df2);}console['log'](_0x263df2);if(this[_0x45ef('0xc')][_0x263df2][_0x45ef('0x33')]!=_0x5cea51){console['log']('\x0a\x0asetSlaveOffset:\x20ERROR\x20-\x20timestamps\x20DO\x20NOT\x20match!');console[_0x45ef('0x1a')]('\x0aNode:\x20'+this['nodeId']);console[_0x45ef('0x1a')](_0x45ef('0x39')+_0x263df2+',\x20'+_0x252a2c);console[_0x45ef('0x1a')](_0x45ef('0x3a')+this[_0x45ef('0xc')][_0x263df2][_0x45ef('0x33')]+_0x45ef('0x3b')+_0x5cea51);console[_0x45ef('0x1a')](_0x45ef('0x3c'));}this[_0x45ef('0xd')]=_0x263df2;return!![];}[_0x45ef('0x3d')](){let _0x39b7b6=!![];this[_0x45ef('0x3e')]=0x0;for(let _0x13f159 in this[_0x45ef('0x2')][_0x45ef('0x3f')]){let _0x4b8697=this[_0x45ef('0x2')][_0x45ef('0x3f')][_0x13f159][_0x45ef('0x40')];if(_0x4b8697<this[_0x45ef('0x3e')])this[_0x45ef('0x3e')]=_0x4b8697;if(!this[_0x45ef('0x41')](_0x4b8697))_0x39b7b6=![];}return _0x39b7b6;}[_0x45ef('0x41')](_0xa50f67){let _0x678323=this['position']+_0xa50f67;let _0x5f4e7a=this['buffer'][_0x45ef('0x31')]-0x1;if(_0x678323<0x0){console[_0x45ef('0x1a')](_0x45ef('0x42')+this[_0x45ef('0xb')]+_0x45ef('0x43')+_0x678323+')');return![];}else if(_0x678323>_0x5f4e7a){console['log']('offsetExists:\x20index\x20does\x20not\x20exist\x20(too\x20big)\x20-\x20'+this['nodeId']+this[_0x45ef('0xb')]+_0x45ef('0x43')+_0x678323+'/'+_0x5f4e7a+')');return![];}return!![];}[_0x45ef('0x44')](){let _0x28d128=this['position']+this[_0x45ef('0x3e')]-0x5;console['log'](_0x45ef('0x45')+this[_0x45ef('0xb')]+',\x20'+this[_0x45ef('0x9')]['fusion_id']+_0x45ef('0x46')+_0x28d128+_0x45ef('0x47')+this[_0x45ef('0xc')][_0x45ef('0x31')]);for(let _0x2a72f1=0x1;_0x2a72f1<_0x28d128;_0x2a72f1++)this[_0x45ef('0xc')][_0x45ef('0x48')]();}[_0x45ef('0x49')](_0x1449c3){for(let _0xdf4a18 in _0x1449c3){let _0x519bb6=_0x1449c3[_0xdf4a18];let _0x48228c=_0x519bb6['field'];let _0xf5b811=_0x519bb6[_0x45ef('0x4a')];let _0xf3d081=this['rawstore'][_0x45ef('0x4b')]({'type':_0x45ef('0x4c'),'timestamp':_0x45ef('0x4d'),'value':_0x48228c});let _0x173dd8=_0x48228c+_0x45ef('0x4e');this[_0x45ef('0x4f')][_0x173dd8]=_0xf3d081;for(let _0x3d0912 in _0xf5b811){let _0x5c4f80=_0xf5b811[_0x3d0912];let _0x7dff95=_0x5c4f80[_0x45ef('0xf')];if(_0x7dff95==_0x45ef('0x50')){let _0x258e02=_0x5c4f80[_0x45ef('0x51')];let _0x2b6351=_0x5c4f80['initWindow'];let _0xf3d081=this[_0x45ef('0x52')]['addStreamAggr']({'type':'ema','inAggr':this['aggregate'][_0x173dd8],'emaType':_0x45ef('0x53'),'interval':_0x258e02,'initWindow':_0x2b6351});let _0x22e5db=_0x48228c+'|ema|'+_0x258e02;this[_0x45ef('0x4f')][_0x22e5db]=_0xf3d081;}else if(_0x7dff95=='winbuf'){let _0x286ef7=_0x5c4f80[_0x45ef('0x54')];let _0xf3d081=this[_0x45ef('0x52')][_0x45ef('0x4b')]({'type':_0x45ef('0x55'),'inAggr':this[_0x45ef('0x4f')][_0x173dd8],'winsize':_0x286ef7});let _0x51d6cf=_0x48228c+_0x45ef('0x56')+_0x286ef7;this[_0x45ef('0x4f')][_0x51d6cf]=_0xf3d081;let _0x362f1d=_0x5c4f80[_0x45ef('0x57')];for(var _0x385569 in _0x362f1d){let _0x354925=_0x362f1d[_0x385569];let _0x291379=_0x354925[_0x45ef('0xf')];if(_0x291379=='variance'){let _0xf3d081=this[_0x45ef('0x52')][_0x45ef('0x4b')]({'type':_0x45ef('0x58'),'inAggr':this[_0x45ef('0x4f')][_0x51d6cf]});let _0x571749=_0x48228c+_0x45ef('0x59')+_0x286ef7;this[_0x45ef('0x4f')][_0x571749]=_0xf3d081;}else if(_0x291379=='ma'){let _0xf3d081=this[_0x45ef('0x52')][_0x45ef('0x4b')]({'type':'ma','inAggr':this[_0x45ef('0x4f')][_0x51d6cf]});let _0x1948e4=_0x48228c+_0x45ef('0x5a')+_0x286ef7;this[_0x45ef('0x4f')][_0x1948e4]=_0xf3d081;}else if(_0x291379==_0x45ef('0x2a')){let _0xf3d081=this[_0x45ef('0x52')][_0x45ef('0x4b')]({'type':_0x45ef('0x5b'),'inAggr':this[_0x45ef('0x4f')][_0x51d6cf]});let _0x3e558a=_0x48228c+_0x45ef('0x5c')+_0x286ef7;this[_0x45ef('0x4f')][_0x3e558a]=_0xf3d081;}else if(_0x291379==_0x45ef('0x5d')){let _0xf3d081=this[_0x45ef('0x52')][_0x45ef('0x4b')]({'type':_0x45ef('0x5e'),'inAggr':this['aggregate'][_0x51d6cf]});let _0x15827d=_0x48228c+'|max|'+_0x286ef7;this[_0x45ef('0x4f')][_0x15827d]=_0xf3d081;}}}}}}['getAggregates'](){var _0x381140={};for(let _0x3ae39d in this[_0x45ef('0x4f')]){if(!(_0x3ae39d[_0x45ef('0x5f')](_0x45ef('0x4a'))>0x0||_0x3ae39d[_0x45ef('0x5f')](_0x45ef('0x60'))>0x0)){_0x381140[_0x3ae39d]=this[_0x45ef('0x4f')][_0x3ae39d]['getFloat']();_0x381140[_0x45ef('0x33')]=this[_0x45ef('0x4f')][_0x3ae39d]['getTimestamp']();};};return _0x381140;}[_0x45ef('0x61')](){let _0x236df6=[];for(let _0x4e6b38 in this['config'][_0x45ef('0x3f')]){let _0x265644=this[_0x45ef('0xd')];let _0x41b78=this[_0x45ef('0xc')][_0x265644][_0x45ef('0x33')];let _0x3cdf94=this[_0x45ef('0x2')][_0x45ef('0x3f')][_0x4e6b38][_0x45ef('0x3f')];let _0x10f1d1=this[_0x45ef('0x2')][_0x45ef('0x3f')][_0x4e6b38][_0x45ef('0x40')];_0x265644=_0x265644+_0x10f1d1;let _0x50584e=_0x41b78+_0x10f1d1*this[_0x45ef('0xa')];let _0xbc5350=this[_0x45ef('0xc')][_0x265644]['stampm'];if(_0x50584e!=_0xbc5350){while(_0xbc5350-_0x50584e<0x0){_0x265644++;_0xbc5350=this[_0x45ef('0xc')][_0x265644][_0x45ef('0x33')];}if(_0xbc5350!=_0x50584e)_0x265644--;}for(let _0x1d4a1e in _0x3cdf94){let _0x2fce93=_0x3cdf94[_0x1d4a1e][_0x45ef('0xf')];let _0x548b9e=_0x3cdf94[_0x1d4a1e][_0x45ef('0x62')];if(_0x2fce93==_0x45ef('0x23')){let _0x634172=this[_0x45ef('0xc')][_0x265644][_0x548b9e];_0x236df6['push'](_0x634172);}else if(_0x2fce93==_0x45ef('0x63')){let _0x3077c0=_0x265644-_0x3cdf94[_0x1d4a1e][_0x45ef('0x51')];let _0x59ed0d=this[_0x45ef('0xc')][_0x3077c0][_0x548b9e]-this[_0x45ef('0xc')][_0x265644][_0x548b9e];_0x236df6[_0x45ef('0x64')](_0x59ed0d);}}}return _0x236df6;}}module[_0x45ef('0x65')]=streamingNode;