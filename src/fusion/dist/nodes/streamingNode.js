var _0x185a=['PROBLEM:\x20No\x20connection\x20(OK\x20for\x20tests)!','PROBLEM:\x20No\x20parent\x20defined.\x20No\x20connection\x20(OK\x20for\x20tests).','isMaster','connectToKafka','Consumer','Client','Offset','consumer','message','Message\x20receieved.','value','ERROR','error','Error','offsetOutOfRange','outOfRange','maxNum','offset','fetch','min','partition','setOffset','broadcastAggregates','setMasterOffset','buffer','length','stampm','setSlaveOffset','setSlaveIndex:\x20there\x20is\x20no\x20data\x20-\x20','Fusion\x20tick','Diff\x20ticks:','setSlaveOffset:\x20index\x20does\x20not\x20exist\x20(too\x20small)\x20-\x20','setSlaveOffset:\x20index\x20does\x20not\x20exist\x20(too\x20big)\x20-\x20','\x0a\x0asetSlaveOffset:\x20ERROR\x20-\x20timestamps\x20DO\x20NOT\x20match!','\x0aNode:\x20','\x0aZero\x20index,\x20last\x20offset:\x20','\x0aDifference\x20(buffer\x20-\x20zero):\x20','\x20-\x20','\x0a\x0a\x0a','checkDataAvailability','maxNegativeOffset','attributes','time','offsetExists','offsetExists:\x20index\x20does\x20not\x20exist\x20(too\x20small)\x20-\x20','offsetExists:\x20index\x20does\x20not\x20exist\x20(too\x20big)\x20-\x20','\x20-\x20(','):\x20','\x20/\x20','createAggregates','field','tick','rawstore','Time','|tick','interval','addStreamAggr','ema','|ema|','timeSeriesWinBufVector','|winbuf|','sub','variance','|variance|','|ma|','winBufMin','|min|','max','winBufMax','|max|','getAggregates','indexOf','winbuf','getFloat','getTimestamp','name','push','timeDiff','exports','base','aggregate','master','config','parse','stringify','topic','measurements_node_','nodeid','processRecordCb','parent','fusionTick','position','connection','type','kafka','broker','connectionConfig','client','addListener','processRecord','bind','mqtt','fusion_id','nodeId','log'];(function(_0x34584c,_0x2fbd85){var _0x852cdb=function(_0x68fac9){while(--_0x68fac9){_0x34584c['push'](_0x34584c['shift']());}};var _0x1d1020=function(){var _0x1cac20={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x316a2f,_0x495b63,_0x18fd5b,_0x377f22){_0x377f22=_0x377f22||{};var _0x5a1edb=_0x495b63+'='+_0x18fd5b;var _0x4c9a77=0x0;for(var _0x4c9a77=0x0,_0x4eed99=_0x316a2f['length'];_0x4c9a77<_0x4eed99;_0x4c9a77++){var _0x3557b4=_0x316a2f[_0x4c9a77];_0x5a1edb+=';\x20'+_0x3557b4;var _0x31fac6=_0x316a2f[_0x3557b4];_0x316a2f['push'](_0x31fac6);_0x4eed99=_0x316a2f['length'];if(_0x31fac6!==!![]){_0x5a1edb+='='+_0x31fac6;}}_0x377f22['cookie']=_0x5a1edb;},'removeCookie':function(){return'dev';},'getCookie':function(_0x410b7a,_0x2ef456){_0x410b7a=_0x410b7a||function(_0xb028eb){return _0xb028eb;};var _0x1447db=_0x410b7a(new RegExp('(?:^|;\x20)'+_0x2ef456['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x1ca1ff=function(_0x2c3eb2,_0x33a218){_0x2c3eb2(++_0x33a218);};_0x1ca1ff(_0x852cdb,_0x2fbd85);return _0x1447db?decodeURIComponent(_0x1447db[0x1]):undefined;}};var _0x28c268=function(){var _0x4ac777=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x4ac777['test'](_0x1cac20['removeCookie']['toString']());};_0x1cac20['updateCookie']=_0x28c268;var _0x16fe17='';var _0x8a01d3=_0x1cac20['updateCookie']();if(!_0x8a01d3){_0x1cac20['setCookie'](['*'],'counter',0x1);}else if(_0x8a01d3){_0x16fe17=_0x1cac20['getCookie'](null,'counter');}else{_0x1cac20['removeCookie']();}};_0x1d1020();}(_0x185a,0x121));var _0x11ee=function(_0x5b52ff,_0x4302b8){_0x5b52ff=_0x5b52ff-0x0;var _0x452270=_0x185a[_0x5b52ff];return _0x452270;};var _0x34c773=function(){var _0x368e05=!![];return function(_0x2cf63a,_0x150e30){var _0x4a71f1=_0x368e05?function(){if(_0x150e30){var _0x3e985b=_0x150e30['apply'](_0x2cf63a,arguments);_0x150e30=null;return _0x3e985b;}}:function(){};_0x368e05=![];return _0x4a71f1;};}();var _0x37fa1c=_0x34c773(this,function(){var _0x2d8f05=function(){return'\x64\x65\x76';},_0x4b81bb=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x34a12b=function(){var _0x36c6a6=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x36c6a6['\x74\x65\x73\x74'](_0x2d8f05['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x33748d=function(){var _0x3e4c21=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x3e4c21['\x74\x65\x73\x74'](_0x4b81bb['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x5c685e=function(_0x3e3156){var _0x1e9e81=~-0x1>>0x1+0xff%0x0;if(_0x3e3156['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x1e9e81)){_0x292610(_0x3e3156);}};var _0x292610=function(_0x151bd2){var _0x558098=~-0x4>>0x1+0xff%0x0;if(_0x151bd2['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x558098){_0x5c685e(_0x151bd2);}};if(!_0x34a12b()){if(!_0x33748d()){_0x5c685e('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x5c685e('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x5c685e('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x37fa1c();const {KafkaNodeBroker,MQTTBroker,KafkaRDBroker}=require('../../common/brokers/brokers.js');class streamingNode{constructor(_0x4ff1ea,_0x1aa345,_0x5d3d70,_0x401c67,_0x3243ff,_0x162f13,_0x1b6cc4){this[_0x11ee('0x0')]=_0x4ff1ea;this[_0x11ee('0x1')]={};this[_0x11ee('0x2')]=_0x5d3d70['master'];this[_0x11ee('0x3')]=JSON[_0x11ee('0x4')](JSON[_0x11ee('0x5')](_0x5d3d70));this['connectionConfig']=JSON['parse'](JSON[_0x11ee('0x5')](_0x1aa345));this[_0x11ee('0x6')]=_0x11ee('0x7')+this[_0x11ee('0x3')][_0x11ee('0x8')];this['fusionNodeI']=_0x162f13;this[_0x11ee('0x9')]=_0x3243ff;this[_0x11ee('0xa')]=_0x1b6cc4;this[_0x11ee('0xb')]=_0x5d3d70[_0x11ee('0xb')];this['nodeId']=_0x5d3d70['nodeid'];this['buffer']=[];this[_0x11ee('0xc')]=0x0;}['postConstructor'](){let _0x270d76=this;if(this['parent']!=null){if(this[_0x11ee('0xa')][_0x11ee('0x3')][_0x11ee('0xd')][_0x11ee('0xe')]==_0x11ee('0xf')){this[_0x11ee('0x10')]=new KafkaNodeBroker(this[_0x11ee('0x11')],this[_0x11ee('0x6')],_0x11ee('0x12')+this['parent']['fusion_id']+this['nodeId']);this[_0x11ee('0x10')][_0x11ee('0x13')](_0x270d76[_0x11ee('0x14')][_0x11ee('0x15')](_0x270d76));}else if(this['parent'][_0x11ee('0x3')][_0x11ee('0xd')][_0x11ee('0xe')]==_0x11ee('0x16')){this[_0x11ee('0x10')]=new MQTTBroker(this[_0x11ee('0x11')],this[_0x11ee('0x6')],_0x11ee('0x12')+this[_0x11ee('0xa')][_0x11ee('0x17')]+this[_0x11ee('0x18')]);this[_0x11ee('0x10')][_0x11ee('0x13')](_0x270d76[_0x11ee('0x14')]['bind'](_0x270d76));}else{console[_0x11ee('0x19')](_0x11ee('0x1a'));}}else{console[_0x11ee('0x19')](_0x11ee('0x1b'));}}[_0x11ee('0x1c')](){return this[_0x11ee('0x2')];}[_0x11ee('0x1d')](){console[_0x11ee('0x19')]('Connecting\x20to\x20Kafka:\x20'+this[_0x11ee('0x6')]);this['Consumer']=kafka[_0x11ee('0x1e')];this[_0x11ee('0x12')]=new kafka[(_0x11ee('0x1f'))](this['connectionConfig']['zookeeper'],this['id']);this['offset']=new kafka[(_0x11ee('0x20'))](this['client']);let _0x44d63c=this;this[_0x11ee('0x21')]=new this[(_0x11ee('0x1e'))](this['client'],[{'topic':this[_0x11ee('0x6')],'partition':0x0}],{'groupId':this['id']});this[_0x11ee('0x21')]['on'](_0x11ee('0x22'),function(_0x2e1b89){try{console[_0x11ee('0x19')](_0x11ee('0x23'));let _0x2cff48=JSON[_0x11ee('0x4')](_0x2e1b89[_0x11ee('0x24')]);_0x44d63c['processRecord'](_0x2cff48);}catch(_0x330e93){console[_0x11ee('0x19')](_0x11ee('0x25'),_0x330e93);}});this['consumer']['on'](_0x11ee('0x26'),function(_0x122bf7){console[_0x11ee('0x19')](_0x11ee('0x27'),_0x122bf7);});this[_0x11ee('0x21')]['on'](_0x11ee('0x28'),function(_0x43ac83){console[_0x11ee('0x19')](_0x44d63c['id'],_0x11ee('0x29'),_0x43ac83);_0x43ac83[_0x11ee('0x2a')]=0x2;_0x44d63c[_0x11ee('0x2b')][_0x11ee('0x2c')]([_0x43ac83],function(_0x1e2870,_0x17756c){if(_0x1e2870){return console[_0x11ee('0x26')](_0x1e2870);}var _0x22d870=Math[_0x11ee('0x2d')](_0x17756c[_0x43ac83[_0x11ee('0x6')]][_0x43ac83[_0x11ee('0x2e')]]);console[_0x11ee('0x19')](_0x44d63c);_0x44d63c[_0x11ee('0x21')][_0x11ee('0x2f')](_0x43ac83[_0x11ee('0x6')],_0x43ac83['partition'],_0x22d870);});});}[_0x11ee('0x30')](_0x10f2ed){}[_0x11ee('0x31')](){this['position']=this[_0x11ee('0x32')][_0x11ee('0x33')]-0x1;}['getOffsetTimestamp'](){return this[_0x11ee('0x32')][this[_0x11ee('0xc')]][_0x11ee('0x34')];}[_0x11ee('0x35')](_0x4f81d4){if(this[_0x11ee('0x32')][_0x11ee('0x33')]==0x0){console['log'](_0x11ee('0x36')+this['nodeId']);return![];}let _0x511a44=this[_0x11ee('0x32')][_0x11ee('0x33')]-0x1;let _0xfad03f=this[_0x11ee('0x32')][_0x511a44][_0x11ee('0x34')];let _0x1d7cb6=(_0xfad03f-_0x4f81d4)/this['fusionTick'];console[_0x11ee('0x19')](_0x11ee('0x37'),this['fusionTick'],_0x11ee('0x38'),_0x1d7cb6);let _0x3b8ffc=_0x511a44-_0x1d7cb6;if(_0x3b8ffc<0x0){console['log'](_0x11ee('0x39')+this[_0x11ee('0x18')]+'('+_0x3b8ffc+'/'+_0x511a44+')@'+this[_0x11ee('0xa')][_0x11ee('0x17')]);return![];}else if(_0x3b8ffc>_0x511a44){console[_0x11ee('0x19')](_0x11ee('0x3a')+this[_0x11ee('0x18')]+'('+_0x3b8ffc+'/'+_0x511a44+')@'+this[_0x11ee('0xa')]['fusion_id']);return![];}else if(_0x3b8ffc!=Math['floor'](_0x3b8ffc)){console[_0x11ee('0x19')]('setSlaveOffset:\x20zeroIndex\x20is\x20not\x20a\x20whole\x20number\x20-\x20'+_0x3b8ffc);}console['log'](_0x3b8ffc);if(this[_0x11ee('0x32')][_0x3b8ffc]['stampm']!=_0x4f81d4){console['log'](_0x11ee('0x3b'));console[_0x11ee('0x19')](_0x11ee('0x3c')+this['nodeId']);console[_0x11ee('0x19')](_0x11ee('0x3d')+_0x3b8ffc+',\x20'+_0x511a44);console[_0x11ee('0x19')](_0x11ee('0x3e')+this['buffer'][_0x3b8ffc][_0x11ee('0x34')]+_0x11ee('0x3f')+_0x4f81d4);console[_0x11ee('0x19')](_0x11ee('0x40'));}this[_0x11ee('0xc')]=_0x3b8ffc;return!![];}[_0x11ee('0x41')](){let _0x1b876c=!![];this[_0x11ee('0x42')]=0x0;for(let _0x429e71 in this['config'][_0x11ee('0x43')]){let _0x4687b5=this[_0x11ee('0x3')]['attributes'][_0x429e71][_0x11ee('0x44')];if(_0x4687b5<this[_0x11ee('0x42')])this[_0x11ee('0x42')]=_0x4687b5;if(!this['offsetExists'](_0x4687b5))_0x1b876c=![];}return _0x1b876c;}[_0x11ee('0x45')](_0x277167){let _0x274cce=this['position']+_0x277167;let _0x4f1321=this['buffer']['length']-0x1;if(_0x274cce<0x0){console[_0x11ee('0x19')](_0x11ee('0x46')+this[_0x11ee('0x18')]+'\x20-\x20('+_0x274cce+')');return![];}else if(_0x274cce>_0x4f1321){console[_0x11ee('0x19')](_0x11ee('0x47')+this['nodeId']+this['nodeId']+_0x11ee('0x48')+_0x274cce+'/'+_0x4f1321+')');return![];}return!![];}['deleteObsoleteRows'](){let _0x3a47f4=this[_0x11ee('0xc')]+this['maxNegativeOffset']-0x5;console[_0x11ee('0x19')]('Rows\x20to\x20delete\x20('+this[_0x11ee('0x18')]+',\x20'+this[_0x11ee('0xa')]['fusion_id']+_0x11ee('0x49')+_0x3a47f4+_0x11ee('0x4a')+this['buffer']['length']);for(let _0x54a992=0x1;_0x54a992<_0x3a47f4;_0x54a992++)this['buffer']['shift']();}[_0x11ee('0x4b')](_0x4dd711){for(let _0x11dca0 in _0x4dd711){let _0x2122df=_0x4dd711[_0x11dca0];let _0x13467c=_0x2122df[_0x11ee('0x4c')];let _0x1f30a9=_0x2122df[_0x11ee('0x4d')];let _0x4a558c=this[_0x11ee('0x4e')]['addStreamAggr']({'type':'timeSeriesTick','timestamp':_0x11ee('0x4f'),'value':_0x13467c});let _0x3a1607=_0x13467c+_0x11ee('0x50');this[_0x11ee('0x1')][_0x3a1607]=_0x4a558c;for(let _0x50ad54 in _0x1f30a9){let _0x2004ad=_0x1f30a9[_0x50ad54];let _0x1f4ac5=_0x2004ad[_0x11ee('0xe')];if(_0x1f4ac5=='ema'){let _0x51b4af=_0x2004ad[_0x11ee('0x51')];let _0x3df40e=_0x2004ad['initWindow'];let _0x4a558c=this[_0x11ee('0x4e')][_0x11ee('0x52')]({'type':_0x11ee('0x53'),'inAggr':this[_0x11ee('0x1')][_0x3a1607],'emaType':'previous','interval':_0x51b4af,'initWindow':_0x3df40e});let _0x33a503=_0x13467c+_0x11ee('0x54')+_0x51b4af;this[_0x11ee('0x1')][_0x33a503]=_0x4a558c;}else if(_0x1f4ac5=='winbuf'){let _0x292aab=_0x2004ad['winsize'];let _0x4a558c=this['rawstore']['addStreamAggr']({'type':_0x11ee('0x55'),'inAggr':this[_0x11ee('0x1')][_0x3a1607],'winsize':_0x292aab});let _0x1b9e1d=_0x13467c+_0x11ee('0x56')+_0x292aab;this[_0x11ee('0x1')][_0x1b9e1d]=_0x4a558c;let _0x3e2a3c=_0x2004ad[_0x11ee('0x57')];for(var _0x5403f6 in _0x3e2a3c){let _0x207cf9=_0x3e2a3c[_0x5403f6];let _0x11dc1e=_0x207cf9['type'];if(_0x11dc1e==_0x11ee('0x58')){let _0x4a558c=this[_0x11ee('0x4e')][_0x11ee('0x52')]({'type':'variance','inAggr':this[_0x11ee('0x1')][_0x1b9e1d]});let _0x13a9ce=_0x13467c+_0x11ee('0x59')+_0x292aab;this['aggregate'][_0x13a9ce]=_0x4a558c;}else if(_0x11dc1e=='ma'){let _0x4a558c=this[_0x11ee('0x4e')]['addStreamAggr']({'type':'ma','inAggr':this[_0x11ee('0x1')][_0x1b9e1d]});let _0x576078=_0x13467c+_0x11ee('0x5a')+_0x292aab;this[_0x11ee('0x1')][_0x576078]=_0x4a558c;}else if(_0x11dc1e==_0x11ee('0x2d')){let _0x4a558c=this[_0x11ee('0x4e')]['addStreamAggr']({'type':_0x11ee('0x5b'),'inAggr':this[_0x11ee('0x1')][_0x1b9e1d]});let _0x529218=_0x13467c+_0x11ee('0x5c')+_0x292aab;this['aggregate'][_0x529218]=_0x4a558c;}else if(_0x11dc1e==_0x11ee('0x5d')){let _0x4a558c=this[_0x11ee('0x4e')][_0x11ee('0x52')]({'type':_0x11ee('0x5e'),'inAggr':this['aggregate'][_0x1b9e1d]});let _0x41474a=_0x13467c+_0x11ee('0x5f')+_0x292aab;this[_0x11ee('0x1')][_0x41474a]=_0x4a558c;}}}}}}[_0x11ee('0x60')](){var _0x35d1ec={};for(let _0xd190bc in this[_0x11ee('0x1')]){if(!(_0xd190bc[_0x11ee('0x61')](_0x11ee('0x4d'))>0x0||_0xd190bc[_0x11ee('0x61')](_0x11ee('0x62'))>0x0)){_0x35d1ec[_0xd190bc]=this['aggregate'][_0xd190bc][_0x11ee('0x63')]();_0x35d1ec['stampm']=this[_0x11ee('0x1')][_0xd190bc][_0x11ee('0x64')]();};};return _0x35d1ec;}['getPartialFeatureVector'](){let _0x165587=[];for(let _0x46afe3 in this[_0x11ee('0x3')][_0x11ee('0x43')]){let _0x48cf6f=this['position'];let _0x26ad67=this[_0x11ee('0x32')][_0x48cf6f][_0x11ee('0x34')];let _0x34af94=this[_0x11ee('0x3')][_0x11ee('0x43')][_0x46afe3][_0x11ee('0x43')];let _0x8b97a8=this[_0x11ee('0x3')]['attributes'][_0x46afe3]['time'];_0x48cf6f=_0x48cf6f+_0x8b97a8;let _0x41c0f9=_0x26ad67+_0x8b97a8*this[_0x11ee('0xb')];let _0x12102a=this[_0x11ee('0x32')][_0x48cf6f][_0x11ee('0x34')];if(_0x41c0f9!=_0x12102a){while(_0x12102a-_0x41c0f9<0x0){_0x48cf6f++;_0x12102a=this['buffer'][_0x48cf6f][_0x11ee('0x34')];}if(_0x12102a!=_0x41c0f9)_0x48cf6f--;}for(let _0x146c63 in _0x34af94){let _0x573180=_0x34af94[_0x146c63][_0x11ee('0xe')];let _0x3c6d13=_0x34af94[_0x146c63][_0x11ee('0x65')];if(_0x573180==_0x11ee('0x24')){let _0x2652c4=this[_0x11ee('0x32')][_0x48cf6f][_0x3c6d13];_0x165587[_0x11ee('0x66')](_0x2652c4);}else if(_0x573180==_0x11ee('0x67')){let _0x4b143e=_0x48cf6f-_0x34af94[_0x146c63]['interval'];let _0x33149=this[_0x11ee('0x32')][_0x4b143e][_0x3c6d13]-this[_0x11ee('0x32')][_0x48cf6f][_0x3c6d13];_0x165587['push'](_0x33149);}}}return _0x165587;}}module[_0x11ee('0x68')]=streamingNode;