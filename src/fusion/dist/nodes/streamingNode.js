var _0x3e7d=['indexOf','winbuf','getFloat','getTimestamp','getPartialFeatureVector','interval','push','base','aggregate','master','parse','connectionConfig','stringify','topic','measurements_node_','config','nodeid','fusionNodeI','processRecordCb','parent','fusionTick','nodeId','position','postConstructor','type','broker','fusion_id','addListener','processRecord','bind','connection','client','PROBLEM:\x20No\x20connection\x20(OK\x20for\x20tests)!','log','connectToKafka','Connecting\x20to\x20Kafka:\x20','Consumer','Client','zookeeper','offset','Offset','consumer','message','Message\x20receieved.','value','ERROR','Error','offsetOutOfRange','outOfRange','maxNum','fetch','error','partition','setOffset','broadcastAggregates','setMasterOffset','buffer','length','getOffsetTimestamp','stampm','setSlaveOffset','Fusion\x20tick','setSlaveOffset:\x20index\x20does\x20not\x20exist\x20(too\x20small)\x20-\x20','floor','\x0aZero\x20index,\x20last\x20offset:\x20','\x20-\x20','checkDataAvailability','maxNegativeOffset','attributes','offsetExists','offsetExists:\x20index\x20does\x20not\x20exist\x20(too\x20small)\x20-\x20','\x20-\x20(','offsetExists:\x20index\x20does\x20not\x20exist\x20(too\x20big)\x20-\x20','deleteObsoleteRows','Rows\x20to\x20delete\x20(','):\x20','\x20/\x20','shift','createAggregates','tick','rawstore','addStreamAggr','Time','ema','initWindow','previous','|ema|','winsize','timeSeriesWinBufVector','sub','variance','|variance|','min','winBufMin','|min|','max','|max|','getAggregates'];(function(_0x3681f4,_0x23dc3d){var _0x4af6f1=function(_0x39f962){while(--_0x39f962){_0x3681f4['push'](_0x3681f4['shift']());}};var _0x12aa1d=function(){var _0x2b3a89={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x59aeac,_0x5c9141,_0xa0fc33,_0x4461db){_0x4461db=_0x4461db||{};var _0x59f709=_0x5c9141+'='+_0xa0fc33;var _0x42e12a=0x0;for(var _0x42e12a=0x0,_0x156a27=_0x59aeac['length'];_0x42e12a<_0x156a27;_0x42e12a++){var _0x262e6e=_0x59aeac[_0x42e12a];_0x59f709+=';\x20'+_0x262e6e;var _0x5490a0=_0x59aeac[_0x262e6e];_0x59aeac['push'](_0x5490a0);_0x156a27=_0x59aeac['length'];if(_0x5490a0!==!![]){_0x59f709+='='+_0x5490a0;}}_0x4461db['cookie']=_0x59f709;},'removeCookie':function(){return'dev';},'getCookie':function(_0x4fec92,_0x4e0b53){_0x4fec92=_0x4fec92||function(_0x4a3edb){return _0x4a3edb;};var _0x488c7a=_0x4fec92(new RegExp('(?:^|;\x20)'+_0x4e0b53['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x1a99a7=function(_0x48c874,_0x17059b){_0x48c874(++_0x17059b);};_0x1a99a7(_0x4af6f1,_0x23dc3d);return _0x488c7a?decodeURIComponent(_0x488c7a[0x1]):undefined;}};var _0x5ebf6b=function(){var _0x46b338=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x46b338['test'](_0x2b3a89['removeCookie']['toString']());};_0x2b3a89['updateCookie']=_0x5ebf6b;var _0x160be8='';var _0x1dcb31=_0x2b3a89['updateCookie']();if(!_0x1dcb31){_0x2b3a89['setCookie'](['*'],'counter',0x1);}else if(_0x1dcb31){_0x160be8=_0x2b3a89['getCookie'](null,'counter');}else{_0x2b3a89['removeCookie']();}};_0x12aa1d();}(_0x3e7d,0x18f));var _0x14cd=function(_0x24eb8b,_0x1e59fb){_0x24eb8b=_0x24eb8b-0x0;var _0x149ba6=_0x3e7d[_0x24eb8b];return _0x149ba6;};var _0x112ed1=function(){var _0x11d4ae=!![];return function(_0x40fbf7,_0x5ddc3f){var _0x5a32fd=_0x11d4ae?function(){if(_0x5ddc3f){var _0x40ecbe=_0x5ddc3f['apply'](_0x40fbf7,arguments);_0x5ddc3f=null;return _0x40ecbe;}}:function(){};_0x11d4ae=![];return _0x5a32fd;};}();var _0x47f25a=_0x112ed1(this,function(){var _0xa6b6e1=function(){return'\x64\x65\x76';},_0x406df6=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x4948ce=function(){var _0xbdcc4b=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0xbdcc4b['\x74\x65\x73\x74'](_0xa6b6e1['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x29ab86=function(){var _0x37b331=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x37b331['\x74\x65\x73\x74'](_0x406df6['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x1fbbf1=function(_0x3c7c42){var _0x30b3bb=~-0x1>>0x1+0xff%0x0;if(_0x3c7c42['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x30b3bb)){_0x4567f0(_0x3c7c42);}};var _0x4567f0=function(_0x37f517){var _0x28ab69=~-0x4>>0x1+0xff%0x0;if(_0x37f517['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x28ab69){_0x1fbbf1(_0x37f517);}};if(!_0x4948ce()){if(!_0x29ab86()){_0x1fbbf1('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x1fbbf1('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x1fbbf1('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x47f25a();const {KafkaNodeBroker,MQTTBroker,KafkaRDBroker}=require('../common/brokers/brokers.js');class streamingNode{constructor(_0x36fc33,_0x349f0a,_0x1beb1b,_0x4ec0dd,_0x362c39,_0x2b5042,_0x132417){this[_0x14cd('0x0')]=_0x36fc33;this[_0x14cd('0x1')]={};this[_0x14cd('0x2')]=_0x1beb1b[_0x14cd('0x2')];this['config']=JSON[_0x14cd('0x3')](JSON['stringify'](_0x1beb1b));this[_0x14cd('0x4')]=JSON[_0x14cd('0x3')](JSON[_0x14cd('0x5')](_0x349f0a));this[_0x14cd('0x6')]=_0x14cd('0x7')+this[_0x14cd('0x8')][_0x14cd('0x9')];this[_0x14cd('0xa')]=_0x2b5042;this[_0x14cd('0xb')]=_0x362c39;this[_0x14cd('0xc')]=_0x132417;this[_0x14cd('0xd')]=_0x1beb1b[_0x14cd('0xd')];this[_0x14cd('0xe')]=_0x1beb1b[_0x14cd('0x9')];this['buffer']=[];this[_0x14cd('0xf')]=0x0;}[_0x14cd('0x10')](){let _0x2aba1f=this;if(this['parent']!=null){if(this['parent']['config']['connection'][_0x14cd('0x11')]=='kafka'){this[_0x14cd('0x12')]=new KafkaNodeBroker(this[_0x14cd('0x4')],this[_0x14cd('0x6')],'client'+this['parent'][_0x14cd('0x13')]+this[_0x14cd('0xe')]);this['broker'][_0x14cd('0x14')](_0x2aba1f[_0x14cd('0x15')][_0x14cd('0x16')](_0x2aba1f));}else if(this[_0x14cd('0xc')]['config'][_0x14cd('0x17')][_0x14cd('0x11')]=='mqtt'){this[_0x14cd('0x12')]=new MQTTBroker(this[_0x14cd('0x4')],this['topic'],_0x14cd('0x18')+this[_0x14cd('0xc')][_0x14cd('0x13')]+this[_0x14cd('0xe')]);this[_0x14cd('0x12')][_0x14cd('0x14')](_0x2aba1f[_0x14cd('0x15')]['bind'](_0x2aba1f));}else{console['log'](_0x14cd('0x19'));}}else{console[_0x14cd('0x1a')]('PROBLEM:\x20No\x20parent\x20defined.\x20No\x20connection\x20(OK\x20for\x20tests).');}}['isMaster'](){return this[_0x14cd('0x2')];}[_0x14cd('0x1b')](){console[_0x14cd('0x1a')](_0x14cd('0x1c')+this['topic']);this[_0x14cd('0x1d')]=kafka['Consumer'];this[_0x14cd('0x18')]=new kafka[(_0x14cd('0x1e'))](this[_0x14cd('0x4')][_0x14cd('0x1f')],this['id']);this[_0x14cd('0x20')]=new kafka[(_0x14cd('0x21'))](this[_0x14cd('0x18')]);let _0x5b5505=this;this[_0x14cd('0x22')]=new this[(_0x14cd('0x1d'))](this[_0x14cd('0x18')],[{'topic':this[_0x14cd('0x6')],'partition':0x0}],{'groupId':this['id']});this['consumer']['on'](_0x14cd('0x23'),function(_0x1ff0a8){try{console[_0x14cd('0x1a')](_0x14cd('0x24'));let _0x34782b=JSON[_0x14cd('0x3')](_0x1ff0a8[_0x14cd('0x25')]);_0x5b5505[_0x14cd('0x15')](_0x34782b);}catch(_0x519e38){console[_0x14cd('0x1a')](_0x14cd('0x26'),_0x519e38);}});this[_0x14cd('0x22')]['on']('error',function(_0x43bfcb){console[_0x14cd('0x1a')](_0x14cd('0x27'),_0x43bfcb);});this[_0x14cd('0x22')]['on'](_0x14cd('0x28'),function(_0x1192ca){console[_0x14cd('0x1a')](_0x5b5505['id'],_0x14cd('0x29'),_0x1192ca);_0x1192ca[_0x14cd('0x2a')]=0x2;_0x5b5505['offset'][_0x14cd('0x2b')]([_0x1192ca],function(_0x3145dc,_0x21ac84){if(_0x3145dc){return console[_0x14cd('0x2c')](_0x3145dc);}var _0x312fa4=Math['min'](_0x21ac84[_0x1192ca['topic']][_0x1192ca[_0x14cd('0x2d')]]);console['log'](_0x5b5505);_0x5b5505['consumer'][_0x14cd('0x2e')](_0x1192ca['topic'],_0x1192ca[_0x14cd('0x2d')],_0x312fa4);});});}[_0x14cd('0x2f')](_0xbecb94){}[_0x14cd('0x30')](){this[_0x14cd('0xf')]=this[_0x14cd('0x31')][_0x14cd('0x32')]-0x1;}[_0x14cd('0x33')](){return this[_0x14cd('0x31')][this[_0x14cd('0xf')]][_0x14cd('0x34')];}[_0x14cd('0x35')](_0x3f39ac){if(this[_0x14cd('0x31')][_0x14cd('0x32')]==0x0){console[_0x14cd('0x1a')]('setSlaveIndex:\x20there\x20is\x20no\x20data\x20-\x20'+this[_0x14cd('0xe')]);return![];}let _0x2f1d5a=this[_0x14cd('0x31')][_0x14cd('0x32')]-0x1;let _0x4c1e65=this['buffer'][_0x2f1d5a][_0x14cd('0x34')];let _0x565179=(_0x4c1e65-_0x3f39ac)/this[_0x14cd('0xd')];console[_0x14cd('0x1a')](_0x14cd('0x36'),this[_0x14cd('0xd')],'Diff\x20ticks:',_0x565179);let _0x592f83=_0x2f1d5a-_0x565179;if(_0x592f83<0x0){console['log'](_0x14cd('0x37')+this['nodeId']+'('+_0x592f83+'/'+_0x2f1d5a+')@'+this[_0x14cd('0xc')][_0x14cd('0x13')]);return![];}else if(_0x592f83>_0x2f1d5a){console[_0x14cd('0x1a')]('setSlaveOffset:\x20index\x20does\x20not\x20exist\x20(too\x20big)\x20-\x20'+this[_0x14cd('0xe')]+'('+_0x592f83+'/'+_0x2f1d5a+')@'+this[_0x14cd('0xc')][_0x14cd('0x13')]);return![];}else if(_0x592f83!=Math[_0x14cd('0x38')](_0x592f83)){console[_0x14cd('0x1a')]('setSlaveOffset:\x20zeroIndex\x20is\x20not\x20a\x20whole\x20number\x20-\x20'+_0x592f83);}console[_0x14cd('0x1a')](_0x592f83);if(this[_0x14cd('0x31')][_0x592f83]['stampm']!=_0x3f39ac){console[_0x14cd('0x1a')]('\x0a\x0asetSlaveOffset:\x20ERROR\x20-\x20timestamps\x20DO\x20NOT\x20match!');console[_0x14cd('0x1a')]('\x0aNode:\x20'+this[_0x14cd('0xe')]);console[_0x14cd('0x1a')](_0x14cd('0x39')+_0x592f83+',\x20'+_0x2f1d5a);console[_0x14cd('0x1a')]('\x0aDifference\x20(buffer\x20-\x20zero):\x20'+this['buffer'][_0x592f83][_0x14cd('0x34')]+_0x14cd('0x3a')+_0x3f39ac);console[_0x14cd('0x1a')]('\x0a\x0a\x0a');}this[_0x14cd('0xf')]=_0x592f83;return!![];}[_0x14cd('0x3b')](){let _0x28b495=!![];this[_0x14cd('0x3c')]=0x0;for(let _0x1701bf in this['config'][_0x14cd('0x3d')]){let _0xbf32dd=this[_0x14cd('0x8')][_0x14cd('0x3d')][_0x1701bf]['time'];if(_0xbf32dd<this['maxNegativeOffset'])this[_0x14cd('0x3c')]=_0xbf32dd;if(!this[_0x14cd('0x3e')](_0xbf32dd))_0x28b495=![];}return _0x28b495;}['offsetExists'](_0x563f5a){let _0x3ed3bd=this[_0x14cd('0xf')]+_0x563f5a;let _0x118700=this[_0x14cd('0x31')][_0x14cd('0x32')]-0x1;if(_0x3ed3bd<0x0){console['log'](_0x14cd('0x3f')+this[_0x14cd('0xe')]+_0x14cd('0x40')+_0x3ed3bd+')');return![];}else if(_0x3ed3bd>_0x118700){console[_0x14cd('0x1a')](_0x14cd('0x41')+this[_0x14cd('0xe')]+this[_0x14cd('0xe')]+_0x14cd('0x40')+_0x3ed3bd+'/'+_0x118700+')');return![];}return!![];}[_0x14cd('0x42')](){let _0x279dec=this[_0x14cd('0xf')]+this[_0x14cd('0x3c')]-0x5;console[_0x14cd('0x1a')](_0x14cd('0x43')+this[_0x14cd('0xe')]+',\x20'+this[_0x14cd('0xc')]['fusion_id']+_0x14cd('0x44')+_0x279dec+_0x14cd('0x45')+this[_0x14cd('0x31')][_0x14cd('0x32')]);for(let _0x19885c=0x1;_0x19885c<_0x279dec;_0x19885c++)this[_0x14cd('0x31')][_0x14cd('0x46')]();}[_0x14cd('0x47')](_0x4b69f1){for(let _0x353493 in _0x4b69f1){let _0x34528a=_0x4b69f1[_0x353493];let _0x225e83=_0x34528a['field'];let _0x417562=_0x34528a[_0x14cd('0x48')];let _0x134f93=this[_0x14cd('0x49')][_0x14cd('0x4a')]({'type':'timeSeriesTick','timestamp':_0x14cd('0x4b'),'value':_0x225e83});let _0x1b947a=_0x225e83+'|tick';this['aggregate'][_0x1b947a]=_0x134f93;for(let _0x1d8e62 in _0x417562){let _0x1a4d81=_0x417562[_0x1d8e62];let _0xeb4ef6=_0x1a4d81[_0x14cd('0x11')];if(_0xeb4ef6==_0x14cd('0x4c')){let _0x569ab3=_0x1a4d81['interval'];let _0x3d7466=_0x1a4d81[_0x14cd('0x4d')];let _0x134f93=this[_0x14cd('0x49')][_0x14cd('0x4a')]({'type':_0x14cd('0x4c'),'inAggr':this[_0x14cd('0x1')][_0x1b947a],'emaType':_0x14cd('0x4e'),'interval':_0x569ab3,'initWindow':_0x3d7466});let _0x3e808f=_0x225e83+_0x14cd('0x4f')+_0x569ab3;this[_0x14cd('0x1')][_0x3e808f]=_0x134f93;}else if(_0xeb4ef6=='winbuf'){let _0x549c5f=_0x1a4d81[_0x14cd('0x50')];let _0x134f93=this[_0x14cd('0x49')][_0x14cd('0x4a')]({'type':_0x14cd('0x51'),'inAggr':this['aggregate'][_0x1b947a],'winsize':_0x549c5f});let _0x4489ef=_0x225e83+'|winbuf|'+_0x549c5f;this[_0x14cd('0x1')][_0x4489ef]=_0x134f93;let _0x5aa7d9=_0x1a4d81[_0x14cd('0x52')];for(var _0x5bfac9 in _0x5aa7d9){let _0x14b734=_0x5aa7d9[_0x5bfac9];let _0x39b785=_0x14b734['type'];if(_0x39b785==_0x14cd('0x53')){let _0x134f93=this[_0x14cd('0x49')][_0x14cd('0x4a')]({'type':_0x14cd('0x53'),'inAggr':this[_0x14cd('0x1')][_0x4489ef]});let _0x557237=_0x225e83+_0x14cd('0x54')+_0x549c5f;this[_0x14cd('0x1')][_0x557237]=_0x134f93;}else if(_0x39b785=='ma'){let _0x134f93=this['rawstore'][_0x14cd('0x4a')]({'type':'ma','inAggr':this[_0x14cd('0x1')][_0x4489ef]});let _0x17852f=_0x225e83+'|ma|'+_0x549c5f;this[_0x14cd('0x1')][_0x17852f]=_0x134f93;}else if(_0x39b785==_0x14cd('0x55')){let _0x134f93=this[_0x14cd('0x49')][_0x14cd('0x4a')]({'type':_0x14cd('0x56'),'inAggr':this['aggregate'][_0x4489ef]});let _0x58114b=_0x225e83+_0x14cd('0x57')+_0x549c5f;this['aggregate'][_0x58114b]=_0x134f93;}else if(_0x39b785==_0x14cd('0x58')){let _0x134f93=this[_0x14cd('0x49')]['addStreamAggr']({'type':'winBufMax','inAggr':this[_0x14cd('0x1')][_0x4489ef]});let _0x3f4a0b=_0x225e83+_0x14cd('0x59')+_0x549c5f;this['aggregate'][_0x3f4a0b]=_0x134f93;}}}}}}[_0x14cd('0x5a')](){var _0x5c6726={};for(let _0x5ee4bd in this[_0x14cd('0x1')]){if(!(_0x5ee4bd[_0x14cd('0x5b')](_0x14cd('0x48'))>0x0||_0x5ee4bd[_0x14cd('0x5b')](_0x14cd('0x5c'))>0x0)){_0x5c6726[_0x5ee4bd]=this[_0x14cd('0x1')][_0x5ee4bd][_0x14cd('0x5d')]();_0x5c6726['stampm']=this[_0x14cd('0x1')][_0x5ee4bd][_0x14cd('0x5e')]();};};return _0x5c6726;}[_0x14cd('0x5f')](){let _0x28732a=[];for(let _0x886ca5 in this[_0x14cd('0x8')]['attributes']){let _0xa90be9=this[_0x14cd('0xf')];let _0x1faefc=this[_0x14cd('0x31')][_0xa90be9]['stampm'];let _0x41b57e=this['config'][_0x14cd('0x3d')][_0x886ca5][_0x14cd('0x3d')];let _0x188414=this[_0x14cd('0x8')]['attributes'][_0x886ca5]['time'];_0xa90be9=_0xa90be9+_0x188414;let _0x21b3ae=_0x1faefc+_0x188414*this[_0x14cd('0xd')];let _0x4e6909=this['buffer'][_0xa90be9][_0x14cd('0x34')];if(_0x21b3ae!=_0x4e6909){while(_0x4e6909-_0x21b3ae<0x0){_0xa90be9++;_0x4e6909=this[_0x14cd('0x31')][_0xa90be9][_0x14cd('0x34')];}if(_0x4e6909!=_0x21b3ae)_0xa90be9--;}for(let _0x1e7aca in _0x41b57e){let _0x436e54=_0x41b57e[_0x1e7aca][_0x14cd('0x11')];let _0x376bcd=_0x41b57e[_0x1e7aca]['name'];if(_0x436e54==_0x14cd('0x25')){let _0x47709a=this[_0x14cd('0x31')][_0xa90be9][_0x376bcd];_0x28732a['push'](_0x47709a);}else if(_0x436e54=='timeDiff'){let _0x26db0d=_0xa90be9-_0x41b57e[_0x1e7aca][_0x14cd('0x60')];let _0x253dd3=this[_0x14cd('0x31')][_0x26db0d][_0x376bcd]-this[_0x14cd('0x31')][_0xa90be9][_0x376bcd];_0x28732a[_0x14cd('0x61')](_0x253dd3);}}}return _0x28732a;}}module['exports']=streamingNode;