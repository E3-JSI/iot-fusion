const a0_0x560d=['maxNegativeOffset','setSlaveOffset:\x20index\x20does\x20not\x20exist\x20(too\x20big)\x20-\x20','test','\x20-\x20','constructor','isMaster','parse','return\x20/\x22\x20+\x20this\x20+\x20\x22/','\x20/\x20','position','Message\x20receieved.','sub','Consumer','processRecordCb','setSlaveIndex:\x20there\x20is\x20no\x20data\x20-\x20','processRecord','|ema|','createAggregates','nodeid','variance','winBufMin','setOffset','Fusion\x20tick','push','timeDiff','getAggregates','setMasterOffset','winsize','winbuf','getPartialFeatureVector','kafka','ERROR','initWindow','attributes','stampm','length','interval','PROBLEM:\x20No\x20connection\x20(OK\x20for\x20tests)!','topic','fusion_id','timeSeriesWinBufVector','outOfRange','exports','type','max','name','connection','shift','offsetExists:\x20index\x20does\x20not\x20exist\x20(too\x20small)\x20-\x20','log','Time','offsetOutOfRange','apply','setSlaveOffset:\x20zeroIndex\x20is\x20not\x20a\x20whole\x20number\x20-\x20','master','connectionConfig','offsetExists:\x20index\x20does\x20not\x20exist\x20(too\x20big)\x20-\x20','zookeeper','mqtt','indexOf','offsetExists','PROBLEM:\x20No\x20parent\x20defined.\x20No\x20connection\x20(OK\x20for\x20tests).','maxNum','Rows\x20to\x20delete\x20(','ema','consumer','min','error','bind','\x0a\x0asetSlaveOffset:\x20ERROR\x20-\x20timestamps\x20DO\x20NOT\x20match!','\x20-\x20(','aggregate','fusionNodeI','value','getFloat','winBufMax','setSlaveOffset:\x20index\x20does\x20not\x20exist\x20(too\x20small)\x20-\x20','offset','timeSeriesTick','addStreamAggr','|tick','|max|','fusionTick','partition','nodeId','deleteObsoleteRows','client','addListener','time','Connecting\x20to\x20Kafka:\x20','parent','field','broker','stringify','floor','rawstore','getTimestamp','\x0a\x0a\x0a','|min|','broadcastAggregates','config','|variance|','buffer','checkDataAvailability','tick'];(function(_0x181635,_0x560d1b){const _0x19ef6c=function(_0x189ed4){while(--_0x189ed4){_0x181635['push'](_0x181635['shift']());}},_0xf79d74=function(){const _0x4792f8={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x5b2fb,_0x15ec90,_0x1a8862,_0x5cc948){_0x5cc948=_0x5cc948||{};let _0x2f8e37=_0x15ec90+'='+_0x1a8862,_0x3428fb=0x0;for(let _0x346a16=0x0,_0x1c4495=_0x5b2fb['length'];_0x346a16<_0x1c4495;_0x346a16++){const _0x58aa13=_0x5b2fb[_0x346a16];_0x2f8e37+=';\x20'+_0x58aa13;const _0x21499f=_0x5b2fb[_0x58aa13];_0x5b2fb['push'](_0x21499f),_0x1c4495=_0x5b2fb['length'],_0x21499f!==!![]&&(_0x2f8e37+='='+_0x21499f);}_0x5cc948['cookie']=_0x2f8e37;},'removeCookie':function(){return'dev';},'getCookie':function(_0x50a5d9,_0x4b68ab){_0x50a5d9=_0x50a5d9||function(_0x373aa1){return _0x373aa1;};const _0x4fd645=_0x50a5d9(new RegExp('(?:^|;\x20)'+_0x4b68ab['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x192479=function(_0x972e0e,_0x27facb){_0x972e0e(++_0x27facb);};return _0x192479(_0x19ef6c,_0x560d1b),_0x4fd645?decodeURIComponent(_0x4fd645[0x1]):undefined;}},_0x11e6f4=function(){const _0x218ba9=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x218ba9['test'](_0x4792f8['removeCookie']['toString']());};_0x4792f8['updateCookie']=_0x11e6f4;let _0x3b19fb='';const _0x36e235=_0x4792f8['updateCookie']();if(!_0x36e235)_0x4792f8['setCookie'](['*'],'counter',0x1);else _0x36e235?_0x3b19fb=_0x4792f8['getCookie'](null,'counter'):_0x4792f8['removeCookie']();};_0xf79d74();}(a0_0x560d,0xc9));const a0_0x19ef=function(_0x181635,_0x560d1b){_0x181635=_0x181635-0x0;let _0x19ef6c=a0_0x560d[_0x181635];return _0x19ef6c;};const a0_0x1a8862=function(){let _0x4d63ba=!![];return function(_0x97207f,_0x578bb5){const _0x5290b6=_0x4d63ba?function(){if(_0x578bb5){const _0xcbd768=_0x578bb5[a0_0x19ef('0x3d')](_0x97207f,arguments);return _0x578bb5=null,_0xcbd768;}}:function(){};return _0x4d63ba=![],_0x5290b6;};}(),a0_0x15ec90=a0_0x1a8862(this,function(){const _0x5abf7f=function(){const _0x3f60a5=_0x5abf7f[a0_0x19ef('0xd')](a0_0x19ef('0x10'))()[a0_0x19ef('0xd')]('^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}');return!_0x3f60a5[a0_0x19ef('0xb')](a0_0x15ec90);};return _0x5abf7f();});a0_0x15ec90();const {KafkaNodeBroker,MQTTBroker,KafkaRDBroker}=require('../common/brokers/brokers.js');class streamingNode{constructor(_0x28bdb8,_0x33e33e,_0x28cebf,_0x397ab0,_0x164367,_0x3f1aac,_0x2277f7){this['base']=_0x28bdb8,this['aggregate']={},this[a0_0x19ef('0x3f')]=_0x28cebf[a0_0x19ef('0x3f')],this[a0_0x19ef('0x4')]=JSON[a0_0x19ef('0xf')](JSON[a0_0x19ef('0x66')](_0x28cebf)),this[a0_0x19ef('0x40')]=JSON[a0_0x19ef('0xf')](JSON['stringify'](_0x33e33e)),this[a0_0x19ef('0x2f')]='measurements_node_'+this[a0_0x19ef('0x4')][a0_0x19ef('0x1b')],this[a0_0x19ef('0x51')]=_0x3f1aac,this[a0_0x19ef('0x16')]=_0x164367,this[a0_0x19ef('0x63')]=_0x2277f7,this['fusionTick']=_0x28cebf[a0_0x19ef('0x5b')],this[a0_0x19ef('0x5d')]=_0x28cebf['nodeid'],this['buffer']=[],this['position']=0x0;}['postConstructor'](){let _0x5ce302=this;if(this[a0_0x19ef('0x63')]!=null){if(this[a0_0x19ef('0x63')][a0_0x19ef('0x4')][a0_0x19ef('0x37')]['type']==a0_0x19ef('0x27'))this[a0_0x19ef('0x65')]=new KafkaNodeBroker(this[a0_0x19ef('0x40')],this['topic'],a0_0x19ef('0x5f')+this[a0_0x19ef('0x63')]['fusion_id']+this[a0_0x19ef('0x5d')]),this[a0_0x19ef('0x65')][a0_0x19ef('0x60')](_0x5ce302[a0_0x19ef('0x18')][a0_0x19ef('0x4d')](_0x5ce302));else this[a0_0x19ef('0x63')][a0_0x19ef('0x4')][a0_0x19ef('0x37')]['type']==a0_0x19ef('0x43')?(this['broker']=new MQTTBroker(this[a0_0x19ef('0x40')],this[a0_0x19ef('0x2f')],a0_0x19ef('0x5f')+this[a0_0x19ef('0x63')][a0_0x19ef('0x30')]+this[a0_0x19ef('0x5d')]),this[a0_0x19ef('0x65')][a0_0x19ef('0x60')](_0x5ce302['processRecord'][a0_0x19ef('0x4d')](_0x5ce302))):console['log'](a0_0x19ef('0x2e'));}else console[a0_0x19ef('0x3a')](a0_0x19ef('0x46'));}[a0_0x19ef('0xe')](){return this[a0_0x19ef('0x3f')];}['connectToKafka'](){console[a0_0x19ef('0x3a')](a0_0x19ef('0x62')+this['topic']),this[a0_0x19ef('0x15')]=kafka[a0_0x19ef('0x15')],this[a0_0x19ef('0x5f')]=new kafka['Client'](this[a0_0x19ef('0x40')][a0_0x19ef('0x42')],this['id']),this[a0_0x19ef('0x56')]=new kafka['Offset'](this[a0_0x19ef('0x5f')]);let _0x2ae074=this;this[a0_0x19ef('0x4a')]=new this[(a0_0x19ef('0x15'))](this[a0_0x19ef('0x5f')],[{'topic':this[a0_0x19ef('0x2f')],'partition':0x0}],{'groupId':this['id']}),this['consumer']['on']('message',function(_0x2ba46e){try{console[a0_0x19ef('0x3a')](a0_0x19ef('0x13'));let _0x17c42a=JSON[a0_0x19ef('0xf')](_0x2ba46e['value']);_0x2ae074['processRecord'](_0x17c42a);}catch(_0x1e2f9c){console[a0_0x19ef('0x3a')](a0_0x19ef('0x28'),_0x1e2f9c);}}),this[a0_0x19ef('0x4a')]['on'](a0_0x19ef('0x4c'),function(_0xf984c5){console['log']('Error',_0xf984c5);}),this[a0_0x19ef('0x4a')]['on'](a0_0x19ef('0x3c'),function(_0x337751){console[a0_0x19ef('0x3a')](_0x2ae074['id'],a0_0x19ef('0x32'),_0x337751),_0x337751[a0_0x19ef('0x47')]=0x2,_0x2ae074[a0_0x19ef('0x56')]['fetch']([_0x337751],function(_0x17c4a8,_0x1fe0c6){if(_0x17c4a8)return console[a0_0x19ef('0x4c')](_0x17c4a8);var _0x2c62c4=Math[a0_0x19ef('0x4b')](_0x1fe0c6[_0x337751['topic']][_0x337751[a0_0x19ef('0x5c')]]);console[a0_0x19ef('0x3a')](_0x2ae074),_0x2ae074[a0_0x19ef('0x4a')][a0_0x19ef('0x1e')](_0x337751[a0_0x19ef('0x2f')],_0x337751[a0_0x19ef('0x5c')],_0x2c62c4);});});}[a0_0x19ef('0x3')](_0x3df800){}[a0_0x19ef('0x23')](){this[a0_0x19ef('0x12')]=this[a0_0x19ef('0x6')][a0_0x19ef('0x2c')]-0x1;}['getOffsetTimestamp'](){return this['buffer'][this[a0_0x19ef('0x12')]][a0_0x19ef('0x2b')];}['setSlaveOffset'](_0x299134){if(this[a0_0x19ef('0x6')][a0_0x19ef('0x2c')]==0x0)return console['log'](a0_0x19ef('0x17')+this[a0_0x19ef('0x5d')]),![];let _0x13d6e9=this[a0_0x19ef('0x6')][a0_0x19ef('0x2c')]-0x1,_0x3a2e95=this[a0_0x19ef('0x6')][_0x13d6e9][a0_0x19ef('0x2b')],_0x357745=(_0x3a2e95-_0x299134)/this[a0_0x19ef('0x5b')];console[a0_0x19ef('0x3a')](a0_0x19ef('0x1f'),this['fusionTick'],'Diff\x20ticks:',_0x357745);let _0x170160=_0x13d6e9-_0x357745;if(_0x170160<0x0)return console[a0_0x19ef('0x3a')](a0_0x19ef('0x55')+this[a0_0x19ef('0x5d')]+'('+_0x170160+'/'+_0x13d6e9+')@'+this['parent'][a0_0x19ef('0x30')]),![];else{if(_0x170160>_0x13d6e9)return console[a0_0x19ef('0x3a')](a0_0x19ef('0xa')+this[a0_0x19ef('0x5d')]+'('+_0x170160+'/'+_0x13d6e9+')@'+this[a0_0x19ef('0x63')][a0_0x19ef('0x30')]),![];else _0x170160!=Math[a0_0x19ef('0x67')](_0x170160)&&console['log'](a0_0x19ef('0x3e')+_0x170160);}return console[a0_0x19ef('0x3a')](_0x170160),this['buffer'][_0x170160][a0_0x19ef('0x2b')]!=_0x299134&&(console['log'](a0_0x19ef('0x4e')),console[a0_0x19ef('0x3a')]('\x0aNode:\x20'+this[a0_0x19ef('0x5d')]),console['log']('\x0aZero\x20index,\x20last\x20offset:\x20'+_0x170160+',\x20'+_0x13d6e9),console['log']('\x0aDifference\x20(buffer\x20-\x20zero):\x20'+this['buffer'][_0x170160][a0_0x19ef('0x2b')]+a0_0x19ef('0xc')+_0x299134),console[a0_0x19ef('0x3a')](a0_0x19ef('0x1'))),this[a0_0x19ef('0x12')]=_0x170160,!![];}[a0_0x19ef('0x7')](){let _0x39d536=!![];this['maxNegativeOffset']=0x0;for(let _0x348aa0 in this[a0_0x19ef('0x4')][a0_0x19ef('0x2a')]){let _0x39cbb5=this[a0_0x19ef('0x4')][a0_0x19ef('0x2a')][_0x348aa0][a0_0x19ef('0x61')];if(_0x39cbb5<this[a0_0x19ef('0x9')])this[a0_0x19ef('0x9')]=_0x39cbb5;if(!this['offsetExists'](_0x39cbb5))_0x39d536=![];}return _0x39d536;}[a0_0x19ef('0x45')](_0x14d94f){let _0xaa4032=this[a0_0x19ef('0x12')]+_0x14d94f,_0x20e36b=this['buffer'][a0_0x19ef('0x2c')]-0x1;if(_0xaa4032<0x0)return console[a0_0x19ef('0x3a')](a0_0x19ef('0x39')+this['nodeId']+a0_0x19ef('0x4f')+_0xaa4032+')'),![];else{if(_0xaa4032>_0x20e36b)return console[a0_0x19ef('0x3a')](a0_0x19ef('0x41')+this[a0_0x19ef('0x5d')]+this[a0_0x19ef('0x5d')]+'\x20-\x20('+_0xaa4032+'/'+_0x20e36b+')'),![];}return!![];}[a0_0x19ef('0x5e')](){let _0x96aea8=this['position']+this[a0_0x19ef('0x9')]-0x5;console['log'](a0_0x19ef('0x48')+this['nodeId']+',\x20'+this['parent']['fusion_id']+'):\x20'+_0x96aea8+a0_0x19ef('0x11')+this['buffer'][a0_0x19ef('0x2c')]);for(let _0x2e19b7=0x1;_0x2e19b7<_0x96aea8;_0x2e19b7++)this[a0_0x19ef('0x6')][a0_0x19ef('0x38')]();}[a0_0x19ef('0x1a')](_0xd4ece7){for(let _0x39fce2 in _0xd4ece7){let _0x219650=_0xd4ece7[_0x39fce2],_0x7d2102=_0x219650[a0_0x19ef('0x64')],_0xbdb4a=_0x219650[a0_0x19ef('0x8')],_0x55ef08=this[a0_0x19ef('0x68')][a0_0x19ef('0x58')]({'type':a0_0x19ef('0x57'),'timestamp':a0_0x19ef('0x3b'),'value':_0x7d2102}),_0x81cc82=_0x7d2102+a0_0x19ef('0x59');this[a0_0x19ef('0x50')][_0x81cc82]=_0x55ef08;for(let _0x2cdc8d in _0xbdb4a){let _0x4e5d24=_0xbdb4a[_0x2cdc8d],_0x150cd2=_0x4e5d24[a0_0x19ef('0x34')];if(_0x150cd2==a0_0x19ef('0x49')){let _0x46ac45=_0x4e5d24[a0_0x19ef('0x2d')],_0xce6088=_0x4e5d24[a0_0x19ef('0x29')],_0x1862e3=this['rawstore']['addStreamAggr']({'type':a0_0x19ef('0x49'),'inAggr':this[a0_0x19ef('0x50')][_0x81cc82],'emaType':'previous','interval':_0x46ac45,'initWindow':_0xce6088}),_0x11235f=_0x7d2102+a0_0x19ef('0x19')+_0x46ac45;this[a0_0x19ef('0x50')][_0x11235f]=_0x1862e3;}else{if(_0x150cd2==a0_0x19ef('0x25')){let _0x45aa4e=_0x4e5d24[a0_0x19ef('0x24')],_0x284d8d=this[a0_0x19ef('0x68')][a0_0x19ef('0x58')]({'type':a0_0x19ef('0x31'),'inAggr':this[a0_0x19ef('0x50')][_0x81cc82],'winsize':_0x45aa4e}),_0x12c093=_0x7d2102+'|winbuf|'+_0x45aa4e;this[a0_0x19ef('0x50')][_0x12c093]=_0x284d8d;let _0xa74e54=_0x4e5d24[a0_0x19ef('0x14')];for(var _0x41cacb in _0xa74e54){let _0x32f386=_0xa74e54[_0x41cacb],_0x1ad62b=_0x32f386[a0_0x19ef('0x34')];if(_0x1ad62b==a0_0x19ef('0x1c')){let _0x5f55ba=this[a0_0x19ef('0x68')][a0_0x19ef('0x58')]({'type':'variance','inAggr':this['aggregate'][_0x12c093]}),_0xef78b6=_0x7d2102+a0_0x19ef('0x5')+_0x45aa4e;this[a0_0x19ef('0x50')][_0xef78b6]=_0x5f55ba;}else{if(_0x1ad62b=='ma'){let _0x5538d5=this[a0_0x19ef('0x68')][a0_0x19ef('0x58')]({'type':'ma','inAggr':this[a0_0x19ef('0x50')][_0x12c093]}),_0x378d28=_0x7d2102+'|ma|'+_0x45aa4e;this[a0_0x19ef('0x50')][_0x378d28]=_0x5538d5;}else{if(_0x1ad62b==a0_0x19ef('0x4b')){let _0x4a9130=this['rawstore'][a0_0x19ef('0x58')]({'type':a0_0x19ef('0x1d'),'inAggr':this[a0_0x19ef('0x50')][_0x12c093]}),_0x1b4a6b=_0x7d2102+a0_0x19ef('0x2')+_0x45aa4e;this[a0_0x19ef('0x50')][_0x1b4a6b]=_0x4a9130;}else{if(_0x1ad62b==a0_0x19ef('0x35')){let _0x4e4a49=this[a0_0x19ef('0x68')]['addStreamAggr']({'type':a0_0x19ef('0x54'),'inAggr':this[a0_0x19ef('0x50')][_0x12c093]}),_0x2bef30=_0x7d2102+a0_0x19ef('0x5a')+_0x45aa4e;this['aggregate'][_0x2bef30]=_0x4e4a49;}}}}}}}}}}[a0_0x19ef('0x22')](){var _0x3ff724={};for(let _0x384815 in this[a0_0x19ef('0x50')]){!(_0x384815[a0_0x19ef('0x44')](a0_0x19ef('0x8'))>0x0||_0x384815[a0_0x19ef('0x44')]('winbuf')>0x0)&&(_0x3ff724[_0x384815]=this[a0_0x19ef('0x50')][_0x384815][a0_0x19ef('0x53')](),_0x3ff724['stampm']=this[a0_0x19ef('0x50')][_0x384815][a0_0x19ef('0x0')]());;};return _0x3ff724;}[a0_0x19ef('0x26')](){let _0x5bab5c=[];for(let _0x328e47 in this[a0_0x19ef('0x4')][a0_0x19ef('0x2a')]){let _0x4198ec=this[a0_0x19ef('0x12')],_0x401ecc=this[a0_0x19ef('0x6')][_0x4198ec]['stampm'],_0x36d1e1=this[a0_0x19ef('0x4')]['attributes'][_0x328e47][a0_0x19ef('0x2a')],_0x2da8ef=this[a0_0x19ef('0x4')][a0_0x19ef('0x2a')][_0x328e47]['time'];_0x4198ec=_0x4198ec+_0x2da8ef;let _0x143dae=_0x401ecc+_0x2da8ef*this[a0_0x19ef('0x5b')],_0x19efe6=this[a0_0x19ef('0x6')][_0x4198ec]['stampm'];if(_0x143dae!=_0x19efe6){while(_0x19efe6-_0x143dae<0x0){_0x4198ec++,_0x19efe6=this['buffer'][_0x4198ec][a0_0x19ef('0x2b')];}if(_0x19efe6!=_0x143dae)_0x4198ec--;}for(let _0x3c8fe5 in _0x36d1e1){let _0x5732fa=_0x36d1e1[_0x3c8fe5]['type'],_0x418990=_0x36d1e1[_0x3c8fe5][a0_0x19ef('0x36')];if(_0x5732fa==a0_0x19ef('0x52')){let _0xfcaaec=this[a0_0x19ef('0x6')][_0x4198ec][_0x418990];_0x5bab5c['push'](_0xfcaaec);}else{if(_0x5732fa==a0_0x19ef('0x21')){let _0x45bd2e=_0x4198ec-_0x36d1e1[_0x3c8fe5][a0_0x19ef('0x2d')],_0x576346=this[a0_0x19ef('0x6')][_0x45bd2e][_0x418990]-this[a0_0x19ef('0x6')][_0x4198ec][_0x418990];_0x5bab5c[a0_0x19ef('0x20')](_0x576346);}}}}return _0x5bab5c;}}module[a0_0x19ef('0x33')]=streamingNode;