var _0x1c03=['aggregate','length','aggregates\x20initialized\x20-\x20key\x20names','carno|tick','carno|winbuf|21600000','carno|ma|21600000','carno|min|21600000','carno|variance|21600000','carno|winbuf|86400000','carno|winbuf|604800000','carno|ma|604800000','v|winbuf|21600000','v|ma|21600000','v|max|21600000','v|winbuf|86400000','v|ma|86400000','v|min|86400000','v|max|86400000','v|ma|604800000','config\x20saved','nodes','fusionNodeI\x20correctly\x20saved','fusionNodeI','processRecordCb','parent\x20saved','parent','buffer\x20empty','buffer','buffer\x20position\x20is\x200','position','master\x20flag\x20set\x20correctly','master','isMaster\x20function','isMaster','connectToKafka\x20function\x20exists','connectToKafka','function','createAggregates','offsetExists\x20function\x20exists','offsetExists','deleteObsoleteRows\x20function\x20exists','checkDataAvailability\x20function\x20exists','checkDataAvailability','setSlaveOffset','getOffsetTimestamp','getAggregates\x20function\x20exists','getAggregates','getPartialFeatureVector\x20function\x20exists','getPartialFeatureVector','master\x20offset\x20set\x20correctly','setMasterOffset','data\x20record\x20saved\x20correctly','processRecord','parse','{\x22stampm\x22:\x201468493071000,\x20\x22carno\x22:\x200.0,\x20\x22v\x22:\x201\x20}','{\x22stampm\x22:\x201468493072000,\x20\x22carno\x22:\x201.0,\x20\x22v\x22:\x202\x20}','stream\x20aggregates\x20calculated\x20correctly\x20for\x20#2\x20insertion','{\x22stampm\x22:',',\x22v\x22:\x20','duplicate\x20insertions\x20test','../nodes/streamingNode.js','../nodes/streamingEnergyNode.js','../nodes/streamingStaticNode.js','../nodes/streamingTimeValueNode.js','../nodes/streamingSmartLampNode.js','../nodes/streamingTrafficCounterNode.js','../common/utils/fileManager.js','qminer','assert','192.168.85.98:2181','winbuf','min','max','variance','trafficcounter','value','carno','v|ma|21600','carno|min|86400000','carno|max|86400000','carno|variance|86400000','carno|ma|86400000','removeFolder','./db4/','createFolder','Base','createClean','close','initialization','equal','base','check\x20if\x20store\x20exists','name','deepEqual','rawstore','fields','datetime','float','keys'];(function(_0x2936b2,_0x5c9d59){var _0xb6cd67=function(_0x6a735b){while(--_0x6a735b){_0x2936b2['push'](_0x2936b2['shift']());}};var _0x3550ca=function(){var _0x22b4f6={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x150718,_0x22b256,_0xe3ff9a,_0x522535){_0x522535=_0x522535||{};var _0x388bc4=_0x22b256+'='+_0xe3ff9a;var _0x7c8441=0x0;for(var _0x7c8441=0x0,_0x41eb8b=_0x150718['length'];_0x7c8441<_0x41eb8b;_0x7c8441++){var _0x5211e9=_0x150718[_0x7c8441];_0x388bc4+=';\x20'+_0x5211e9;var _0x3f4c76=_0x150718[_0x5211e9];_0x150718['push'](_0x3f4c76);_0x41eb8b=_0x150718['length'];if(_0x3f4c76!==!![]){_0x388bc4+='='+_0x3f4c76;}}_0x522535['cookie']=_0x388bc4;},'removeCookie':function(){return'dev';},'getCookie':function(_0x408545,_0x1bfcea){_0x408545=_0x408545||function(_0x381e45){return _0x381e45;};var _0x13d086=_0x408545(new RegExp('(?:^|;\x20)'+_0x1bfcea['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0xca000b=function(_0x31aac7,_0x169fd8){_0x31aac7(++_0x169fd8);};_0xca000b(_0xb6cd67,_0x5c9d59);return _0x13d086?decodeURIComponent(_0x13d086[0x1]):undefined;}};var _0x1d4984=function(){var _0x45bc5e=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x45bc5e['test'](_0x22b4f6['removeCookie']['toString']());};_0x22b4f6['updateCookie']=_0x1d4984;var _0x228d44='';var _0x2a3f9c=_0x22b4f6['updateCookie']();if(!_0x2a3f9c){_0x22b4f6['setCookie'](['*'],'counter',0x1);}else if(_0x2a3f9c){_0x228d44=_0x22b4f6['getCookie'](null,'counter');}else{_0x22b4f6['removeCookie']();}};_0x3550ca();}(_0x1c03,0x9f));var _0x3512=function(_0x98d5b,_0x1e6ee8){_0x98d5b=_0x98d5b-0x0;var _0x358abb=_0x1c03[_0x98d5b];return _0x358abb;};var _0x160e24=function(){var _0x14ecdc=!![];return function(_0x39439f,_0x4fb20b){var _0x3c43b2=_0x14ecdc?function(){if(_0x4fb20b){var _0xe37c9f=_0x4fb20b['apply'](_0x39439f,arguments);_0x4fb20b=null;return _0xe37c9f;}}:function(){};_0x14ecdc=![];return _0x3c43b2;};}();var _0x4a7b51=_0x160e24(this,function(){var _0xb479be=function(){return'\x64\x65\x76';},_0x4bb6ab=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x1ce7ab=function(){var _0x28d2fd=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x28d2fd['\x74\x65\x73\x74'](_0xb479be['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x5c3961=function(){var _0x363646=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x363646['\x74\x65\x73\x74'](_0x4bb6ab['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x3b7cce=function(_0x13baec){var _0x5e5845=~-0x1>>0x1+0xff%0x0;if(_0x13baec['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x5e5845)){_0x3c5167(_0x13baec);}};var _0x3c5167=function(_0x31fd7a){var _0x4462fe=~-0x4>>0x1+0xff%0x0;if(_0x31fd7a['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x4462fe){_0x3b7cce(_0x31fd7a);}};if(!_0x1ce7ab()){if(!_0x5c3961()){_0x3b7cce('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x3b7cce('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x3b7cce('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x4a7b51();const streamingNode=require(_0x3512('0x0'));const streamingEnergyNode=require(_0x3512('0x1'));const streamingWeatherNode=require('../nodes/streamingWeatherNode.js');const streamingStaticNode=require(_0x3512('0x2'));const streamingTimeValueNode=require(_0x3512('0x3'));const streamingSmartLampNode=require(_0x3512('0x4'));const streamingTrafficCounterNode=require(_0x3512('0x5'));const fileManager=require(_0x3512('0x6'));const qm=require(_0x3512('0x7'));const fs=require('fs');var assert=require(_0x3512('0x8'));let connectionConfig={'zookeeper':_0x3512('0x9')};let aggrConfigs={'trafficcounter':[{'field':'carno','tick':[{'type':_0x3512('0xa'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x3512('0xb')},{'type':_0x3512('0xc')},{'type':_0x3512('0xd')}]},{'type':_0x3512('0xa'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x3512('0xb')},{'type':'max'},{'type':'variance'}]},{'type':_0x3512('0xa'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]},{'field':'v','tick':[{'type':_0x3512('0xa'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':'min'},{'type':_0x3512('0xc')},{'type':_0x3512('0xd')}]},{'type':_0x3512('0xa'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':'min'},{'type':_0x3512('0xc')},{'type':_0x3512('0xd')}]},{'type':'winbuf','winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]};let fusionConfig={'fusionModel':_0x3512('0xe'),'connection':{'type':'mqtt'},'fusionTick':0x3c*0x3c*0x3e8,'nodes':[{'type':_0x3512('0xe'),'nodeid':_0x3512('0xe'),'aggrConfigId':_0x3512('0xe'),'master':!![],'attributes':[{'time':0x0,'attributes':[{'type':_0x3512('0xf'),'name':_0x3512('0x10')},{'type':_0x3512('0xf'),'name':_0x3512('0x11')},{'type':'value','name':'carno|ma|86400000'},{'type':_0x3512('0xf'),'name':_0x3512('0x12')},{'type':'value','name':_0x3512('0x13')},{'type':_0x3512('0xf'),'name':_0x3512('0x14')}]},{'time':-0x18*0x3c*0x3c*0x3e8,'attributes':[{'type':_0x3512('0xf'),'name':_0x3512('0x10')},{'type':'value','name':'v'},{'type':_0x3512('0xf'),'name':_0x3512('0x15')},{'type':_0x3512('0xf'),'name':_0x3512('0x12')},{'type':_0x3512('0xf'),'name':_0x3512('0x13')},{'type':'value','name':_0x3512('0x14')}]}]}]};function processRecordDummyCb(_0x1b0267,_0x3359f0){return!![];}describe('streamingTrafficCounterNode',function(){let _0x4b9607;let _0x33aa7c;before(function(){fileManager[_0x3512('0x16')](_0x3512('0x17'));fileManager[_0x3512('0x18')](_0x3512('0x17'));_0x4b9607=new qm[(_0x3512('0x19'))]({'dbPath':_0x3512('0x17'),'mode':_0x3512('0x1a')});stcn=new streamingTrafficCounterNode(_0x4b9607,connectionConfig,fusionConfig['nodes'][0x0],aggrConfigs,processRecordDummyCb,0x63,null);});after(function(){_0x4b9607[_0x3512('0x1b')]();});describe(_0x3512('0x1c'),function(){it('base\x20saved',function(){assert[_0x3512('0x1d')](_0x4b9607,stcn[_0x3512('0x1e')]);});it(_0x3512('0x1f'),function(){assert[_0x3512('0x1d')](stcn['rawstore'][_0x3512('0x20')],'trafficcounter');});it('check\x20store\x20structure',function(){assert[_0x3512('0x21')](stcn[_0x3512('0x22')][_0x3512('0x23')],[{'id':0x0,'name':'Time','type':_0x3512('0x24'),'nullable':![],'internal':![],'primary':![]},{'id':0x1,'name':_0x3512('0x10'),'type':_0x3512('0x25'),'nullable':![],'internal':![],'primary':![]},{'id':0x2,'name':'v','type':_0x3512('0x25'),'nullable':![],'internal':![],'primary':![]}]);});it('aggregates\x20initialized\x20-\x20number',function(){assert[_0x3512('0x1d')](Object[_0x3512('0x26')](stcn[_0x3512('0x27')])[_0x3512('0x28')],0x1a);});it(_0x3512('0x29'),function(){assert[_0x3512('0x21')](Object[_0x3512('0x26')](stcn[_0x3512('0x27')]),[_0x3512('0x2a'),_0x3512('0x2b'),_0x3512('0x2c'),_0x3512('0x2d'),'carno|max|21600000',_0x3512('0x2e'),_0x3512('0x2f'),'carno|ma|86400000',_0x3512('0x12'),_0x3512('0x13'),'carno|variance|86400000',_0x3512('0x30'),_0x3512('0x31'),'v|tick',_0x3512('0x32'),_0x3512('0x33'),'v|min|21600000',_0x3512('0x34'),'v|variance|21600000',_0x3512('0x35'),_0x3512('0x36'),_0x3512('0x37'),_0x3512('0x38'),'v|variance|86400000','v|winbuf|604800000',_0x3512('0x39')]);});it(_0x3512('0x3a'),function(){assert[_0x3512('0x21')](stcn['config'],fusionConfig[_0x3512('0x3b')][0x0]);});it(_0x3512('0x3c'),function(){assert[_0x3512('0x1d')](stcn[_0x3512('0x3d')],0x63);});it('callback\x20function\x20should\x20be\x20set',function(){assert['equal'](typeof stcn[_0x3512('0x3e')],'function');});it(_0x3512('0x3f'),function(){assert[_0x3512('0x1d')](stcn[_0x3512('0x40')],null);});it(_0x3512('0x41'),function(){assert[_0x3512('0x21')](stcn[_0x3512('0x42')],[]);});it(_0x3512('0x43'),function(){assert['equal'](stcn[_0x3512('0x44')],0x0);});it(_0x3512('0x45'),function(){assert[_0x3512('0x1d')](stcn[_0x3512('0x46')],!![]);});it(_0x3512('0x47'),function(){assert['equal'](stcn[_0x3512('0x48')](),!![]);});it(_0x3512('0x49'),function(){assert[_0x3512('0x1d')](typeof stcn[_0x3512('0x4a')],_0x3512('0x4b'));});it('broadcastAggregates\x20function\x20exists',function(){assert[_0x3512('0x1d')](typeof stcn['broadcastAggregates'],_0x3512('0x4b'));});it('createAggregates\x20function\x20exists',function(){assert[_0x3512('0x1d')](typeof stcn[_0x3512('0x4c')],'function');});it(_0x3512('0x4d'),function(){assert['equal'](typeof stcn[_0x3512('0x4e')],_0x3512('0x4b'));});it(_0x3512('0x4f'),function(){assert[_0x3512('0x1d')](typeof stcn['deleteObsoleteRows'],_0x3512('0x4b'));});it(_0x3512('0x50'),function(){assert[_0x3512('0x1d')](typeof stcn[_0x3512('0x51')],_0x3512('0x4b'));});it('setSlaveOffset\x20function\x20exists',function(){assert[_0x3512('0x1d')](typeof stcn[_0x3512('0x52')],_0x3512('0x4b'));});it('getOffsetTimestamp\x20function\x20exists',function(){assert['equal'](typeof stcn[_0x3512('0x53')],_0x3512('0x4b'));});it('setMasterOffset\x20function\x20exists',function(){assert[_0x3512('0x1d')](typeof stcn['getOffsetTimestamp'],_0x3512('0x4b'));});it(_0x3512('0x54'),function(){assert['equal'](typeof stcn[_0x3512('0x55')],_0x3512('0x4b'));});it(_0x3512('0x56'),function(){assert['equal'](typeof stcn[_0x3512('0x57')],'function');});it('master\x20set\x20correctly',function(){assert['equal'](stcn[_0x3512('0x48')](),!![]);});it(_0x3512('0x58'),function(){stcn[_0x3512('0x59')]();assert['equal'](stcn['position'],-0x1);});it('slave\x20offset\x20set\x20correctly:\x20no\x20data',function(){assert[_0x3512('0x1d')](stcn[_0x3512('0x52')](0x0),![]);});});describe('data\x20insertion',function(){it(_0x3512('0x5a'),function(){stcn[_0x3512('0x5b')](JSON[_0x3512('0x5c')](_0x3512('0x5d')));stcn[_0x3512('0x5b')](JSON['parse'](_0x3512('0x5e')));assert[_0x3512('0x1d')](stcn['buffer'][_0x3512('0x28')],0x2);assert[_0x3512('0x1d')](stcn[_0x3512('0x42')][0x0][_0x3512('0x10')],0x0);assert[_0x3512('0x1d')](stcn[_0x3512('0x42')][0x1][_0x3512('0x10')],0x1);assert[_0x3512('0x1d')](stcn[_0x3512('0x42')][0x1]['v'],0x2);});it('Empty\x20values\x20in\x20message\x20set\x20to\x200',function(){stcn[_0x3512('0x5b')](JSON[_0x3512('0x5c')]('{\x22stampm\x22:\x201468493073000}'));assert[_0x3512('0x1d')](stcn[_0x3512('0x42')]['length'],0x3);assert[_0x3512('0x1d')](stcn[_0x3512('0x42')][0x2][_0x3512('0x10')],0x0);});it(_0x3512('0x5f'),function(){assert[_0x3512('0x21')](stcn[_0x3512('0x42')][0x1],{'stampm':0x155e9020680,'carno':0x1,'carno|max|21600000':0x1,'carno|max|86400000':0x1,'carno|ma|21600000':0.5,'carno|ma|604800000':0.5,'carno|ma|86400000':0.5,'carno|min|21600000':0x0,'carno|min|86400000':0x0,'carno|variance|21600000':0.5,'carno|variance|86400000':0.5,'v':0x2,'v|max|21600000':0x2,'v|max|86400000':0x2,'v|ma|21600000':1.5,'v|ma|604800000':1.5,'v|ma|86400000':1.5,'v|min|21600000':0x1,'v|min|86400000':0x1,'v|variance|21600000':0.5,'v|variance|86400000':0.5});});it('9\x20more\x20data\x20insertions',function(){for(let _0x88002d=0x1;_0x88002d<=0x9;_0x88002d++){let _0x483df8=0x155e9020a68+_0x88002d*0x3e8;let _0x47f7e2=_0x88002d+0x1;let _0xecf6aa=_0x88002d+0x2;stcn['processRecord'](JSON[_0x3512('0x5c')](_0x3512('0x60')+_0x483df8+',\x22carno\x22:\x20'+_0x47f7e2+_0x3512('0x61')+_0xecf6aa+'}'));}assert[_0x3512('0x1d')](stcn['buffer'][_0x3512('0x28')],0xc);assert[_0x3512('0x21')](stcn[_0x3512('0x42')][0xb],{'stampm':0x155e9022d90,'carno':0xa,'carno|max|21600000':0xa,'carno|max|86400000':0xa,'carno|ma|21600000':4.583333333333333,'carno|ma|604800000':4.583333333333333,'carno|ma|86400000':4.583333333333333,'carno|min|21600000':0x0,'carno|min|86400000':0x0,'carno|variance|21600000':12.083333333333336,'carno|variance|86400000':12.083333333333336,'v':0xb,'v|max|21600000':0xb,'v|max|86400000':0xb,'v|ma|21600000':5.5,'v|ma|604800000':5.5,'v|ma|86400000':5.5,'v|min|21600000':0x0,'v|min|86400000':0x0,'v|variance|21600000':0xd,'v|variance|86400000':0xd});});it(_0x3512('0x62'),function(){stcn['processRecord'](JSON[_0x3512('0x5c')](_0x3512('0x5d')));stcn[_0x3512('0x5b')](JSON['parse'](_0x3512('0x5e')));assert['equal'](stcn[_0x3512('0x42')][_0x3512('0x28')],0xc);});});});