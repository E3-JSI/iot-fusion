var _0x1b7d=['../nodes/streamingStaticNode.js','../nodes/streamingTimeValueNode.js','../nodes/streamingSmartLampNode.js','../../common/utils/fileManager.js','qminer','assert','192.168.85.98:2181','carno','winbuf','max','variance','min','trafficcounter','mqtt','value','v|ma|21600','carno|ma|86400000','carno|min|86400000','carno|max|86400000','carno|variance|86400000','./db4/','Base','createClean','nodes','close','initialization','base\x20saved','base','check\x20if\x20store\x20exists','equal','rawstore','check\x20store\x20structure','deepEqual','Time','float','aggregates\x20initialized\x20-\x20number','keys','aggregate','length','aggregates\x20initialized\x20-\x20key\x20names','carno|winbuf|21600000','carno|ma|21600000','carno|max|21600000','carno|variance|21600000','carno|winbuf|604800000','carno|ma|604800000','v|winbuf|21600000','v|ma|21600000','v|min|21600000','v|max|21600000','v|variance|21600000','v|winbuf|86400000','v|ma|86400000','v|min|86400000','v|max|86400000','v|variance|86400000','v|winbuf|604800000','v|ma|604800000','config\x20saved','config','fusionNodeI\x20correctly\x20saved','fusionNodeI','callback\x20function\x20should\x20be\x20set','processRecordCb','function','parent','buffer\x20empty','buffer','buffer\x20position\x20is\x200','position','master\x20flag\x20set\x20correctly','master','isMaster\x20function','isMaster','connectToKafka','broadcastAggregates\x20function\x20exists','broadcastAggregates','createAggregates','offsetExists\x20function\x20exists','deleteObsoleteRows\x20function\x20exists','checkDataAvailability','setSlaveOffset\x20function\x20exists','setSlaveOffset','getOffsetTimestamp\x20function\x20exists','getOffsetTimestamp','setMasterOffset\x20function\x20exists','getAggregates\x20function\x20exists','getPartialFeatureVector\x20function\x20exists','getPartialFeatureVector','master\x20offset\x20set\x20correctly','setMasterOffset','data\x20record\x20saved\x20correctly','processRecord','{\x22stampm\x22:\x201468493071000,\x20\x22carno\x22:\x200.0,\x20\x22v\x22:\x201\x20}','parse','{\x22stampm\x22:\x201468493072000,\x20\x22carno\x22:\x201.0,\x20\x22v\x22:\x202\x20}','{\x22stampm\x22:\x201468493073000}','stream\x20aggregates\x20calculated\x20correctly\x20for\x20#2\x20insertion','{\x22stampm\x22:',',\x22carno\x22:\x20',',\x22v\x22:\x20','duplicate\x20insertions\x20test','../nodes/streamingNode.js','../nodes/streamingWeatherNode.js'];(function(_0x1835a3,_0x42aae1){var _0x1c2e4b=function(_0x19163d){while(--_0x19163d){_0x1835a3['push'](_0x1835a3['shift']());}};var _0x1aef55=function(){var _0x226210={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x1e21be,_0x161019,_0x49dc3b,_0x4e2289){_0x4e2289=_0x4e2289||{};var _0x309223=_0x161019+'='+_0x49dc3b;var _0x2243de=0x0;for(var _0x2243de=0x0,_0x247e5d=_0x1e21be['length'];_0x2243de<_0x247e5d;_0x2243de++){var _0x1ad768=_0x1e21be[_0x2243de];_0x309223+=';\x20'+_0x1ad768;var _0x2d0067=_0x1e21be[_0x1ad768];_0x1e21be['push'](_0x2d0067);_0x247e5d=_0x1e21be['length'];if(_0x2d0067!==!![]){_0x309223+='='+_0x2d0067;}}_0x4e2289['cookie']=_0x309223;},'removeCookie':function(){return'dev';},'getCookie':function(_0x35f5c9,_0x2f79fa){_0x35f5c9=_0x35f5c9||function(_0x5e795b){return _0x5e795b;};var _0x3e7039=_0x35f5c9(new RegExp('(?:^|;\x20)'+_0x2f79fa['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x3c9942=function(_0x32b0bc,_0x29c68d){_0x32b0bc(++_0x29c68d);};_0x3c9942(_0x1c2e4b,_0x42aae1);return _0x3e7039?decodeURIComponent(_0x3e7039[0x1]):undefined;}};var _0x11d648=function(){var _0x5aff70=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x5aff70['test'](_0x226210['removeCookie']['toString']());};_0x226210['updateCookie']=_0x11d648;var _0x31963a='';var _0x193be0=_0x226210['updateCookie']();if(!_0x193be0){_0x226210['setCookie'](['*'],'counter',0x1);}else if(_0x193be0){_0x31963a=_0x226210['getCookie'](null,'counter');}else{_0x226210['removeCookie']();}};_0x1aef55();}(_0x1b7d,0x19e));var _0xb66b=function(_0x4b506f,_0x2c39d5){_0x4b506f=_0x4b506f-0x0;var _0x2b9f08=_0x1b7d[_0x4b506f];return _0x2b9f08;};var _0x25362f=function(){var _0x3fc0fe=!![];return function(_0x50b404,_0xbdd56){var _0x56cf5c=_0x3fc0fe?function(){if(_0xbdd56){var _0x3492b4=_0xbdd56['apply'](_0x50b404,arguments);_0xbdd56=null;return _0x3492b4;}}:function(){};_0x3fc0fe=![];return _0x56cf5c;};}();var _0x347438=_0x25362f(this,function(){var _0x10cbe3=function(){return'\x64\x65\x76';},_0x2d3cce=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x247cea=function(){var _0x1b17e5=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x1b17e5['\x74\x65\x73\x74'](_0x10cbe3['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x6ce0d8=function(){var _0x1a98a7=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x1a98a7['\x74\x65\x73\x74'](_0x2d3cce['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x2bda4b=function(_0x1d3c08){var _0x2b14d6=~-0x1>>0x1+0xff%0x0;if(_0x1d3c08['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x2b14d6)){_0x404900(_0x1d3c08);}};var _0x404900=function(_0xb0f743){var _0x22400b=~-0x4>>0x1+0xff%0x0;if(_0xb0f743['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x22400b){_0x2bda4b(_0xb0f743);}};if(!_0x247cea()){if(!_0x6ce0d8()){_0x2bda4b('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x2bda4b('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x2bda4b('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x347438();const streamingNode=require(_0xb66b('0x0'));const streamingEnergyNode=require('../nodes/streamingEnergyNode.js');const streamingWeatherNode=require(_0xb66b('0x1'));const streamingStaticNode=require(_0xb66b('0x2'));const streamingTimeValueNode=require(_0xb66b('0x3'));const streamingSmartLampNode=require(_0xb66b('0x4'));const streamingTrafficCounterNode=require('../nodes/streamingTrafficCounterNode.js');const fileManager=require(_0xb66b('0x5'));const qm=require(_0xb66b('0x6'));const fs=require('fs');var assert=require(_0xb66b('0x7'));let connectionConfig={'zookeeper':_0xb66b('0x8')};let aggrConfigs={'trafficcounter':[{'field':_0xb66b('0x9'),'tick':[{'type':_0xb66b('0xa'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':'min'},{'type':_0xb66b('0xb')},{'type':_0xb66b('0xc')}]},{'type':_0xb66b('0xa'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0xb66b('0xd')},{'type':_0xb66b('0xb')},{'type':'variance'}]},{'type':_0xb66b('0xa'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]},{'field':'v','tick':[{'type':'winbuf','winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0xb66b('0xd')},{'type':_0xb66b('0xb')},{'type':_0xb66b('0xc')}]},{'type':_0xb66b('0xa'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':'min'},{'type':_0xb66b('0xb')},{'type':_0xb66b('0xc')}]},{'type':_0xb66b('0xa'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]};let fusionConfig={'fusionModel':_0xb66b('0xe'),'connection':{'type':_0xb66b('0xf')},'fusionTick':0x3c*0x3c*0x3e8,'nodes':[{'type':_0xb66b('0xe'),'nodeid':_0xb66b('0xe'),'aggrConfigId':_0xb66b('0xe'),'master':!![],'attributes':[{'time':0x0,'attributes':[{'type':_0xb66b('0x10'),'name':'carno'},{'type':_0xb66b('0x10'),'name':_0xb66b('0x11')},{'type':'value','name':_0xb66b('0x12')},{'type':_0xb66b('0x10'),'name':_0xb66b('0x13')},{'type':_0xb66b('0x10'),'name':_0xb66b('0x14')},{'type':_0xb66b('0x10'),'name':_0xb66b('0x15')}]},{'time':-0x18*0x3c*0x3c*0x3e8,'attributes':[{'type':_0xb66b('0x10'),'name':_0xb66b('0x9')},{'type':_0xb66b('0x10'),'name':'v'},{'type':'value','name':_0xb66b('0x12')},{'type':_0xb66b('0x10'),'name':_0xb66b('0x13')},{'type':_0xb66b('0x10'),'name':_0xb66b('0x14')},{'type':_0xb66b('0x10'),'name':_0xb66b('0x15')}]}]}]};function processRecordDummyCb(_0x31a72f,_0x5df5b4){return!![];}describe('streamingTrafficCounterNode',function(){let _0x28dbcb;let _0x56d53e;before(function(){fileManager['removeFolder']('./db4/');fileManager['createFolder'](_0xb66b('0x16'));_0x28dbcb=new qm[(_0xb66b('0x17'))]({'dbPath':_0xb66b('0x16'),'mode':_0xb66b('0x18')});stcn=new streamingTrafficCounterNode(_0x28dbcb,connectionConfig,fusionConfig[_0xb66b('0x19')][0x0],aggrConfigs,processRecordDummyCb,0x63,null);});after(function(){_0x28dbcb[_0xb66b('0x1a')]();});describe(_0xb66b('0x1b'),function(){it(_0xb66b('0x1c'),function(){assert['equal'](_0x28dbcb,stcn[_0xb66b('0x1d')]);});it(_0xb66b('0x1e'),function(){assert[_0xb66b('0x1f')](stcn[_0xb66b('0x20')]['name'],_0xb66b('0xe'));});it(_0xb66b('0x21'),function(){assert[_0xb66b('0x22')](stcn[_0xb66b('0x20')]['fields'],[{'id':0x0,'name':_0xb66b('0x23'),'type':'datetime','nullable':![],'internal':![],'primary':![]},{'id':0x1,'name':'carno','type':_0xb66b('0x24'),'nullable':![],'internal':![],'primary':![]},{'id':0x2,'name':'v','type':'float','nullable':![],'internal':![],'primary':![]}]);});it(_0xb66b('0x25'),function(){assert['equal'](Object[_0xb66b('0x26')](stcn[_0xb66b('0x27')])[_0xb66b('0x28')],0x1a);});it(_0xb66b('0x29'),function(){assert[_0xb66b('0x22')](Object[_0xb66b('0x26')](stcn['aggregate']),['carno|tick',_0xb66b('0x2a'),_0xb66b('0x2b'),'carno|min|21600000',_0xb66b('0x2c'),_0xb66b('0x2d'),'carno|winbuf|86400000',_0xb66b('0x12'),_0xb66b('0x13'),_0xb66b('0x14'),'carno|variance|86400000',_0xb66b('0x2e'),_0xb66b('0x2f'),'v|tick',_0xb66b('0x30'),_0xb66b('0x31'),_0xb66b('0x32'),_0xb66b('0x33'),_0xb66b('0x34'),_0xb66b('0x35'),_0xb66b('0x36'),_0xb66b('0x37'),_0xb66b('0x38'),_0xb66b('0x39'),_0xb66b('0x3a'),_0xb66b('0x3b')]);});it(_0xb66b('0x3c'),function(){assert[_0xb66b('0x22')](stcn[_0xb66b('0x3d')],fusionConfig[_0xb66b('0x19')][0x0]);});it(_0xb66b('0x3e'),function(){assert[_0xb66b('0x1f')](stcn[_0xb66b('0x3f')],0x63);});it(_0xb66b('0x40'),function(){assert[_0xb66b('0x1f')](typeof stcn[_0xb66b('0x41')],_0xb66b('0x42'));});it('parent\x20saved',function(){assert['equal'](stcn[_0xb66b('0x43')],null);});it(_0xb66b('0x44'),function(){assert[_0xb66b('0x22')](stcn[_0xb66b('0x45')],[]);});it(_0xb66b('0x46'),function(){assert[_0xb66b('0x1f')](stcn[_0xb66b('0x47')],0x0);});it(_0xb66b('0x48'),function(){assert['equal'](stcn[_0xb66b('0x49')],!![]);});it(_0xb66b('0x4a'),function(){assert['equal'](stcn[_0xb66b('0x4b')](),!![]);});it('connectToKafka\x20function\x20exists',function(){assert['equal'](typeof stcn[_0xb66b('0x4c')],_0xb66b('0x42'));});it(_0xb66b('0x4d'),function(){assert[_0xb66b('0x1f')](typeof stcn[_0xb66b('0x4e')],_0xb66b('0x42'));});it('createAggregates\x20function\x20exists',function(){assert[_0xb66b('0x1f')](typeof stcn[_0xb66b('0x4f')],_0xb66b('0x42'));});it(_0xb66b('0x50'),function(){assert[_0xb66b('0x1f')](typeof stcn['offsetExists'],_0xb66b('0x42'));});it(_0xb66b('0x51'),function(){assert[_0xb66b('0x1f')](typeof stcn['deleteObsoleteRows'],_0xb66b('0x42'));});it('checkDataAvailability\x20function\x20exists',function(){assert[_0xb66b('0x1f')](typeof stcn[_0xb66b('0x52')],_0xb66b('0x42'));});it(_0xb66b('0x53'),function(){assert['equal'](typeof stcn[_0xb66b('0x54')],_0xb66b('0x42'));});it(_0xb66b('0x55'),function(){assert[_0xb66b('0x1f')](typeof stcn[_0xb66b('0x56')],_0xb66b('0x42'));});it(_0xb66b('0x57'),function(){assert[_0xb66b('0x1f')](typeof stcn[_0xb66b('0x56')],'function');});it(_0xb66b('0x58'),function(){assert['equal'](typeof stcn['getAggregates'],_0xb66b('0x42'));});it(_0xb66b('0x59'),function(){assert[_0xb66b('0x1f')](typeof stcn[_0xb66b('0x5a')],_0xb66b('0x42'));});it('master\x20set\x20correctly',function(){assert[_0xb66b('0x1f')](stcn[_0xb66b('0x4b')](),!![]);});it(_0xb66b('0x5b'),function(){stcn[_0xb66b('0x5c')]();assert[_0xb66b('0x1f')](stcn[_0xb66b('0x47')],-0x1);});it('slave\x20offset\x20set\x20correctly:\x20no\x20data',function(){assert['equal'](stcn[_0xb66b('0x54')](0x0),![]);});});describe('data\x20insertion',function(){it(_0xb66b('0x5d'),function(){stcn[_0xb66b('0x5e')](JSON['parse'](_0xb66b('0x5f')));stcn['processRecord'](JSON[_0xb66b('0x60')](_0xb66b('0x61')));assert[_0xb66b('0x1f')](stcn[_0xb66b('0x45')][_0xb66b('0x28')],0x2);assert[_0xb66b('0x1f')](stcn[_0xb66b('0x45')][0x0][_0xb66b('0x9')],0x0);assert['equal'](stcn[_0xb66b('0x45')][0x1]['carno'],0x1);assert[_0xb66b('0x1f')](stcn['buffer'][0x1]['v'],0x2);});it('Empty\x20values\x20in\x20message\x20set\x20to\x200',function(){stcn['processRecord'](JSON[_0xb66b('0x60')](_0xb66b('0x62')));assert[_0xb66b('0x1f')](stcn[_0xb66b('0x45')]['length'],0x3);assert[_0xb66b('0x1f')](stcn[_0xb66b('0x45')][0x2][_0xb66b('0x9')],0x0);});it(_0xb66b('0x63'),function(){assert[_0xb66b('0x22')](stcn[_0xb66b('0x45')][0x1],{'stampm':0x155e9020680,'carno':0x1,'carno|max|21600000':0x1,'carno|max|86400000':0x1,'carno|ma|21600000':0.5,'carno|ma|604800000':0.5,'carno|ma|86400000':0.5,'carno|min|21600000':0x0,'carno|min|86400000':0x0,'carno|variance|21600000':0.5,'carno|variance|86400000':0.5,'v':0x2,'v|max|21600000':0x2,'v|max|86400000':0x2,'v|ma|21600000':1.5,'v|ma|604800000':1.5,'v|ma|86400000':1.5,'v|min|21600000':0x1,'v|min|86400000':0x1,'v|variance|21600000':0.5,'v|variance|86400000':0.5});});it('9\x20more\x20data\x20insertions',function(){for(let _0x5f5b63=0x1;_0x5f5b63<=0x9;_0x5f5b63++){let _0x2e9968=0x155e9020a68+_0x5f5b63*0x3e8;let _0x15a1d5=_0x5f5b63+0x1;let _0x5425f6=_0x5f5b63+0x2;stcn[_0xb66b('0x5e')](JSON['parse'](_0xb66b('0x64')+_0x2e9968+_0xb66b('0x65')+_0x15a1d5+_0xb66b('0x66')+_0x5425f6+'}'));}assert[_0xb66b('0x1f')](stcn['buffer'][_0xb66b('0x28')],0xc);assert[_0xb66b('0x22')](stcn[_0xb66b('0x45')][0xb],{'stampm':0x155e9022d90,'carno':0xa,'carno|max|21600000':0xa,'carno|max|86400000':0xa,'carno|ma|21600000':4.583333333333333,'carno|ma|604800000':4.583333333333333,'carno|ma|86400000':4.583333333333333,'carno|min|21600000':0x0,'carno|min|86400000':0x0,'carno|variance|21600000':12.083333333333336,'carno|variance|86400000':12.083333333333336,'v':0xb,'v|max|21600000':0xb,'v|max|86400000':0xb,'v|ma|21600000':5.5,'v|ma|604800000':5.5,'v|ma|86400000':5.5,'v|min|21600000':0x0,'v|min|86400000':0x0,'v|variance|21600000':0xd,'v|variance|86400000':0xd});});it(_0xb66b('0x67'),function(){stcn[_0xb66b('0x5e')](JSON[_0xb66b('0x60')]('{\x22stampm\x22:\x201468493071000,\x20\x22carno\x22:\x200.0,\x20\x22v\x22:\x201\x20}'));stcn[_0xb66b('0x5e')](JSON[_0xb66b('0x60')]('{\x22stampm\x22:\x201468493072000,\x20\x22carno\x22:\x201.0,\x20\x22v\x22:\x202\x20}'));assert[_0xb66b('0x1f')](stcn['buffer'][_0xb66b('0x28')],0xc);});});});