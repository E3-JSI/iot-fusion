var _0x2a1f=['Base','close','initialization','equal','base','check\x20if\x20store\x20exists','rawstore','name','deepEqual','fields','Time','datetime','float','aggregates\x20initialized\x20-\x20number','aggregate','length','keys','carno|tick','carno|winbuf|21600000','carno|ma|21600000','carno|min|21600000','carno|variance|21600000','carno|winbuf|86400000','carno|ma|604800000','v|tick','v|winbuf|21600000','v|ma|21600000','v|max|21600000','v|winbuf|86400000','v|ma|86400000','v|max|86400000','v|winbuf|604800000','config\x20saved','nodes','fusionNodeI\x20correctly\x20saved','fusionNodeI','callback\x20function\x20should\x20be\x20set','processRecordCb','function','parent\x20saved','parent','buffer\x20empty','position','master\x20flag\x20set\x20correctly','master','isMaster\x20function','connectToKafka\x20function\x20exists','broadcastAggregates\x20function\x20exists','broadcastAggregates','createAggregates\x20function\x20exists','createAggregates','offsetExists\x20function\x20exists','offsetExists','deleteObsoleteRows\x20function\x20exists','deleteObsoleteRows','checkDataAvailability\x20function\x20exists','checkDataAvailability','setSlaveOffset\x20function\x20exists','getOffsetTimestamp','setMasterOffset\x20function\x20exists','getAggregates\x20function\x20exists','getPartialFeatureVector\x20function\x20exists','getPartialFeatureVector','master\x20set\x20correctly','isMaster','master\x20offset\x20set\x20correctly','setMasterOffset','setSlaveOffset','data\x20insertion','data\x20record\x20saved\x20correctly','processRecord','parse','{\x22stampm\x22:\x201468493071000,\x20\x22carno\x22:\x200.0,\x20\x22v\x22:\x201\x20}','{\x22stampm\x22:\x201468493072000,\x20\x22carno\x22:\x201.0,\x20\x22v\x22:\x202\x20}','buffer','Empty\x20values\x20in\x20message\x20set\x20to\x200','{\x22stampm\x22:\x201468493073000}','stream\x20aggregates\x20calculated\x20correctly\x20for\x20#2\x20insertion','{\x22stampm\x22:',',\x22v\x22:\x20','../nodes/streamingEnergyNode.js','../nodes/streamingTrafficCounterNode.js','qminer','assert','192.168.85.98:2181','winbuf','min','max','variance','trafficcounter','value','carno','v|ma|21600','carno|ma|86400000','carno|min|86400000','carno|max|86400000','carno|variance|86400000','streamingTrafficCounterNode','removeFolder','./db4/'];(function(_0x2b13a6,_0x443f49){var _0x27f990=function(_0x1db60e){while(--_0x1db60e){_0x2b13a6['push'](_0x2b13a6['shift']());}};var _0x5f15e5=function(){var _0x4ba242={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x22ded4,_0x349460,_0x53ba4d,_0x36b3a7){_0x36b3a7=_0x36b3a7||{};var _0x414090=_0x349460+'='+_0x53ba4d;var _0x4ca658=0x0;for(var _0x4ca658=0x0,_0x2c836c=_0x22ded4['length'];_0x4ca658<_0x2c836c;_0x4ca658++){var _0x41bcc3=_0x22ded4[_0x4ca658];_0x414090+=';\x20'+_0x41bcc3;var _0xcc52c3=_0x22ded4[_0x41bcc3];_0x22ded4['push'](_0xcc52c3);_0x2c836c=_0x22ded4['length'];if(_0xcc52c3!==!![]){_0x414090+='='+_0xcc52c3;}}_0x36b3a7['cookie']=_0x414090;},'removeCookie':function(){return'dev';},'getCookie':function(_0x3734e9,_0x4957fa){_0x3734e9=_0x3734e9||function(_0x3a3c90){return _0x3a3c90;};var _0x204545=_0x3734e9(new RegExp('(?:^|;\x20)'+_0x4957fa['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x18226b=function(_0x73db99,_0x35b9d5){_0x73db99(++_0x35b9d5);};_0x18226b(_0x27f990,_0x443f49);return _0x204545?decodeURIComponent(_0x204545[0x1]):undefined;}};var _0x2fdd1e=function(){var _0x56d699=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x56d699['test'](_0x4ba242['removeCookie']['toString']());};_0x4ba242['updateCookie']=_0x2fdd1e;var _0x1f4e0e='';var _0xab935=_0x4ba242['updateCookie']();if(!_0xab935){_0x4ba242['setCookie'](['*'],'counter',0x1);}else if(_0xab935){_0x1f4e0e=_0x4ba242['getCookie'](null,'counter');}else{_0x4ba242['removeCookie']();}};_0x5f15e5();}(_0x2a1f,0x17c));var _0x98d1=function(_0x2d8f05,_0x4b81bb){_0x2d8f05=_0x2d8f05-0x0;var _0x4d74cb=_0x2a1f[_0x2d8f05];return _0x4d74cb;};var _0x304856=function(){var _0x33c4af=!![];return function(_0x44c4d4,_0x51e6f1){var _0x22df7a=_0x33c4af?function(){if(_0x51e6f1){var _0x217f7a=_0x51e6f1['apply'](_0x44c4d4,arguments);_0x51e6f1=null;return _0x217f7a;}}:function(){};_0x33c4af=![];return _0x22df7a;};}();var _0x280ebf=_0x304856(this,function(){var _0x43d3bd=function(){return'\x64\x65\x76';},_0x2618d1=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x239e85=function(){var _0x2327c7=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x2327c7['\x74\x65\x73\x74'](_0x43d3bd['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x5c052c=function(){var _0x125796=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x125796['\x74\x65\x73\x74'](_0x2618d1['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x15a0c8=function(_0x86743){var _0x3f3dd3=~-0x1>>0x1+0xff%0x0;if(_0x86743['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x3f3dd3)){_0xf5d4c7(_0x86743);}};var _0xf5d4c7=function(_0x163645){var _0x5c32e7=~-0x4>>0x1+0xff%0x0;if(_0x163645['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x5c32e7){_0x15a0c8(_0x163645);}};if(!_0x239e85()){if(!_0x5c052c()){_0x15a0c8('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x15a0c8('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x15a0c8('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x280ebf();const streamingNode=require('../nodes/streamingNode.js');const streamingEnergyNode=require(_0x98d1('0x0'));const streamingWeatherNode=require('../nodes/streamingWeatherNode.js');const streamingStaticNode=require('../nodes/streamingStaticNode.js');const streamingTimeValueNode=require('../nodes/streamingTimeValueNode.js');const streamingSmartLampNode=require('../nodes/streamingSmartLampNode.js');const streamingTrafficCounterNode=require(_0x98d1('0x1'));const fileManager=require('../../common/utils/fileManager.js');const qm=require(_0x98d1('0x2'));const fs=require('fs');var assert=require(_0x98d1('0x3'));let connectionConfig={'zookeeper':_0x98d1('0x4')};let aggrConfigs={'trafficcounter':[{'field':'carno','tick':[{'type':_0x98d1('0x5'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x98d1('0x6')},{'type':_0x98d1('0x7')},{'type':_0x98d1('0x8')}]},{'type':_0x98d1('0x5'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':'min'},{'type':_0x98d1('0x7')},{'type':_0x98d1('0x8')}]},{'type':'winbuf','winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]},{'field':'v','tick':[{'type':_0x98d1('0x5'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':'min'},{'type':'max'},{'type':_0x98d1('0x8')}]},{'type':'winbuf','winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':'min'},{'type':_0x98d1('0x7')},{'type':_0x98d1('0x8')}]},{'type':_0x98d1('0x5'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]};let fusionConfig={'fusionModel':'trafficcounter','connection':{'type':'mqtt'},'fusionTick':0x3c*0x3c*0x3e8,'nodes':[{'type':'trafficcounter','nodeid':_0x98d1('0x9'),'aggrConfigId':_0x98d1('0x9'),'master':!![],'attributes':[{'time':0x0,'attributes':[{'type':_0x98d1('0xa'),'name':_0x98d1('0xb')},{'type':_0x98d1('0xa'),'name':_0x98d1('0xc')},{'type':_0x98d1('0xa'),'name':_0x98d1('0xd')},{'type':_0x98d1('0xa'),'name':_0x98d1('0xe')},{'type':'value','name':_0x98d1('0xf')},{'type':_0x98d1('0xa'),'name':_0x98d1('0x10')}]},{'time':-0x18*0x3c*0x3c*0x3e8,'attributes':[{'type':'value','name':_0x98d1('0xb')},{'type':_0x98d1('0xa'),'name':'v'},{'type':'value','name':_0x98d1('0xd')},{'type':_0x98d1('0xa'),'name':_0x98d1('0xe')},{'type':_0x98d1('0xa'),'name':_0x98d1('0xf')},{'type':_0x98d1('0xa'),'name':_0x98d1('0x10')}]}]}]};function processRecordDummyCb(_0x5065c8,_0x279dba){return!![];}describe(_0x98d1('0x11'),function(){let _0x304572;let _0x59bca2;before(function(){fileManager[_0x98d1('0x12')](_0x98d1('0x13'));fileManager['createFolder']('./db4/');_0x304572=new qm[(_0x98d1('0x14'))]({'dbPath':'./db4/','mode':'createClean'});stcn=new streamingTrafficCounterNode(_0x304572,connectionConfig,fusionConfig['nodes'][0x0],aggrConfigs,processRecordDummyCb,0x63,null);});after(function(){_0x304572[_0x98d1('0x15')]();});describe(_0x98d1('0x16'),function(){it('base\x20saved',function(){assert[_0x98d1('0x17')](_0x304572,stcn[_0x98d1('0x18')]);});it(_0x98d1('0x19'),function(){assert[_0x98d1('0x17')](stcn[_0x98d1('0x1a')][_0x98d1('0x1b')],_0x98d1('0x9'));});it('check\x20store\x20structure',function(){assert[_0x98d1('0x1c')](stcn['rawstore'][_0x98d1('0x1d')],[{'id':0x0,'name':_0x98d1('0x1e'),'type':_0x98d1('0x1f'),'nullable':![],'internal':![],'primary':![]},{'id':0x1,'name':'carno','type':_0x98d1('0x20'),'nullable':![],'internal':![],'primary':![]},{'id':0x2,'name':'v','type':_0x98d1('0x20'),'nullable':![],'internal':![],'primary':![]}]);});it(_0x98d1('0x21'),function(){assert[_0x98d1('0x17')](Object['keys'](stcn[_0x98d1('0x22')])[_0x98d1('0x23')],0x1a);});it('aggregates\x20initialized\x20-\x20key\x20names',function(){assert[_0x98d1('0x1c')](Object[_0x98d1('0x24')](stcn[_0x98d1('0x22')]),[_0x98d1('0x25'),_0x98d1('0x26'),_0x98d1('0x27'),_0x98d1('0x28'),'carno|max|21600000',_0x98d1('0x29'),_0x98d1('0x2a'),'carno|ma|86400000',_0x98d1('0xe'),'carno|max|86400000','carno|variance|86400000','carno|winbuf|604800000',_0x98d1('0x2b'),_0x98d1('0x2c'),_0x98d1('0x2d'),_0x98d1('0x2e'),'v|min|21600000',_0x98d1('0x2f'),'v|variance|21600000',_0x98d1('0x30'),_0x98d1('0x31'),'v|min|86400000',_0x98d1('0x32'),'v|variance|86400000',_0x98d1('0x33'),'v|ma|604800000']);});it(_0x98d1('0x34'),function(){assert['deepEqual'](stcn['config'],fusionConfig[_0x98d1('0x35')][0x0]);});it(_0x98d1('0x36'),function(){assert['equal'](stcn[_0x98d1('0x37')],0x63);});it(_0x98d1('0x38'),function(){assert[_0x98d1('0x17')](typeof stcn[_0x98d1('0x39')],_0x98d1('0x3a'));});it(_0x98d1('0x3b'),function(){assert['equal'](stcn[_0x98d1('0x3c')],null);});it(_0x98d1('0x3d'),function(){assert[_0x98d1('0x1c')](stcn['buffer'],[]);});it('buffer\x20position\x20is\x200',function(){assert[_0x98d1('0x17')](stcn[_0x98d1('0x3e')],0x0);});it(_0x98d1('0x3f'),function(){assert[_0x98d1('0x17')](stcn[_0x98d1('0x40')],!![]);});it(_0x98d1('0x41'),function(){assert[_0x98d1('0x17')](stcn['isMaster'](),!![]);});it(_0x98d1('0x42'),function(){assert[_0x98d1('0x17')](typeof stcn['connectToKafka'],_0x98d1('0x3a'));});it(_0x98d1('0x43'),function(){assert[_0x98d1('0x17')](typeof stcn[_0x98d1('0x44')],'function');});it(_0x98d1('0x45'),function(){assert['equal'](typeof stcn[_0x98d1('0x46')],'function');});it(_0x98d1('0x47'),function(){assert[_0x98d1('0x17')](typeof stcn[_0x98d1('0x48')],_0x98d1('0x3a'));});it(_0x98d1('0x49'),function(){assert[_0x98d1('0x17')](typeof stcn[_0x98d1('0x4a')],_0x98d1('0x3a'));});it(_0x98d1('0x4b'),function(){assert[_0x98d1('0x17')](typeof stcn[_0x98d1('0x4c')],_0x98d1('0x3a'));});it(_0x98d1('0x4d'),function(){assert['equal'](typeof stcn['setSlaveOffset'],'function');});it('getOffsetTimestamp\x20function\x20exists',function(){assert[_0x98d1('0x17')](typeof stcn[_0x98d1('0x4e')],_0x98d1('0x3a'));});it(_0x98d1('0x4f'),function(){assert['equal'](typeof stcn[_0x98d1('0x4e')],_0x98d1('0x3a'));});it(_0x98d1('0x50'),function(){assert['equal'](typeof stcn['getAggregates'],_0x98d1('0x3a'));});it(_0x98d1('0x51'),function(){assert['equal'](typeof stcn[_0x98d1('0x52')],_0x98d1('0x3a'));});it(_0x98d1('0x53'),function(){assert[_0x98d1('0x17')](stcn[_0x98d1('0x54')](),!![]);});it(_0x98d1('0x55'),function(){stcn[_0x98d1('0x56')]();assert['equal'](stcn[_0x98d1('0x3e')],-0x1);});it('slave\x20offset\x20set\x20correctly:\x20no\x20data',function(){assert['equal'](stcn[_0x98d1('0x57')](0x0),![]);});});describe(_0x98d1('0x58'),function(){it(_0x98d1('0x59'),function(){stcn[_0x98d1('0x5a')](JSON[_0x98d1('0x5b')](_0x98d1('0x5c')));stcn['processRecord'](JSON[_0x98d1('0x5b')](_0x98d1('0x5d')));assert[_0x98d1('0x17')](stcn[_0x98d1('0x5e')][_0x98d1('0x23')],0x2);assert['equal'](stcn[_0x98d1('0x5e')][0x0][_0x98d1('0xb')],0x0);assert[_0x98d1('0x17')](stcn[_0x98d1('0x5e')][0x1]['carno'],0x1);assert[_0x98d1('0x17')](stcn[_0x98d1('0x5e')][0x1]['v'],0x2);});it(_0x98d1('0x5f'),function(){stcn[_0x98d1('0x5a')](JSON[_0x98d1('0x5b')](_0x98d1('0x60')));assert[_0x98d1('0x17')](stcn[_0x98d1('0x5e')][_0x98d1('0x23')],0x3);assert[_0x98d1('0x17')](stcn[_0x98d1('0x5e')][0x2][_0x98d1('0xb')],0x0);});it(_0x98d1('0x61'),function(){assert[_0x98d1('0x1c')](stcn['buffer'][0x1],{'stampm':0x155e9020680,'carno':0x1,'carno|max|21600000':0x1,'carno|max|86400000':0x1,'carno|ma|21600000':0.5,'carno|ma|604800000':0.5,'carno|ma|86400000':0.5,'carno|min|21600000':0x0,'carno|min|86400000':0x0,'carno|variance|21600000':0.5,'carno|variance|86400000':0.5,'v':0x2,'v|max|21600000':0x2,'v|max|86400000':0x2,'v|ma|21600000':1.5,'v|ma|604800000':1.5,'v|ma|86400000':1.5,'v|min|21600000':0x1,'v|min|86400000':0x1,'v|variance|21600000':0.5,'v|variance|86400000':0.5});});it('9\x20more\x20data\x20insertions',function(){for(let _0x3bde12=0x1;_0x3bde12<=0x9;_0x3bde12++){let _0x26986d=0x155e9020a68+_0x3bde12*0x3e8;let _0xe9738f=_0x3bde12+0x1;let _0x587f5c=_0x3bde12+0x2;stcn[_0x98d1('0x5a')](JSON[_0x98d1('0x5b')](_0x98d1('0x62')+_0x26986d+',\x22carno\x22:\x20'+_0xe9738f+_0x98d1('0x63')+_0x587f5c+'}'));}assert['equal'](stcn[_0x98d1('0x5e')]['length'],0xc);assert[_0x98d1('0x1c')](stcn['buffer'][0xb],{'stampm':0x155e9022d90,'carno':0xa,'carno|max|21600000':0xa,'carno|max|86400000':0xa,'carno|ma|21600000':4.583333333333333,'carno|ma|604800000':4.583333333333333,'carno|ma|86400000':4.583333333333333,'carno|min|21600000':0x0,'carno|min|86400000':0x0,'carno|variance|21600000':12.083333333333336,'carno|variance|86400000':12.083333333333336,'v':0xb,'v|max|21600000':0xb,'v|max|86400000':0xb,'v|ma|21600000':5.5,'v|ma|604800000':5.5,'v|ma|86400000':5.5,'v|min|21600000':0x0,'v|min|86400000':0x0,'v|variance|21600000':0xd,'v|variance|86400000':0xd});});it('duplicate\x20insertions\x20test',function(){stcn[_0x98d1('0x5a')](JSON[_0x98d1('0x5b')]('{\x22stampm\x22:\x201468493071000,\x20\x22carno\x22:\x200.0,\x20\x22v\x22:\x201\x20}'));stcn[_0x98d1('0x5a')](JSON['parse'](_0x98d1('0x5d')));assert[_0x98d1('0x17')](stcn[_0x98d1('0x5e')][_0x98d1('0x23')],0xc);});});});