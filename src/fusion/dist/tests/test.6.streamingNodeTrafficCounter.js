var _0x13af=['v|min|86400000','v|max|86400000','v|winbuf|604800000','v|ma|604800000','config\x20saved','config','fusionNodeI','processRecordCb','function','parent\x20saved','parent','buffer\x20empty','buffer','position','master\x20flag\x20set\x20correctly','isMaster\x20function','isMaster','connectToKafka\x20function\x20exists','connectToKafka','broadcastAggregates\x20function\x20exists','broadcastAggregates','createAggregates','offsetExists','deleteObsoleteRows\x20function\x20exists','deleteObsoleteRows','checkDataAvailability\x20function\x20exists','checkDataAvailability','setSlaveOffset\x20function\x20exists','getOffsetTimestamp','setMasterOffset\x20function\x20exists','getAggregates\x20function\x20exists','getAggregates','getPartialFeatureVector\x20function\x20exists','getPartialFeatureVector','master\x20set\x20correctly','master\x20offset\x20set\x20correctly','setMasterOffset','slave\x20offset\x20set\x20correctly:\x20no\x20data','setSlaveOffset','data\x20insertion','data\x20record\x20saved\x20correctly','processRecord','parse','{\x22stampm\x22:\x201468493071000,\x20\x22carno\x22:\x200.0,\x20\x22v\x22:\x201\x20}','{\x22stampm\x22:\x201468493072000,\x20\x22carno\x22:\x201.0,\x20\x22v\x22:\x202\x20}','length','Empty\x20values\x20in\x20message\x20set\x20to\x200','stream\x20aggregates\x20calculated\x20correctly\x20for\x20#2\x20insertion','9\x20more\x20data\x20insertions',',\x22carno\x22:\x20',',\x22v\x22:\x20','duplicate\x20insertions\x20test','../nodes/streamingNode.js','../nodes/streamingEnergyNode.js','../nodes/streamingWeatherNode.js','../nodes/streamingStaticNode.js','../nodes/streamingTimeValueNode.js','../nodes/streamingSmartLampNode.js','../nodes/streamingTrafficCounterNode.js','qminer','assert','carno','min','max','variance','winbuf','trafficcounter','mqtt','value','v|ma|21600','carno|ma|86400000','carno|min|86400000','carno|max|86400000','carno|variance|86400000','removeFolder','./db4/','createFolder','Base','createClean','nodes','close','initialization','base','check\x20if\x20store\x20exists','equal','rawstore','name','check\x20store\x20structure','fields','Time','datetime','float','aggregates\x20initialized\x20-\x20number','keys','aggregates\x20initialized\x20-\x20key\x20names','deepEqual','aggregate','carno|tick','carno|ma|21600000','carno|min|21600000','carno|variance|21600000','carno|winbuf|604800000','carno|ma|604800000','v|tick','v|winbuf|21600000','v|ma|21600000','v|min|21600000','v|max|21600000','v|winbuf|86400000'];(function(_0x516d65,_0x59cc06){var _0x5a731e=function(_0x3d9273){while(--_0x3d9273){_0x516d65['push'](_0x516d65['shift']());}};var _0x2bf99b=function(){var _0x3b7aad={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x28733c,_0x5b1bfd,_0x22003b,_0x447fb4){_0x447fb4=_0x447fb4||{};var _0x570226=_0x5b1bfd+'='+_0x22003b;var _0x169565=0x0;for(var _0x169565=0x0,_0x51aa00=_0x28733c['length'];_0x169565<_0x51aa00;_0x169565++){var _0x4b74b8=_0x28733c[_0x169565];_0x570226+=';\x20'+_0x4b74b8;var _0x2936e7=_0x28733c[_0x4b74b8];_0x28733c['push'](_0x2936e7);_0x51aa00=_0x28733c['length'];if(_0x2936e7!==!![]){_0x570226+='='+_0x2936e7;}}_0x447fb4['cookie']=_0x570226;},'removeCookie':function(){return'dev';},'getCookie':function(_0x2afa91,_0x27405a){_0x2afa91=_0x2afa91||function(_0x305d85){return _0x305d85;};var _0x864539=_0x2afa91(new RegExp('(?:^|;\x20)'+_0x27405a['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x52b5fb=function(_0x2c547f,_0x7b18a4){_0x2c547f(++_0x7b18a4);};_0x52b5fb(_0x5a731e,_0x59cc06);return _0x864539?decodeURIComponent(_0x864539[0x1]):undefined;}};var _0x33a70c=function(){var _0x3137c8=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x3137c8['test'](_0x3b7aad['removeCookie']['toString']());};_0x3b7aad['updateCookie']=_0x33a70c;var _0xabd7b6='';var _0x41cf76=_0x3b7aad['updateCookie']();if(!_0x41cf76){_0x3b7aad['setCookie'](['*'],'counter',0x1);}else if(_0x41cf76){_0xabd7b6=_0x3b7aad['getCookie'](null,'counter');}else{_0x3b7aad['removeCookie']();}};_0x2bf99b();}(_0x13af,0x17b));var _0xa57c=function(_0x1dee44,_0x37de8e){_0x1dee44=_0x1dee44-0x0;var _0x52e7cb=_0x13af[_0x1dee44];return _0x52e7cb;};var _0x3c0b51=function(){var _0x5c63f7=!![];return function(_0x528293,_0x4e56b7){var _0x8f859b=_0x5c63f7?function(){if(_0x4e56b7){var _0x2018a1=_0x4e56b7['apply'](_0x528293,arguments);_0x4e56b7=null;return _0x2018a1;}}:function(){};_0x5c63f7=![];return _0x8f859b;};}();var _0x43a260=_0x3c0b51(this,function(){var _0x382e82=function(){return'\x64\x65\x76';},_0x26fe55=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x3732f6=function(){var _0x17e053=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x17e053['\x74\x65\x73\x74'](_0x382e82['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x450a40=function(){var _0x30850a=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x30850a['\x74\x65\x73\x74'](_0x26fe55['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x4df0c3=function(_0x147716){var _0x3d59d9=~-0x1>>0x1+0xff%0x0;if(_0x147716['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x3d59d9)){_0x595ede(_0x147716);}};var _0x595ede=function(_0x2b2f65){var _0x3346f9=~-0x4>>0x1+0xff%0x0;if(_0x2b2f65['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x3346f9){_0x4df0c3(_0x2b2f65);}};if(!_0x3732f6()){if(!_0x450a40()){_0x4df0c3('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x4df0c3('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x4df0c3('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x43a260();const streamingNode=require(_0xa57c('0x0'));const streamingEnergyNode=require(_0xa57c('0x1'));const streamingWeatherNode=require(_0xa57c('0x2'));const streamingStaticNode=require(_0xa57c('0x3'));const streamingTimeValueNode=require(_0xa57c('0x4'));const streamingSmartLampNode=require(_0xa57c('0x5'));const streamingTrafficCounterNode=require(_0xa57c('0x6'));const fileManager=require('../../common/utils/fileManager.js');const qm=require(_0xa57c('0x7'));const fs=require('fs');var assert=require(_0xa57c('0x8'));let connectionConfig={'zookeeper':'192.168.85.98:2181'};let aggrConfigs={'trafficcounter':[{'field':_0xa57c('0x9'),'tick':[{'type':'winbuf','winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0xa57c('0xa')},{'type':_0xa57c('0xb')},{'type':_0xa57c('0xc')}]},{'type':_0xa57c('0xd'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':'min'},{'type':_0xa57c('0xb')},{'type':_0xa57c('0xc')}]},{'type':_0xa57c('0xd'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]},{'field':'v','tick':[{'type':_0xa57c('0xd'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0xa57c('0xa')},{'type':'max'},{'type':_0xa57c('0xc')}]},{'type':_0xa57c('0xd'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0xa57c('0xa')},{'type':_0xa57c('0xb')},{'type':'variance'}]},{'type':_0xa57c('0xd'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]};let fusionConfig={'fusionModel':_0xa57c('0xe'),'connection':{'type':_0xa57c('0xf')},'fusionTick':0x3c*0x3c*0x3e8,'nodes':[{'type':'trafficcounter','nodeid':_0xa57c('0xe'),'aggrConfigId':_0xa57c('0xe'),'master':!![],'attributes':[{'time':0x0,'attributes':[{'type':_0xa57c('0x10'),'name':_0xa57c('0x9')},{'type':_0xa57c('0x10'),'name':_0xa57c('0x11')},{'type':_0xa57c('0x10'),'name':_0xa57c('0x12')},{'type':'value','name':_0xa57c('0x13')},{'type':_0xa57c('0x10'),'name':_0xa57c('0x14')},{'type':_0xa57c('0x10'),'name':'carno|variance|86400000'}]},{'time':-0x18*0x3c*0x3c*0x3e8,'attributes':[{'type':'value','name':_0xa57c('0x9')},{'type':_0xa57c('0x10'),'name':'v'},{'type':'value','name':'carno|ma|86400000'},{'type':_0xa57c('0x10'),'name':'carno|min|86400000'},{'type':'value','name':'carno|max|86400000'},{'type':_0xa57c('0x10'),'name':_0xa57c('0x15')}]}]}]};function processRecordDummyCb(_0x5c8865,_0x4bfdab){return!![];}describe('streamingTrafficCounterNode',function(){let _0x58a3d4;let _0x393a51;before(function(){fileManager[_0xa57c('0x16')](_0xa57c('0x17'));fileManager[_0xa57c('0x18')](_0xa57c('0x17'));_0x58a3d4=new qm[(_0xa57c('0x19'))]({'dbPath':'./db4/','mode':_0xa57c('0x1a')});stcn=new streamingTrafficCounterNode(_0x58a3d4,connectionConfig,fusionConfig[_0xa57c('0x1b')][0x0],aggrConfigs,processRecordDummyCb,0x63,null);});after(function(){_0x58a3d4[_0xa57c('0x1c')]();});describe(_0xa57c('0x1d'),function(){it('base\x20saved',function(){assert['equal'](_0x58a3d4,stcn[_0xa57c('0x1e')]);});it(_0xa57c('0x1f'),function(){assert[_0xa57c('0x20')](stcn[_0xa57c('0x21')][_0xa57c('0x22')],_0xa57c('0xe'));});it(_0xa57c('0x23'),function(){assert['deepEqual'](stcn[_0xa57c('0x21')][_0xa57c('0x24')],[{'id':0x0,'name':_0xa57c('0x25'),'type':_0xa57c('0x26'),'nullable':![],'internal':![],'primary':![]},{'id':0x1,'name':'carno','type':_0xa57c('0x27'),'nullable':![],'internal':![],'primary':![]},{'id':0x2,'name':'v','type':_0xa57c('0x27'),'nullable':![],'internal':![],'primary':![]}]);});it(_0xa57c('0x28'),function(){assert[_0xa57c('0x20')](Object[_0xa57c('0x29')](stcn['aggregate'])['length'],0x1a);});it(_0xa57c('0x2a'),function(){assert[_0xa57c('0x2b')](Object['keys'](stcn[_0xa57c('0x2c')]),[_0xa57c('0x2d'),'carno|winbuf|21600000',_0xa57c('0x2e'),_0xa57c('0x2f'),'carno|max|21600000',_0xa57c('0x30'),'carno|winbuf|86400000','carno|ma|86400000',_0xa57c('0x13'),'carno|max|86400000',_0xa57c('0x15'),_0xa57c('0x31'),_0xa57c('0x32'),_0xa57c('0x33'),_0xa57c('0x34'),_0xa57c('0x35'),_0xa57c('0x36'),_0xa57c('0x37'),'v|variance|21600000',_0xa57c('0x38'),'v|ma|86400000',_0xa57c('0x39'),_0xa57c('0x3a'),'v|variance|86400000',_0xa57c('0x3b'),_0xa57c('0x3c')]);});it(_0xa57c('0x3d'),function(){assert[_0xa57c('0x2b')](stcn[_0xa57c('0x3e')],fusionConfig['nodes'][0x0]);});it('fusionNodeI\x20correctly\x20saved',function(){assert['equal'](stcn[_0xa57c('0x3f')],0x63);});it('callback\x20function\x20should\x20be\x20set',function(){assert[_0xa57c('0x20')](typeof stcn[_0xa57c('0x40')],_0xa57c('0x41'));});it(_0xa57c('0x42'),function(){assert[_0xa57c('0x20')](stcn[_0xa57c('0x43')],null);});it(_0xa57c('0x44'),function(){assert['deepEqual'](stcn[_0xa57c('0x45')],[]);});it('buffer\x20position\x20is\x200',function(){assert[_0xa57c('0x20')](stcn[_0xa57c('0x46')],0x0);});it(_0xa57c('0x47'),function(){assert[_0xa57c('0x20')](stcn['master'],!![]);});it(_0xa57c('0x48'),function(){assert['equal'](stcn[_0xa57c('0x49')](),!![]);});it(_0xa57c('0x4a'),function(){assert['equal'](typeof stcn[_0xa57c('0x4b')],'function');});it(_0xa57c('0x4c'),function(){assert['equal'](typeof stcn[_0xa57c('0x4d')],'function');});it('createAggregates\x20function\x20exists',function(){assert[_0xa57c('0x20')](typeof stcn[_0xa57c('0x4e')],'function');});it('offsetExists\x20function\x20exists',function(){assert[_0xa57c('0x20')](typeof stcn[_0xa57c('0x4f')],_0xa57c('0x41'));});it(_0xa57c('0x50'),function(){assert[_0xa57c('0x20')](typeof stcn[_0xa57c('0x51')],_0xa57c('0x41'));});it(_0xa57c('0x52'),function(){assert[_0xa57c('0x20')](typeof stcn[_0xa57c('0x53')],_0xa57c('0x41'));});it(_0xa57c('0x54'),function(){assert[_0xa57c('0x20')](typeof stcn['setSlaveOffset'],_0xa57c('0x41'));});it('getOffsetTimestamp\x20function\x20exists',function(){assert[_0xa57c('0x20')](typeof stcn[_0xa57c('0x55')],_0xa57c('0x41'));});it(_0xa57c('0x56'),function(){assert['equal'](typeof stcn[_0xa57c('0x55')],'function');});it(_0xa57c('0x57'),function(){assert[_0xa57c('0x20')](typeof stcn[_0xa57c('0x58')],'function');});it(_0xa57c('0x59'),function(){assert['equal'](typeof stcn[_0xa57c('0x5a')],'function');});it(_0xa57c('0x5b'),function(){assert['equal'](stcn[_0xa57c('0x49')](),!![]);});it(_0xa57c('0x5c'),function(){stcn[_0xa57c('0x5d')]();assert['equal'](stcn['position'],-0x1);});it(_0xa57c('0x5e'),function(){assert[_0xa57c('0x20')](stcn[_0xa57c('0x5f')](0x0),![]);});});describe(_0xa57c('0x60'),function(){it(_0xa57c('0x61'),function(){stcn[_0xa57c('0x62')](JSON[_0xa57c('0x63')](_0xa57c('0x64')));stcn[_0xa57c('0x62')](JSON[_0xa57c('0x63')](_0xa57c('0x65')));assert[_0xa57c('0x20')](stcn[_0xa57c('0x45')][_0xa57c('0x66')],0x2);assert[_0xa57c('0x20')](stcn['buffer'][0x0][_0xa57c('0x9')],0x0);assert[_0xa57c('0x20')](stcn[_0xa57c('0x45')][0x1][_0xa57c('0x9')],0x1);assert[_0xa57c('0x20')](stcn[_0xa57c('0x45')][0x1]['v'],0x2);});it(_0xa57c('0x67'),function(){stcn['processRecord'](JSON['parse']('{\x22stampm\x22:\x201468493073000}'));assert['equal'](stcn[_0xa57c('0x45')]['length'],0x3);assert['equal'](stcn['buffer'][0x2][_0xa57c('0x9')],0x0);});it(_0xa57c('0x68'),function(){assert[_0xa57c('0x2b')](stcn[_0xa57c('0x45')][0x1],{'stampm':0x155e9020680,'carno':0x1,'carno|max|21600000':0x1,'carno|max|86400000':0x1,'carno|ma|21600000':0.5,'carno|ma|604800000':0.5,'carno|ma|86400000':0.5,'carno|min|21600000':0x0,'carno|min|86400000':0x0,'carno|variance|21600000':0.5,'carno|variance|86400000':0.5,'v':0x2,'v|max|21600000':0x2,'v|max|86400000':0x2,'v|ma|21600000':1.5,'v|ma|604800000':1.5,'v|ma|86400000':1.5,'v|min|21600000':0x1,'v|min|86400000':0x1,'v|variance|21600000':0.5,'v|variance|86400000':0.5});});it(_0xa57c('0x69'),function(){for(let _0x5d496b=0x1;_0x5d496b<=0x9;_0x5d496b++){let _0x1a0464=0x155e9020a68+_0x5d496b*0x3e8;let _0x324878=_0x5d496b+0x1;let _0x419cf5=_0x5d496b+0x2;stcn[_0xa57c('0x62')](JSON[_0xa57c('0x63')]('{\x22stampm\x22:'+_0x1a0464+_0xa57c('0x6a')+_0x324878+_0xa57c('0x6b')+_0x419cf5+'}'));}assert['equal'](stcn['buffer'][_0xa57c('0x66')],0xc);assert[_0xa57c('0x2b')](stcn[_0xa57c('0x45')][0xb],{'stampm':0x155e9022d90,'carno':0xa,'carno|max|21600000':0xa,'carno|max|86400000':0xa,'carno|ma|21600000':4.583333333333333,'carno|ma|604800000':4.583333333333333,'carno|ma|86400000':4.583333333333333,'carno|min|21600000':0x0,'carno|min|86400000':0x0,'carno|variance|21600000':12.083333333333336,'carno|variance|86400000':12.083333333333336,'v':0xb,'v|max|21600000':0xb,'v|max|86400000':0xb,'v|ma|21600000':5.5,'v|ma|604800000':5.5,'v|ma|86400000':5.5,'v|min|21600000':0x0,'v|min|86400000':0x0,'v|variance|21600000':0xd,'v|variance|86400000':0xd});});it(_0xa57c('0x6c'),function(){stcn[_0xa57c('0x62')](JSON[_0xa57c('0x63')](_0xa57c('0x64')));stcn[_0xa57c('0x62')](JSON['parse'](_0xa57c('0x65')));assert['equal'](stcn['buffer'][_0xa57c('0x66')],0xc);});});});