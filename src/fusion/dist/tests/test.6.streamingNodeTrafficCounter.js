var _0x269e=['createAggregates\x20function\x20exists','createAggregates','offsetExists\x20function\x20exists','offsetExists','deleteObsoleteRows\x20function\x20exists','deleteObsoleteRows','checkDataAvailability\x20function\x20exists','checkDataAvailability','setSlaveOffset','getOffsetTimestamp\x20function\x20exists','getOffsetTimestamp','setMasterOffset\x20function\x20exists','getAggregates\x20function\x20exists','getPartialFeatureVector\x20function\x20exists','master\x20set\x20correctly','setMasterOffset','slave\x20offset\x20set\x20correctly:\x20no\x20data','data\x20insertion','data\x20record\x20saved\x20correctly','processRecord','parse','{\x22stampm\x22:\x201468493071000,\x20\x22carno\x22:\x200.0,\x20\x22v\x22:\x201\x20}','{\x22stampm\x22:\x201468493072000,\x20\x22carno\x22:\x201.0,\x20\x22v\x22:\x202\x20}','Empty\x20values\x20in\x20message\x20set\x20to\x200','9\x20more\x20data\x20insertions','duplicate\x20insertions\x20test','../nodes/streamingNode.js','../nodes/streamingEnergyNode.js','../nodes/streamingWeatherNode.js','../nodes/streamingStaticNode.js','../nodes/streamingTimeValueNode.js','../nodes/streamingSmartLampNode.js','../common/utils/fileManager.js','qminer','assert','192.168.85.98:2181','carno','min','max','variance','winbuf','trafficcounter','mqtt','value','carno|ma|86400000','carno|min|86400000','carno|max|86400000','carno|variance|86400000','streamingTrafficCounterNode','removeFolder','./db4/','createClean','nodes','close','base\x20saved','equal','base','check\x20if\x20store\x20exists','rawstore','name','check\x20store\x20structure','deepEqual','Time','datetime','float','aggregates\x20initialized\x20-\x20number','keys','aggregate','length','aggregates\x20initialized\x20-\x20key\x20names','carno|tick','carno|winbuf|21600000','carno|ma|21600000','carno|ma|604800000','v|tick','v|winbuf|21600000','v|ma|21600000','v|min|21600000','v|variance|21600000','v|winbuf|86400000','v|ma|86400000','v|min|86400000','v|ma|604800000','fusionNodeI\x20correctly\x20saved','fusionNodeI','callback\x20function\x20should\x20be\x20set','parent\x20saved','buffer','position','master\x20flag\x20set\x20correctly','master','isMaster\x20function','connectToKafka\x20function\x20exists','function','broadcastAggregates'];(function(_0x51cb98,_0x5b7033){var _0x4f8d14=function(_0x59c902){while(--_0x59c902){_0x51cb98['push'](_0x51cb98['shift']());}};var _0x13b738=function(){var _0x3ce0cb={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x4de24d,_0x4051ce,_0x1a38a4,_0x66cbe5){_0x66cbe5=_0x66cbe5||{};var _0x2a366b=_0x4051ce+'='+_0x1a38a4;var _0x310f72=0x0;for(var _0x310f72=0x0,_0x2e52e0=_0x4de24d['length'];_0x310f72<_0x2e52e0;_0x310f72++){var _0x556238=_0x4de24d[_0x310f72];_0x2a366b+=';\x20'+_0x556238;var _0x20d57c=_0x4de24d[_0x556238];_0x4de24d['push'](_0x20d57c);_0x2e52e0=_0x4de24d['length'];if(_0x20d57c!==!![]){_0x2a366b+='='+_0x20d57c;}}_0x66cbe5['cookie']=_0x2a366b;},'removeCookie':function(){return'dev';},'getCookie':function(_0x22d724,_0xd2b669){_0x22d724=_0x22d724||function(_0x488fcf){return _0x488fcf;};var _0x1d4dde=_0x22d724(new RegExp('(?:^|;\x20)'+_0xd2b669['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x156da2=function(_0x34582e,_0x5d5bee){_0x34582e(++_0x5d5bee);};_0x156da2(_0x4f8d14,_0x5b7033);return _0x1d4dde?decodeURIComponent(_0x1d4dde[0x1]):undefined;}};var _0x16542e=function(){var _0x10e046=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x10e046['test'](_0x3ce0cb['removeCookie']['toString']());};_0x3ce0cb['updateCookie']=_0x16542e;var _0x343809='';var _0x154531=_0x3ce0cb['updateCookie']();if(!_0x154531){_0x3ce0cb['setCookie'](['*'],'counter',0x1);}else if(_0x154531){_0x343809=_0x3ce0cb['getCookie'](null,'counter');}else{_0x3ce0cb['removeCookie']();}};_0x13b738();}(_0x269e,0x196));var _0x1c0f=function(_0x27201d,_0x5b0344){_0x27201d=_0x27201d-0x0;var _0x3b14fa=_0x269e[_0x27201d];return _0x3b14fa;};var _0x10a882=function(){var _0x1dc401=!![];return function(_0x124fe1,_0x46c334){var _0xd3f5ba=_0x1dc401?function(){if(_0x46c334){var _0x9006c1=_0x46c334['apply'](_0x124fe1,arguments);_0x46c334=null;return _0x9006c1;}}:function(){};_0x1dc401=![];return _0xd3f5ba;};}();var _0x20c73b=_0x10a882(this,function(){var _0x2d8f05=function(){return'\x64\x65\x76';},_0x4b81bb=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x34a12b=function(){var _0x36c6a6=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x36c6a6['\x74\x65\x73\x74'](_0x2d8f05['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x33748d=function(){var _0x3e4c21=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x3e4c21['\x74\x65\x73\x74'](_0x4b81bb['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x5c685e=function(_0x3e3156){var _0x1e9e81=~-0x1>>0x1+0xff%0x0;if(_0x3e3156['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x1e9e81)){_0x292610(_0x3e3156);}};var _0x292610=function(_0x151bd2){var _0x558098=~-0x4>>0x1+0xff%0x0;if(_0x151bd2['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x558098){_0x5c685e(_0x151bd2);}};if(!_0x34a12b()){if(!_0x33748d()){_0x5c685e('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x5c685e('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x5c685e('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x20c73b();const streamingNode=require(_0x1c0f('0x0'));const streamingEnergyNode=require(_0x1c0f('0x1'));const streamingWeatherNode=require(_0x1c0f('0x2'));const streamingStaticNode=require(_0x1c0f('0x3'));const streamingTimeValueNode=require(_0x1c0f('0x4'));const streamingSmartLampNode=require(_0x1c0f('0x5'));const streamingTrafficCounterNode=require('../nodes/streamingTrafficCounterNode.js');const fileManager=require(_0x1c0f('0x6'));const qm=require(_0x1c0f('0x7'));const fs=require('fs');var assert=require(_0x1c0f('0x8'));let connectionConfig={'zookeeper':_0x1c0f('0x9')};let aggrConfigs={'trafficcounter':[{'field':_0x1c0f('0xa'),'tick':[{'type':'winbuf','winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x1c0f('0xb')},{'type':_0x1c0f('0xc')},{'type':_0x1c0f('0xd')}]},{'type':'winbuf','winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x1c0f('0xb')},{'type':'max'},{'type':_0x1c0f('0xd')}]},{'type':_0x1c0f('0xe'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]},{'field':'v','tick':[{'type':_0x1c0f('0xe'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x1c0f('0xb')},{'type':'max'},{'type':_0x1c0f('0xd')}]},{'type':_0x1c0f('0xe'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x1c0f('0xb')},{'type':_0x1c0f('0xc')},{'type':'variance'}]},{'type':'winbuf','winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]};let fusionConfig={'fusionModel':_0x1c0f('0xf'),'connection':{'type':_0x1c0f('0x10')},'fusionTick':0x3c*0x3c*0x3e8,'nodes':[{'type':_0x1c0f('0xf'),'nodeid':_0x1c0f('0xf'),'aggrConfigId':_0x1c0f('0xf'),'master':!![],'attributes':[{'time':0x0,'attributes':[{'type':'value','name':_0x1c0f('0xa')},{'type':_0x1c0f('0x11'),'name':'v|ma|21600'},{'type':_0x1c0f('0x11'),'name':_0x1c0f('0x12')},{'type':_0x1c0f('0x11'),'name':_0x1c0f('0x13')},{'type':_0x1c0f('0x11'),'name':'carno|max|86400000'},{'type':_0x1c0f('0x11'),'name':'carno|variance|86400000'}]},{'time':-0x18*0x3c*0x3c*0x3e8,'attributes':[{'type':_0x1c0f('0x11'),'name':_0x1c0f('0xa')},{'type':_0x1c0f('0x11'),'name':'v'},{'type':_0x1c0f('0x11'),'name':_0x1c0f('0x12')},{'type':_0x1c0f('0x11'),'name':_0x1c0f('0x13')},{'type':_0x1c0f('0x11'),'name':_0x1c0f('0x14')},{'type':_0x1c0f('0x11'),'name':_0x1c0f('0x15')}]}]}]};function processRecordDummyCb(_0x50e25c,_0xb2ee21){return!![];}describe(_0x1c0f('0x16'),function(){let _0x4dfe3b;let _0x5cbb01;before(function(){fileManager[_0x1c0f('0x17')]('./db4/');fileManager['createFolder'](_0x1c0f('0x18'));_0x4dfe3b=new qm['Base']({'dbPath':_0x1c0f('0x18'),'mode':_0x1c0f('0x19')});stcn=new streamingTrafficCounterNode(_0x4dfe3b,connectionConfig,fusionConfig[_0x1c0f('0x1a')][0x0],aggrConfigs,processRecordDummyCb,0x63,null);});after(function(){_0x4dfe3b[_0x1c0f('0x1b')]();});describe('initialization',function(){it(_0x1c0f('0x1c'),function(){assert[_0x1c0f('0x1d')](_0x4dfe3b,stcn[_0x1c0f('0x1e')]);});it(_0x1c0f('0x1f'),function(){assert[_0x1c0f('0x1d')](stcn[_0x1c0f('0x20')][_0x1c0f('0x21')],_0x1c0f('0xf'));});it(_0x1c0f('0x22'),function(){assert[_0x1c0f('0x23')](stcn[_0x1c0f('0x20')]['fields'],[{'id':0x0,'name':_0x1c0f('0x24'),'type':_0x1c0f('0x25'),'nullable':![],'internal':![],'primary':![]},{'id':0x1,'name':_0x1c0f('0xa'),'type':_0x1c0f('0x26'),'nullable':![],'internal':![],'primary':![]},{'id':0x2,'name':'v','type':_0x1c0f('0x26'),'nullable':![],'internal':![],'primary':![]}]);});it(_0x1c0f('0x27'),function(){assert[_0x1c0f('0x1d')](Object[_0x1c0f('0x28')](stcn[_0x1c0f('0x29')])[_0x1c0f('0x2a')],0x1a);});it(_0x1c0f('0x2b'),function(){assert[_0x1c0f('0x23')](Object[_0x1c0f('0x28')](stcn[_0x1c0f('0x29')]),[_0x1c0f('0x2c'),_0x1c0f('0x2d'),_0x1c0f('0x2e'),'carno|min|21600000','carno|max|21600000','carno|variance|21600000','carno|winbuf|86400000',_0x1c0f('0x12'),_0x1c0f('0x13'),_0x1c0f('0x14'),_0x1c0f('0x15'),'carno|winbuf|604800000',_0x1c0f('0x2f'),_0x1c0f('0x30'),_0x1c0f('0x31'),_0x1c0f('0x32'),_0x1c0f('0x33'),'v|max|21600000',_0x1c0f('0x34'),_0x1c0f('0x35'),_0x1c0f('0x36'),_0x1c0f('0x37'),'v|max|86400000','v|variance|86400000','v|winbuf|604800000',_0x1c0f('0x38')]);});it('config\x20saved',function(){assert[_0x1c0f('0x23')](stcn['config'],fusionConfig['nodes'][0x0]);});it(_0x1c0f('0x39'),function(){assert['equal'](stcn[_0x1c0f('0x3a')],0x63);});it(_0x1c0f('0x3b'),function(){assert[_0x1c0f('0x1d')](typeof stcn['processRecordCb'],'function');});it(_0x1c0f('0x3c'),function(){assert[_0x1c0f('0x1d')](stcn['parent'],null);});it('buffer\x20empty',function(){assert[_0x1c0f('0x23')](stcn[_0x1c0f('0x3d')],[]);});it('buffer\x20position\x20is\x200',function(){assert[_0x1c0f('0x1d')](stcn[_0x1c0f('0x3e')],0x0);});it(_0x1c0f('0x3f'),function(){assert[_0x1c0f('0x1d')](stcn[_0x1c0f('0x40')],!![]);});it(_0x1c0f('0x41'),function(){assert[_0x1c0f('0x1d')](stcn['isMaster'](),!![]);});it(_0x1c0f('0x42'),function(){assert[_0x1c0f('0x1d')](typeof stcn['connectToKafka'],_0x1c0f('0x43'));});it('broadcastAggregates\x20function\x20exists',function(){assert['equal'](typeof stcn[_0x1c0f('0x44')],'function');});it(_0x1c0f('0x45'),function(){assert[_0x1c0f('0x1d')](typeof stcn[_0x1c0f('0x46')],_0x1c0f('0x43'));});it(_0x1c0f('0x47'),function(){assert[_0x1c0f('0x1d')](typeof stcn[_0x1c0f('0x48')],_0x1c0f('0x43'));});it(_0x1c0f('0x49'),function(){assert[_0x1c0f('0x1d')](typeof stcn[_0x1c0f('0x4a')],'function');});it(_0x1c0f('0x4b'),function(){assert[_0x1c0f('0x1d')](typeof stcn[_0x1c0f('0x4c')],_0x1c0f('0x43'));});it('setSlaveOffset\x20function\x20exists',function(){assert[_0x1c0f('0x1d')](typeof stcn[_0x1c0f('0x4d')],_0x1c0f('0x43'));});it(_0x1c0f('0x4e'),function(){assert[_0x1c0f('0x1d')](typeof stcn[_0x1c0f('0x4f')],'function');});it(_0x1c0f('0x50'),function(){assert[_0x1c0f('0x1d')](typeof stcn[_0x1c0f('0x4f')],'function');});it(_0x1c0f('0x51'),function(){assert[_0x1c0f('0x1d')](typeof stcn['getAggregates'],_0x1c0f('0x43'));});it(_0x1c0f('0x52'),function(){assert['equal'](typeof stcn['getPartialFeatureVector'],'function');});it(_0x1c0f('0x53'),function(){assert[_0x1c0f('0x1d')](stcn['isMaster'](),!![]);});it('master\x20offset\x20set\x20correctly',function(){stcn[_0x1c0f('0x54')]();assert['equal'](stcn[_0x1c0f('0x3e')],-0x1);});it(_0x1c0f('0x55'),function(){assert[_0x1c0f('0x1d')](stcn[_0x1c0f('0x4d')](0x0),![]);});});describe(_0x1c0f('0x56'),function(){it(_0x1c0f('0x57'),function(){stcn[_0x1c0f('0x58')](JSON[_0x1c0f('0x59')](_0x1c0f('0x5a')));stcn[_0x1c0f('0x58')](JSON['parse'](_0x1c0f('0x5b')));assert[_0x1c0f('0x1d')](stcn[_0x1c0f('0x3d')][_0x1c0f('0x2a')],0x2);assert[_0x1c0f('0x1d')](stcn[_0x1c0f('0x3d')][0x0][_0x1c0f('0xa')],0x0);assert['equal'](stcn[_0x1c0f('0x3d')][0x1][_0x1c0f('0xa')],0x1);assert[_0x1c0f('0x1d')](stcn[_0x1c0f('0x3d')][0x1]['v'],0x2);});it(_0x1c0f('0x5c'),function(){stcn[_0x1c0f('0x58')](JSON['parse']('{\x22stampm\x22:\x201468493073000}'));assert[_0x1c0f('0x1d')](stcn[_0x1c0f('0x3d')][_0x1c0f('0x2a')],0x3);assert['equal'](stcn[_0x1c0f('0x3d')][0x2]['carno'],0x0);});it('stream\x20aggregates\x20calculated\x20correctly\x20for\x20#2\x20insertion',function(){assert[_0x1c0f('0x23')](stcn[_0x1c0f('0x3d')][0x1],{'stampm':0x155e9020680,'carno':0x1,'carno|max|21600000':0x1,'carno|max|86400000':0x1,'carno|ma|21600000':0.5,'carno|ma|604800000':0.5,'carno|ma|86400000':0.5,'carno|min|21600000':0x0,'carno|min|86400000':0x0,'carno|variance|21600000':0.5,'carno|variance|86400000':0.5,'v':0x2,'v|max|21600000':0x2,'v|max|86400000':0x2,'v|ma|21600000':1.5,'v|ma|604800000':1.5,'v|ma|86400000':1.5,'v|min|21600000':0x1,'v|min|86400000':0x1,'v|variance|21600000':0.5,'v|variance|86400000':0.5});});it(_0x1c0f('0x5d'),function(){for(let _0x545948=0x1;_0x545948<=0x9;_0x545948++){let _0x509584=0x155e9020a68+_0x545948*0x3e8;let _0x52d43b=_0x545948+0x1;let _0x3f2b7b=_0x545948+0x2;stcn['processRecord'](JSON[_0x1c0f('0x59')]('{\x22stampm\x22:'+_0x509584+',\x22carno\x22:\x20'+_0x52d43b+',\x22v\x22:\x20'+_0x3f2b7b+'}'));}assert[_0x1c0f('0x1d')](stcn[_0x1c0f('0x3d')][_0x1c0f('0x2a')],0xc);assert[_0x1c0f('0x23')](stcn['buffer'][0xb],{'stampm':0x155e9022d90,'carno':0xa,'carno|max|21600000':0xa,'carno|max|86400000':0xa,'carno|ma|21600000':4.583333333333333,'carno|ma|604800000':4.583333333333333,'carno|ma|86400000':4.583333333333333,'carno|min|21600000':0x0,'carno|min|86400000':0x0,'carno|variance|21600000':12.083333333333336,'carno|variance|86400000':12.083333333333336,'v':0xb,'v|max|21600000':0xb,'v|max|86400000':0xb,'v|ma|21600000':5.5,'v|ma|604800000':5.5,'v|ma|86400000':5.5,'v|min|21600000':0x0,'v|min|86400000':0x0,'v|variance|21600000':0xd,'v|variance|86400000':0xd});});it(_0x1c0f('0x5e'),function(){stcn[_0x1c0f('0x58')](JSON[_0x1c0f('0x59')](_0x1c0f('0x5a')));stcn[_0x1c0f('0x58')](JSON[_0x1c0f('0x59')]('{\x22stampm\x22:\x201468493072000,\x20\x22carno\x22:\x201.0,\x20\x22v\x22:\x202\x20}'));assert[_0x1c0f('0x1d')](stcn[_0x1c0f('0x3d')][_0x1c0f('0x2a')],0xc);});});});