var _0x5a0e=['createClean','nodes','close','initialization','equal','base','check\x20if\x20store\x20exists','rawstore','name','check\x20store\x20structure','deepEqual','fields','Time','datetime','float','dayOfMonth','holiday','weekEnd','length','aggregates\x20initialized\x20-\x20key\x20names','keys','holiday|tick','holiday|winbuf|604800000','holiday|ma|604800000','config\x20saved','config','fusionNodeI\x20correctly\x20saved','fusionNodeI','callback\x20function\x20should\x20be\x20set','processRecordCb','buffer','buffer\x20position\x20is\x200','position','master\x20flag\x20set\x20correctly','master','isMaster\x20function','isMaster','connectToKafka\x20function\x20exists','function','broadcastAggregates\x20function\x20exists','broadcastAggregates','createAggregates\x20function\x20exists','createAggregates','offsetExists\x20function\x20exists','offsetExists','deleteObsoleteRows\x20function\x20exists','deleteObsoleteRows','checkDataAvailability\x20function\x20exists','setSlaveOffset','getOffsetTimestamp\x20function\x20exists','getOffsetTimestamp','getAggregates','getPartialFeatureVector\x20function\x20exists','getPartialFeatureVector','master\x20offset\x20set\x20correctly','data\x20insertion','data\x20record\x20record\x20saved\x20correctly','processRecord','parse','{\x22timestamp\x22:0,\x20\x22timeOfDay\x22:\x200,\x20\x22dayAfterHoliday\x22:\x200,\x20\x22dayBeforeHoliday\x22:\x201,\x20\x22dayOfYear\x22:\x201,\x20\x22dayOfWeek\x22:\x202,\x20\x22dayOfMonth\x22:\x201,\x20\x22holiday\x22:\x201,\x20\x22monthOfYear\x22:\x201,\x20\x22weekEnd\x22:\x200\x20}','timeOfDay','timestamp','floor','correct\x20aggregate\x20values','coorect\x20partial\x20feature\x20vector','../nodes/streamingNode.js','../nodes/streamingEnergyNode.js','../nodes/streamingWeatherNode.js','../nodes/streamingStaticNode.js','../../common/utils/fileManager.js','winbuf','variance','min','max','none','test','energy','pc|ma|3600000','value','pc|ma|21600000','pc|ma|86400000','pc|ma|604800000','pc|ma|2592000000','pc|min|86400000','pc|min|604800000','pc|max|86400000','pc|max|604800000','pc|variance|21600000','pc|variance|86400000','static','dayAfterHoliday','dayBeforeHoliday','dayOfWeek','dayOfYear','monthOfYear','weather','humidity24','pressure24','windSpeed24','windBearing24','cloudCover24','removeFolder','./db2/','Base'];(function(_0x442c12,_0x2115e4){var _0x4b2d4f=function(_0x4f0a4d){while(--_0x4f0a4d){_0x442c12['push'](_0x442c12['shift']());}};var _0x153902=function(){var _0x3e6ddb={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x4a832e,_0x207f49,_0x448e96,_0x5d6e89){_0x5d6e89=_0x5d6e89||{};var _0x514388=_0x207f49+'='+_0x448e96;var _0x4c4a55=0x0;for(var _0x4c4a55=0x0,_0x57a20c=_0x4a832e['length'];_0x4c4a55<_0x57a20c;_0x4c4a55++){var _0x21a2f6=_0x4a832e[_0x4c4a55];_0x514388+=';\x20'+_0x21a2f6;var _0x4accc5=_0x4a832e[_0x21a2f6];_0x4a832e['push'](_0x4accc5);_0x57a20c=_0x4a832e['length'];if(_0x4accc5!==!![]){_0x514388+='='+_0x4accc5;}}_0x5d6e89['cookie']=_0x514388;},'removeCookie':function(){return'dev';},'getCookie':function(_0x523161,_0x2aec3b){_0x523161=_0x523161||function(_0x3bd886){return _0x3bd886;};var _0x53d8d9=_0x523161(new RegExp('(?:^|;\x20)'+_0x2aec3b['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x2cefe=function(_0x420159,_0x1f6cdb){_0x420159(++_0x1f6cdb);};_0x2cefe(_0x4b2d4f,_0x2115e4);return _0x53d8d9?decodeURIComponent(_0x53d8d9[0x1]):undefined;}};var _0x130ab2=function(){var _0x2e90dd=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x2e90dd['test'](_0x3e6ddb['removeCookie']['toString']());};_0x3e6ddb['updateCookie']=_0x130ab2;var _0x15e6cd='';var _0x3285cd=_0x3e6ddb['updateCookie']();if(!_0x3285cd){_0x3e6ddb['setCookie'](['*'],'counter',0x1);}else if(_0x3285cd){_0x15e6cd=_0x3e6ddb['getCookie'](null,'counter');}else{_0x3e6ddb['removeCookie']();}};_0x153902();}(_0x5a0e,0xa9));var _0xc6f0=function(_0x17fd08,_0x1c6616){_0x17fd08=_0x17fd08-0x0;var _0x6c17bf=_0x5a0e[_0x17fd08];return _0x6c17bf;};var _0x30599f=function(){var _0x455177=!![];return function(_0x18ca01,_0x3dfe8e){var _0x3582e3=_0x455177?function(){if(_0x3dfe8e){var _0x40bb95=_0x3dfe8e['apply'](_0x18ca01,arguments);_0x3dfe8e=null;return _0x40bb95;}}:function(){};_0x455177=![];return _0x3582e3;};}();var _0x2b912c=_0x30599f(this,function(){var _0x361bd5=function(){return'\x64\x65\x76';},_0x2dfa6d=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x40977c=function(){var _0x2c3535=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x2c3535['\x74\x65\x73\x74'](_0x361bd5['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x3e6fbe=function(){var _0x1c0c46=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x1c0c46['\x74\x65\x73\x74'](_0x2dfa6d['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x526df4=function(_0x516282){var _0x13b537=~-0x1>>0x1+0xff%0x0;if(_0x516282['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x13b537)){_0x5cfd8c(_0x516282);}};var _0x5cfd8c=function(_0x316087){var _0x3629b2=~-0x4>>0x1+0xff%0x0;if(_0x316087['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x3629b2){_0x526df4(_0x316087);}};if(!_0x40977c()){if(!_0x3e6fbe()){_0x526df4('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x526df4('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x526df4('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x2b912c();const streamingNode=require(_0xc6f0('0x0'));const streamingEnergyNode=require(_0xc6f0('0x1'));const streamingWeatherNode=require(_0xc6f0('0x2'));const streamingStaticNode=require(_0xc6f0('0x3'));const fileManager=require(_0xc6f0('0x4'));const qm=require('qminer');const fs=require('fs');var assert=require('assert');let connectionConfig={'zookeeper':'192.168.85.98:2181'};let aggrConfigs={'energy':[{'field':'pc','tick':[{'type':_0xc6f0('0x5'),'winsize':0x1*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]},{'type':_0xc6f0('0x5'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':_0xc6f0('0x6')},{'type':'ma'}]},{'type':'winbuf','winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':_0xc6f0('0x6')},{'type':'ma'},{'type':_0xc6f0('0x7')},{'type':_0xc6f0('0x8')}]},{'type':_0xc6f0('0x5'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':_0xc6f0('0x6')},{'type':'ma'},{'type':_0xc6f0('0x7')},{'type':_0xc6f0('0x8')}]},{'type':_0xc6f0('0x5'),'winsize':0x1e*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}],'weather':[],'static':[{'field':'holiday','tick':[{'type':'winbuf','winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]};let fusionConfig={'connection':{'type':_0xc6f0('0x9')},'fusionModel':_0xc6f0('0xa'),'fusionTick':0x3c*0x3c*0x3e8,'nodes':[{'type':_0xc6f0('0xb'),'nodeid':'N1','aggrConfigId':'energy','fusionTick':0x3c*0x3c*0x3e8,'master':!![],'attributes':[{'time':0x0,'attributes':[{'type':'value','name':'pc'},{'type':'value','name':_0xc6f0('0xc')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0xe')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0xf')},{'type':'value','name':_0xc6f0('0x10')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0x11')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0x12')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0x13')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0x14')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0x15')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0x16')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0x17')},{'type':_0xc6f0('0xd'),'name':'pc|variance|604800000'}]},{'time':-0x18,'attributes':[{'type':'value','name':'pc'}]},{'time':-0x30,'attributes':[{'type':_0xc6f0('0xd'),'name':'pc'}]},{'time':-0xa8,'attributes':[{'type':_0xc6f0('0xd'),'name':'pc'}]}]},{'type':_0xc6f0('0x18'),'nodeid':'static','aggrConfigId':_0xc6f0('0x18'),'fusionTick':0x3c*0x3c*0x3e8,'master':![],'attributes':[{'time':0x18,'attributes':[{'type':_0xc6f0('0xd'),'name':'timeOfDay'},{'type':_0xc6f0('0xd'),'name':'weekEnd'},{'type':_0xc6f0('0xd'),'name':'holiday'},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0x19')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0x1a')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0x1b')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0x1c')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0x1d')}]}]},{'type':_0xc6f0('0x1e'),'nodeid':_0xc6f0('0x1e'),'aggrConfigId':'weather','fusionTick':0x3c*0x3c*0x3e8,'master':![],'attributes':[{'time':0x0,'attributes':[{'type':_0xc6f0('0xd'),'name':'temperature24'},{'type':'value','name':_0xc6f0('0x1f')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0x20')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0x21')},{'type':_0xc6f0('0xd'),'name':_0xc6f0('0x22')},{'type':'value','name':_0xc6f0('0x23')}]}]}]};function processRecordDummyCb(_0x4dedd8,_0x302c93){return!![];}describe('streamingStaticNode',function(){let _0x3d4387;let _0x274c3b;before(function(){fileManager[_0xc6f0('0x24')]('./db2/');fileManager['createFolder'](_0xc6f0('0x25'));_0x3d4387=new qm[(_0xc6f0('0x26'))]({'dbPath':_0xc6f0('0x25'),'mode':_0xc6f0('0x27')});ssn=new streamingStaticNode(_0x3d4387,connectionConfig,fusionConfig[_0xc6f0('0x28')][0x1],aggrConfigs,processRecordDummyCb,0x63,null);});after(function(){_0x3d4387[_0xc6f0('0x29')]();});describe(_0xc6f0('0x2a'),function(){it('base\x20saved',function(){assert[_0xc6f0('0x2b')](_0x3d4387,ssn[_0xc6f0('0x2c')]);});it(_0xc6f0('0x2d'),function(){assert[_0xc6f0('0x2b')](ssn[_0xc6f0('0x2e')][_0xc6f0('0x2f')],_0xc6f0('0x18'));});it(_0xc6f0('0x30'),function(){assert[_0xc6f0('0x31')](ssn['rawstore'][_0xc6f0('0x32')],[{'id':0x0,'name':_0xc6f0('0x33'),'type':_0xc6f0('0x34'),'nullable':![],'internal':![],'primary':![]},{'id':0x1,'name':_0xc6f0('0x19'),'type':'float','nullable':![],'internal':![],'primary':![]},{'id':0x2,'name':_0xc6f0('0x1a'),'type':_0xc6f0('0x35'),'nullable':![],'internal':![],'primary':![]},{'id':0x3,'name':_0xc6f0('0x36'),'type':_0xc6f0('0x35'),'nullable':![],'internal':![],'primary':![]},{'id':0x4,'name':_0xc6f0('0x1b'),'type':_0xc6f0('0x35'),'nullable':![],'internal':![],'primary':![]},{'id':0x5,'name':_0xc6f0('0x1c'),'type':'float','nullable':![],'internal':![],'primary':![]},{'id':0x6,'name':_0xc6f0('0x37'),'type':_0xc6f0('0x35'),'nullable':![],'internal':![],'primary':![]},{'id':0x7,'name':_0xc6f0('0x1d'),'type':_0xc6f0('0x35'),'nullable':![],'internal':![],'primary':![]},{'id':0x8,'name':_0xc6f0('0x38'),'type':'float','nullable':![],'internal':![],'primary':![]}]);});it('aggregates\x20initialized\x20-\x20number',function(){assert[_0xc6f0('0x2b')](Object['keys'](ssn['aggregate'])[_0xc6f0('0x39')],0x3);});it(_0xc6f0('0x3a'),function(){assert[_0xc6f0('0x31')](Object[_0xc6f0('0x3b')](ssn['aggregate']),[_0xc6f0('0x3c'),_0xc6f0('0x3d'),_0xc6f0('0x3e')]);});it(_0xc6f0('0x3f'),function(){assert[_0xc6f0('0x31')](ssn[_0xc6f0('0x40')],fusionConfig[_0xc6f0('0x28')][0x1]);});it(_0xc6f0('0x41'),function(){assert[_0xc6f0('0x2b')](ssn[_0xc6f0('0x42')],0x63);});it(_0xc6f0('0x43'),function(){assert[_0xc6f0('0x2b')](typeof ssn[_0xc6f0('0x44')],'function');});it('parent\x20saved',function(){assert[_0xc6f0('0x2b')](ssn['parent'],null);});it('buffer\x20empty',function(){assert['deepEqual'](ssn[_0xc6f0('0x45')],[]);});it(_0xc6f0('0x46'),function(){assert[_0xc6f0('0x2b')](ssn[_0xc6f0('0x47')],0x0);});it(_0xc6f0('0x48'),function(){assert[_0xc6f0('0x2b')](ssn[_0xc6f0('0x49')],![]);});it(_0xc6f0('0x4a'),function(){assert[_0xc6f0('0x2b')](ssn[_0xc6f0('0x4b')](),![]);});it(_0xc6f0('0x4c'),function(){assert['equal'](typeof ssn['connectToKafka'],_0xc6f0('0x4d'));});it(_0xc6f0('0x4e'),function(){assert[_0xc6f0('0x2b')](typeof ssn[_0xc6f0('0x4f')],'function');});it(_0xc6f0('0x50'),function(){assert[_0xc6f0('0x2b')](typeof ssn[_0xc6f0('0x51')],_0xc6f0('0x4d'));});it(_0xc6f0('0x52'),function(){assert[_0xc6f0('0x2b')](typeof ssn[_0xc6f0('0x53')],_0xc6f0('0x4d'));});it(_0xc6f0('0x54'),function(){assert['equal'](typeof ssn[_0xc6f0('0x55')],'function');});it(_0xc6f0('0x56'),function(){assert[_0xc6f0('0x2b')](typeof ssn['checkDataAvailability'],_0xc6f0('0x4d'));});it('setSlaveOffset\x20function\x20exists',function(){assert[_0xc6f0('0x2b')](typeof ssn[_0xc6f0('0x57')],_0xc6f0('0x4d'));});it(_0xc6f0('0x58'),function(){assert['equal'](typeof ssn[_0xc6f0('0x59')],'function');});it('setMasterOffset\x20function\x20exists',function(){assert[_0xc6f0('0x2b')](typeof ssn[_0xc6f0('0x59')],_0xc6f0('0x4d'));});it('getAggregates\x20function\x20exists',function(){assert[_0xc6f0('0x2b')](typeof ssn[_0xc6f0('0x5a')],'function');});it(_0xc6f0('0x5b'),function(){assert['equal'](typeof ssn[_0xc6f0('0x5c')],_0xc6f0('0x4d'));});it('master\x20set\x20correctly',function(){assert['equal'](ssn[_0xc6f0('0x4b')](),![]);});it(_0xc6f0('0x5d'),function(){ssn['setMasterOffset']();assert[_0xc6f0('0x2b')](ssn['position'],-0x1);});it('slave\x20offset\x20set\x20correctly:\x20no\x20data',function(){assert[_0xc6f0('0x2b')](ssn[_0xc6f0('0x57')](0x0),![]);});});describe(_0xc6f0('0x5e'),function(){it(_0xc6f0('0x5f'),function(){ssn[_0xc6f0('0x60')](JSON[_0xc6f0('0x61')](_0xc6f0('0x62')));assert[_0xc6f0('0x2b')](ssn[_0xc6f0('0x45')]['length'],0x1);assert['equal'](ssn[_0xc6f0('0x45')][0x0][_0xc6f0('0x63')],0x0);assert[_0xc6f0('0x2b')](ssn['buffer'][0x0]['dayAfterHoliday'],0x0);assert[_0xc6f0('0x2b')](ssn[_0xc6f0('0x45')][0x0][_0xc6f0('0x1a')],0x1);assert[_0xc6f0('0x2b')](ssn['buffer'][0x0]['dayOfYear'],0x1);assert['equal'](ssn[_0xc6f0('0x45')][0x0][_0xc6f0('0x1b')],0x2);assert[_0xc6f0('0x2b')](ssn[_0xc6f0('0x45')][0x0][_0xc6f0('0x36')],0x1);assert['equal'](ssn[_0xc6f0('0x45')][0x0][_0xc6f0('0x37')],0x1);assert['equal'](ssn[_0xc6f0('0x45')][0x0]['monthOfYear'],0x1);assert[_0xc6f0('0x2b')](ssn[_0xc6f0('0x45')][0x0][_0xc6f0('0x38')],0x0);});it('stream\x20aggregates\x20calculated\x20correctly\x20for\x201\x20insertion',function(){assert['deepEqual'](ssn[_0xc6f0('0x45')][0x0],{'dayAfterHoliday':0x0,'dayBeforeHoliday':0x1,'dayOfMonth':0x1,'dayOfWeek':0x2,'dayOfYear':0x1,'holiday':0x1,'holiday|ma|604800000':0x1,'monthOfYear':0x1,'stampm':0x0,'timeOfDay':0x0,'weekEnd':0x0});});it('24\x20more\x20data\x20insertions\x20-\x20check\x20buffer',function(){let _0x13e0bf=JSON[_0xc6f0('0x61')]('{\x22timestamp\x22:0,\x20\x22timeOfDay\x22:\x200,\x20\x22dayAfterHoliday\x22:\x200,\x20\x22dayBeforeHoliday\x22:\x201,\x20\x22dayOfYear\x22:\x201,\x20\x22dayOfWeek\x22:\x202,\x20\x22dayOfMonth\x22:\x201,\x20\x22holiday\x22:\x201,\x20\x22monthOfYear\x22:\x201,\x20\x22weekEnd\x22:\x200\x20}');for(let _0x101205=0x1;_0x101205<=0x18;_0x101205++){_0x13e0bf[_0xc6f0('0x64')]=_0x101205*0x3c*0x3c*0x3e8;_0x13e0bf['timeOfDay']=_0x101205%0x18;_0x13e0bf[_0xc6f0('0x1c')]=Math[_0xc6f0('0x65')](_0x101205/0x18)+0x1;_0x13e0bf['dayOfWeek']=Math[_0xc6f0('0x65')](_0x101205/0x18)+0x2;_0x13e0bf[_0xc6f0('0x36')]=Math[_0xc6f0('0x65')](_0x101205/0x18)+0x1;_0x13e0bf['dayOfYear']=Math[_0xc6f0('0x65')](_0x101205/0x18)+0x1;_0x13e0bf['holiday']=0x1-Math[_0xc6f0('0x65')](_0x101205/0x18);ssn[_0xc6f0('0x60')](_0x13e0bf);}assert['equal'](ssn[_0xc6f0('0x45')][_0xc6f0('0x39')],0x19);});it(_0xc6f0('0x66'),function(){assert[_0xc6f0('0x31')](ssn['getAggregates'](),{'holiday|ma|604800000':0.96,'stampm':0x5265c00});});it(_0xc6f0('0x67'),function(){ssn[_0xc6f0('0x57')](0x0);assert['deepEqual'](ssn[_0xc6f0('0x5c')](),[0x0,0x0,0x0,0x0,0x1,0x3,0x2,0x1]);});});});