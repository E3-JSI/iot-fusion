const a0_0x36bd=['{\x22stampm\x22:','v|min|86400000','v|ma|21600','Time','processRecord','v|tick','isMaster\x20function','aggregates\x20initialized\x20-\x20key\x20names','checkDataAvailability\x20function\x20exists','createAggregates','carno|max|86400000','./db4/','getOffsetTimestamp','v|max|86400000','buffer\x20empty','getAggregates','v|winbuf|86400000','initialization','deleteObsoleteRows','parse','v|variance|86400000','carno|max|21600000','data\x20record\x20saved\x20correctly','9\x20more\x20data\x20insertions','slave\x20offset\x20set\x20correctly:\x20no\x20data','callback\x20function\x20should\x20be\x20set','carno','min','fields','assert','v|ma|21600000','master\x20set\x20correctly','{\x22stampm\x22:\x201468493073000}','carno|variance|21600000','processRecordCb','keys','offsetExists','master','connectToKafka\x20function\x20exists','duplicate\x20insertions\x20test','v|ma|604800000','fusionNodeI\x20correctly\x20saved','v|max|21600000','stream\x20aggregates\x20calculated\x20correctly\x20for\x20#2\x20insertion','offsetExists\x20function\x20exists','{\x22stampm\x22:\x201468493072000,\x20\x22carno\x22:\x201.0,\x20\x22v\x22:\x202\x20}','qminer','carno|min|86400000','base\x20saved','test','../nodes/streamingWeatherNode.js','../nodes/streamingNode.js','winbuf','master\x20flag\x20set\x20correctly','createAggregates\x20function\x20exists','setSlaveOffset','streamingTrafficCounterNode','max','fusionNodeI','connectToKafka','carno|winbuf|21600000','carno|ma|86400000','equal','../nodes/streamingSmartLampNode.js','checkDataAvailability','apply','master\x20offset\x20set\x20correctly','float',',\x22v\x22:\x20','carno|winbuf|86400000','function','../nodes/streamingStaticNode.js','v|min|21600000','datetime','check\x20if\x20store\x20exists','position','aggregate','isMaster','setMasterOffset\x20function\x20exists','constructor','carno|tick','config','close','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','check\x20store\x20structure','variance','data\x20insertion','v|ma|86400000','buffer','broadcastAggregates\x20function\x20exists','broadcastAggregates','getAggregates\x20function\x20exists','deleteObsoleteRows\x20function\x20exists','deepEqual','removeFolder','value','base','carno|variance|86400000','carno|ma|604800000','nodes','name','length','v|variance|21600000','trafficcounter','rawstore','return\x20/\x22\x20+\x20this\x20+\x20\x22/'];(function(_0x31debb,_0x36bd1f){const _0x4b9c60=function(_0x51538a){while(--_0x51538a){_0x31debb['push'](_0x31debb['shift']());}},_0x3d35ab=function(){const _0x2a2061={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x4ebf74,_0x496bb3,_0x941995,_0xc43e67){_0xc43e67=_0xc43e67||{};let _0x10b2e5=_0x496bb3+'='+_0x941995,_0x19aad2=0x0;for(let _0x427410=0x0,_0x2e849d=_0x4ebf74['length'];_0x427410<_0x2e849d;_0x427410++){const _0x19a461=_0x4ebf74[_0x427410];_0x10b2e5+=';\x20'+_0x19a461;const _0x40a6af=_0x4ebf74[_0x19a461];_0x4ebf74['push'](_0x40a6af),_0x2e849d=_0x4ebf74['length'],_0x40a6af!==!![]&&(_0x10b2e5+='='+_0x40a6af);}_0xc43e67['cookie']=_0x10b2e5;},'removeCookie':function(){return'dev';},'getCookie':function(_0x27149e,_0x4eb100){_0x27149e=_0x27149e||function(_0x57e91e){return _0x57e91e;};const _0x3d3b48=_0x27149e(new RegExp('(?:^|;\x20)'+_0x4eb100['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x29f22f=function(_0x6d368a,_0x4af714){_0x6d368a(++_0x4af714);};return _0x29f22f(_0x4b9c60,_0x36bd1f),_0x3d3b48?decodeURIComponent(_0x3d3b48[0x1]):undefined;}},_0x4384b0=function(){const _0x599f2f=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x599f2f['test'](_0x2a2061['removeCookie']['toString']());};_0x2a2061['updateCookie']=_0x4384b0;let _0x1945e0='';const _0x18cef7=_0x2a2061['updateCookie']();if(!_0x18cef7)_0x2a2061['setCookie'](['*'],'counter',0x1);else _0x18cef7?_0x1945e0=_0x2a2061['getCookie'](null,'counter'):_0x2a2061['removeCookie']();};_0x3d35ab();}(a0_0x36bd,0x135));const a0_0x4b9c=function(_0x31debb,_0x36bd1f){_0x31debb=_0x31debb-0x0;let _0x4b9c60=a0_0x36bd[_0x31debb];return _0x4b9c60;};const a0_0x941995=function(){let _0x147926=!![];return function(_0x1a2d22,_0x4bcac2){const _0x17a5be=_0x147926?function(){if(_0x4bcac2){const _0x1f1f21=_0x4bcac2[a0_0x4b9c('0x4a')](_0x1a2d22,arguments);return _0x4bcac2=null,_0x1f1f21;}}:function(){};return _0x147926=![],_0x17a5be;};}(),a0_0x496bb3=a0_0x941995(this,function(){const _0x22f8ca=function(){const _0x40d994=_0x22f8ca[a0_0x4b9c('0x58')](a0_0x4b9c('0x8'))()[a0_0x4b9c('0x58')](a0_0x4b9c('0x5c'));return!_0x40d994[a0_0x4b9c('0x3a')](a0_0x496bb3);};return _0x22f8ca();});a0_0x496bb3();const streamingNode=require(a0_0x4b9c('0x3c')),streamingEnergyNode=require('../nodes/streamingEnergyNode.js'),streamingWeatherNode=require(a0_0x4b9c('0x3b')),streamingStaticNode=require(a0_0x4b9c('0x50')),streamingTimeValueNode=require('../nodes/streamingTimeValueNode.js'),streamingSmartLampNode=require(a0_0x4b9c('0x48')),streamingTrafficCounterNode=require('../nodes/streamingTrafficCounterNode.js'),fileManager=require('../common/utils/fileManager.js'),qm=require(a0_0x4b9c('0x37')),fs=require('fs');var assert=require(a0_0x4b9c('0x26'));let connectionConfig={'zookeeper':'192.168.85.98:2181'},aggrConfigs={'trafficcounter':[{'field':a0_0x4b9c('0x23'),'tick':[{'type':a0_0x4b9c('0x3d'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':a0_0x4b9c('0x24')},{'type':a0_0x4b9c('0x42')},{'type':a0_0x4b9c('0x5e')}]},{'type':a0_0x4b9c('0x3d'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':'min'},{'type':a0_0x4b9c('0x42')},{'type':a0_0x4b9c('0x5e')}]},{'type':a0_0x4b9c('0x3d'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]},{'field':'v','tick':[{'type':a0_0x4b9c('0x3d'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':a0_0x4b9c('0x24')},{'type':a0_0x4b9c('0x42')},{'type':'variance'}]},{'type':'winbuf','winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':a0_0x4b9c('0x24')},{'type':a0_0x4b9c('0x42')},{'type':a0_0x4b9c('0x5e')}]},{'type':a0_0x4b9c('0x3d'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]},fusionConfig={'fusionModel':'trafficcounter','connection':{'type':'mqtt'},'fusionTick':0x3c*0x3c*0x3e8,'nodes':[{'type':a0_0x4b9c('0x6'),'nodeid':a0_0x4b9c('0x6'),'aggrConfigId':a0_0x4b9c('0x6'),'master':!![],'attributes':[{'time':0x0,'attributes':[{'type':a0_0x4b9c('0x68'),'name':a0_0x4b9c('0x23')},{'type':a0_0x4b9c('0x68'),'name':a0_0x4b9c('0xb')},{'type':'value','name':a0_0x4b9c('0x46')},{'type':a0_0x4b9c('0x68'),'name':a0_0x4b9c('0x38')},{'type':'value','name':a0_0x4b9c('0x13')},{'type':a0_0x4b9c('0x68'),'name':'carno|variance|86400000'}]},{'time':-0x18*0x3c*0x3c*0x3e8,'attributes':[{'type':a0_0x4b9c('0x68'),'name':'carno'},{'type':'value','name':'v'},{'type':a0_0x4b9c('0x68'),'name':a0_0x4b9c('0x46')},{'type':'value','name':a0_0x4b9c('0x38')},{'type':'value','name':a0_0x4b9c('0x13')},{'type':a0_0x4b9c('0x68'),'name':'carno|variance|86400000'}]}]}]};function processRecordDummyCb(_0x123ba1,_0x1ac1f2){return!![];}describe(a0_0x4b9c('0x41'),function(){let _0x421eee,_0x26c1ad;before(function(){fileManager[a0_0x4b9c('0x67')](a0_0x4b9c('0x14')),fileManager['createFolder'](a0_0x4b9c('0x14')),_0x421eee=new qm['Base']({'dbPath':a0_0x4b9c('0x14'),'mode':'createClean'}),stcn=new streamingTrafficCounterNode(_0x421eee,connectionConfig,fusionConfig[a0_0x4b9c('0x2')][0x0],aggrConfigs,processRecordDummyCb,0x63,null);}),after(function(){_0x421eee[a0_0x4b9c('0x5b')]();}),describe(a0_0x4b9c('0x1a'),function(){it(a0_0x4b9c('0x39'),function(){assert[a0_0x4b9c('0x47')](_0x421eee,stcn[a0_0x4b9c('0x69')]);}),it(a0_0x4b9c('0x53'),function(){assert['equal'](stcn['rawstore'][a0_0x4b9c('0x3')],a0_0x4b9c('0x6'));}),it(a0_0x4b9c('0x5d'),function(){assert['deepEqual'](stcn[a0_0x4b9c('0x7')][a0_0x4b9c('0x25')],[{'id':0x0,'name':a0_0x4b9c('0xc'),'type':a0_0x4b9c('0x52'),'nullable':![],'internal':![],'primary':![]},{'id':0x1,'name':'carno','type':a0_0x4b9c('0x4c'),'nullable':![],'internal':![],'primary':![]},{'id':0x2,'name':'v','type':a0_0x4b9c('0x4c'),'nullable':![],'internal':![],'primary':![]}]);}),it('aggregates\x20initialized\x20-\x20number',function(){assert[a0_0x4b9c('0x47')](Object[a0_0x4b9c('0x2c')](stcn[a0_0x4b9c('0x55')])[a0_0x4b9c('0x4')],0x1a);}),it(a0_0x4b9c('0x10'),function(){assert[a0_0x4b9c('0x66')](Object['keys'](stcn[a0_0x4b9c('0x55')]),[a0_0x4b9c('0x59'),a0_0x4b9c('0x45'),'carno|ma|21600000','carno|min|21600000',a0_0x4b9c('0x1e'),a0_0x4b9c('0x2a'),a0_0x4b9c('0x4e'),a0_0x4b9c('0x46'),'carno|min|86400000',a0_0x4b9c('0x13'),a0_0x4b9c('0x0'),'carno|winbuf|604800000',a0_0x4b9c('0x1'),a0_0x4b9c('0xe'),'v|winbuf|21600000',a0_0x4b9c('0x27'),a0_0x4b9c('0x51'),a0_0x4b9c('0x33'),a0_0x4b9c('0x5'),a0_0x4b9c('0x19'),a0_0x4b9c('0x60'),a0_0x4b9c('0xa'),a0_0x4b9c('0x16'),a0_0x4b9c('0x1d'),'v|winbuf|604800000',a0_0x4b9c('0x31')]);}),it('config\x20saved',function(){assert[a0_0x4b9c('0x66')](stcn[a0_0x4b9c('0x5a')],fusionConfig[a0_0x4b9c('0x2')][0x0]);}),it(a0_0x4b9c('0x32'),function(){assert[a0_0x4b9c('0x47')](stcn[a0_0x4b9c('0x43')],0x63);}),it(a0_0x4b9c('0x22'),function(){assert[a0_0x4b9c('0x47')](typeof stcn[a0_0x4b9c('0x2b')],'function');}),it('parent\x20saved',function(){assert[a0_0x4b9c('0x47')](stcn['parent'],null);}),it(a0_0x4b9c('0x17'),function(){assert['deepEqual'](stcn[a0_0x4b9c('0x61')],[]);}),it('buffer\x20position\x20is\x200',function(){assert['equal'](stcn[a0_0x4b9c('0x54')],0x0);}),it(a0_0x4b9c('0x3e'),function(){assert['equal'](stcn[a0_0x4b9c('0x2e')],!![]);}),it(a0_0x4b9c('0xf'),function(){assert[a0_0x4b9c('0x47')](stcn[a0_0x4b9c('0x56')](),!![]);}),it(a0_0x4b9c('0x2f'),function(){assert[a0_0x4b9c('0x47')](typeof stcn[a0_0x4b9c('0x44')],a0_0x4b9c('0x4f'));}),it(a0_0x4b9c('0x62'),function(){assert['equal'](typeof stcn[a0_0x4b9c('0x63')],a0_0x4b9c('0x4f'));}),it(a0_0x4b9c('0x3f'),function(){assert[a0_0x4b9c('0x47')](typeof stcn[a0_0x4b9c('0x12')],a0_0x4b9c('0x4f'));}),it(a0_0x4b9c('0x35'),function(){assert[a0_0x4b9c('0x47')](typeof stcn[a0_0x4b9c('0x2d')],a0_0x4b9c('0x4f'));}),it(a0_0x4b9c('0x65'),function(){assert[a0_0x4b9c('0x47')](typeof stcn[a0_0x4b9c('0x1b')],a0_0x4b9c('0x4f'));}),it(a0_0x4b9c('0x11'),function(){assert[a0_0x4b9c('0x47')](typeof stcn[a0_0x4b9c('0x49')],a0_0x4b9c('0x4f'));}),it('setSlaveOffset\x20function\x20exists',function(){assert[a0_0x4b9c('0x47')](typeof stcn[a0_0x4b9c('0x40')],a0_0x4b9c('0x4f'));}),it('getOffsetTimestamp\x20function\x20exists',function(){assert[a0_0x4b9c('0x47')](typeof stcn[a0_0x4b9c('0x15')],'function');}),it(a0_0x4b9c('0x57'),function(){assert[a0_0x4b9c('0x47')](typeof stcn[a0_0x4b9c('0x15')],'function');}),it(a0_0x4b9c('0x64'),function(){assert[a0_0x4b9c('0x47')](typeof stcn[a0_0x4b9c('0x18')],a0_0x4b9c('0x4f'));}),it('getPartialFeatureVector\x20function\x20exists',function(){assert[a0_0x4b9c('0x47')](typeof stcn['getPartialFeatureVector'],a0_0x4b9c('0x4f'));}),it(a0_0x4b9c('0x28'),function(){assert[a0_0x4b9c('0x47')](stcn[a0_0x4b9c('0x56')](),!![]);}),it(a0_0x4b9c('0x4b'),function(){stcn['setMasterOffset'](),assert[a0_0x4b9c('0x47')](stcn[a0_0x4b9c('0x54')],-0x1);}),it(a0_0x4b9c('0x21'),function(){assert['equal'](stcn['setSlaveOffset'](0x0),![]);});}),describe(a0_0x4b9c('0x5f'),function(){it(a0_0x4b9c('0x1f'),function(){stcn['processRecord'](JSON[a0_0x4b9c('0x1c')]('{\x22stampm\x22:\x201468493071000,\x20\x22carno\x22:\x200.0,\x20\x22v\x22:\x201\x20}')),stcn[a0_0x4b9c('0xd')](JSON[a0_0x4b9c('0x1c')]('{\x22stampm\x22:\x201468493072000,\x20\x22carno\x22:\x201.0,\x20\x22v\x22:\x202\x20}')),assert['equal'](stcn[a0_0x4b9c('0x61')][a0_0x4b9c('0x4')],0x2),assert[a0_0x4b9c('0x47')](stcn[a0_0x4b9c('0x61')][0x0][a0_0x4b9c('0x23')],0x0),assert[a0_0x4b9c('0x47')](stcn[a0_0x4b9c('0x61')][0x1][a0_0x4b9c('0x23')],0x1),assert[a0_0x4b9c('0x47')](stcn[a0_0x4b9c('0x61')][0x1]['v'],0x2);}),it('Empty\x20values\x20in\x20message\x20set\x20to\x200',function(){stcn[a0_0x4b9c('0xd')](JSON[a0_0x4b9c('0x1c')](a0_0x4b9c('0x29'))),assert[a0_0x4b9c('0x47')](stcn[a0_0x4b9c('0x61')][a0_0x4b9c('0x4')],0x3),assert[a0_0x4b9c('0x47')](stcn[a0_0x4b9c('0x61')][0x2][a0_0x4b9c('0x23')],0x0),assert[a0_0x4b9c('0x47')](stcn[a0_0x4b9c('0x61')][0x2]['v'],0x0);}),it(a0_0x4b9c('0x34'),function(){assert[a0_0x4b9c('0x66')](stcn[a0_0x4b9c('0x61')][0x1],{'stampm':0x155e9020680,'carno':0x1,'carno|max|21600000':0x1,'carno|max|86400000':0x1,'carno|ma|21600000':0.5,'carno|ma|604800000':0.5,'carno|ma|86400000':0.5,'carno|min|21600000':0x0,'carno|min|86400000':0x0,'carno|variance|21600000':0.5,'carno|variance|86400000':0.5,'v':0x2,'v|max|21600000':0x2,'v|max|86400000':0x2,'v|ma|21600000':1.5,'v|ma|604800000':1.5,'v|ma|86400000':1.5,'v|min|21600000':0x1,'v|min|86400000':0x1,'v|variance|21600000':0.5,'v|variance|86400000':0.5});}),it(a0_0x4b9c('0x20'),function(){for(let _0x222e90=0x1;_0x222e90<=0x9;_0x222e90++){let _0x378cbf=0x155e9020a68+_0x222e90*0x3e8,_0x396125=_0x222e90+0x1,_0x49a435=_0x222e90+0x2;stcn[a0_0x4b9c('0xd')](JSON[a0_0x4b9c('0x1c')](a0_0x4b9c('0x9')+_0x378cbf+',\x22carno\x22:\x20'+_0x396125+a0_0x4b9c('0x4d')+_0x49a435+'}'));}assert[a0_0x4b9c('0x47')](stcn[a0_0x4b9c('0x61')][a0_0x4b9c('0x4')],0xc),assert[a0_0x4b9c('0x66')](stcn[a0_0x4b9c('0x61')][0xb],{'stampm':0x155e9022d90,'carno':0xa,'carno|max|21600000':0xa,'carno|max|86400000':0xa,'carno|ma|21600000':4.583333333333333,'carno|ma|604800000':4.583333333333333,'carno|ma|86400000':4.583333333333333,'carno|min|21600000':0x0,'carno|min|86400000':0x0,'carno|variance|21600000':12.083333333333336,'carno|variance|86400000':12.083333333333336,'v':0xb,'v|max|21600000':0xb,'v|max|86400000':0xb,'v|ma|21600000':5.5,'v|ma|604800000':5.5,'v|ma|86400000':5.5,'v|min|21600000':0x0,'v|min|86400000':0x0,'v|variance|21600000':0xd,'v|variance|86400000':0xd});}),it(a0_0x4b9c('0x30'),function(){stcn[a0_0x4b9c('0xd')](JSON['parse']('{\x22stampm\x22:\x201468493071000,\x20\x22carno\x22:\x200.0,\x20\x22v\x22:\x201\x20}')),stcn[a0_0x4b9c('0xd')](JSON[a0_0x4b9c('0x1c')](a0_0x4b9c('0x36'))),assert['equal'](stcn[a0_0x4b9c('0x61')]['length'],0xc);});});});