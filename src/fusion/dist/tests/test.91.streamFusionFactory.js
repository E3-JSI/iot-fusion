const a0_0x54f9=['getOffsetTimestamp','dayOfWeek','base','dayOfYear','value|variance|86400000','topic','setSlaveOffset','constructor','initialization','value|max|21600000','processRecord','./db-1/','min','deepEqual','removeFolder','nodes','value|max|86400000','stores','holiday','timevalue','check\x20features\x20topic\x20name','createFolder','parse','qminer','feature\x20vector\x20ok','static','fusion_id','winbuf','features_N1_24h','name','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','config','value|ma|21600000','value|min|21600000','dayOfMonth','check\x20fusion\x20model\x20name','N1_24h','buildFeatureVector','value|min|86400000','max','streamingTimeValueNode','monthOfYear','length','equal','floor','{\x22timestamp\x22:0,\x20\x22timeOfDay\x22:\x200,\x20\x22dayAfterHoliday\x22:\x200,\x20\x22dayBeforeHoliday\x22:\x200,\x20\x22dayOfYear\x22:\x201,\x20\x22dayOfWeek\x22:\x202,\x20\x22dayOfMonth\x22:\x201,\x20\x22holiday\x22:\x201,\x20\x22monthOfYear\x22:\x201,\x20\x22weekEnd\x22:\x200\x20}','weekEnd','apply','dayAfterHoliday','timeOfDay','assert','value','variance','base\x20saved','test','value|variance|21600000','streamingStaticNode','global\x20config\x20correct','check\x20number\x20of\x20stores','fusion','value|ma|86400000','object'];(function(_0x5b0a99,_0x54f9bf){const _0x566ddb=function(_0x1e8778){while(--_0x1e8778){_0x5b0a99['push'](_0x5b0a99['shift']());}},_0xd4fc58=function(){const _0xce5dc2={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0xe092d1,_0x46fbfb,_0x26f737,_0x578fe8){_0x578fe8=_0x578fe8||{};let _0x1932ce=_0x46fbfb+'='+_0x26f737,_0x53317f=0x0;for(let _0x57d9c8=0x0,_0x36548e=_0xe092d1['length'];_0x57d9c8<_0x36548e;_0x57d9c8++){const _0x8a4a3e=_0xe092d1[_0x57d9c8];_0x1932ce+=';\x20'+_0x8a4a3e;const _0x4568bc=_0xe092d1[_0x8a4a3e];_0xe092d1['push'](_0x4568bc),_0x36548e=_0xe092d1['length'],_0x4568bc!==!![]&&(_0x1932ce+='='+_0x4568bc);}_0x578fe8['cookie']=_0x1932ce;},'removeCookie':function(){return'dev';},'getCookie':function(_0x5e5fc9,_0x54ae88){_0x5e5fc9=_0x5e5fc9||function(_0x591316){return _0x591316;};const _0x20a7d1=_0x5e5fc9(new RegExp('(?:^|;\x20)'+_0x54ae88['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0xd1b667=function(_0x5227a6,_0x133263){_0x5227a6(++_0x133263);};return _0xd1b667(_0x566ddb,_0x54f9bf),_0x20a7d1?decodeURIComponent(_0x20a7d1[0x1]):undefined;}},_0x5f07bd=function(){const _0x1cd342=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x1cd342['test'](_0xce5dc2['removeCookie']['toString']());};_0xce5dc2['updateCookie']=_0x5f07bd;let _0xa913e1='';const _0x4a0e27=_0xce5dc2['updateCookie']();if(!_0x4a0e27)_0xce5dc2['setCookie'](['*'],'counter',0x1);else _0x4a0e27?_0xa913e1=_0xce5dc2['getCookie'](null,'counter'):_0xce5dc2['removeCookie']();};_0xd4fc58();}(a0_0x54f9,0x1e2));const a0_0x566d=function(_0x5b0a99,_0x54f9bf){_0x5b0a99=_0x5b0a99-0x0;let _0x566ddb=a0_0x54f9[_0x5b0a99];return _0x566ddb;};const a0_0x26f737=function(){let _0x2e1b5e=!![];return function(_0x172034,_0x30068e){const _0xccff9=_0x2e1b5e?function(){if(_0x30068e){const _0xf65a99=_0x30068e[a0_0x566d('0x3d')](_0x172034,arguments);return _0x30068e=null,_0xf65a99;}}:function(){};return _0x2e1b5e=![],_0xccff9;};}(),a0_0x46fbfb=a0_0x26f737(this,function(){const _0x13db7c=function(){const _0x46c804=_0x13db7c['constructor']('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[a0_0x566d('0x15')](a0_0x566d('0x2c'));return!_0x46c804[a0_0x566d('0x6')](a0_0x46fbfb);};return _0x13db7c();});a0_0x46fbfb();const fileManager=require('../common/utils/fileManager.js'),StreamFusion=require('../streamFusion.js'),qm=require(a0_0x566d('0x25')),fs=require('fs');var assert=require(a0_0x566d('0x2'));let connectionConfig={'zookeeper':'192.168.85.98:2181'},smConf={'aggr':{'timevalue':[{'field':'value','tick':[{'type':a0_0x566d('0x29'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':a0_0x566d('0x35')},{'type':a0_0x566d('0x1a')},{'type':a0_0x566d('0x4')}]},{'type':a0_0x566d('0x29'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':a0_0x566d('0x35')},{'type':'min'},{'type':'variance'}]},{'type':a0_0x566d('0x29'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':'max'},{'type':a0_0x566d('0x1a')},{'type':'variance'}]}]}],'static':[{'field':a0_0x566d('0x20'),'tick':[{'type':'winbuf','winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]},'fusion':{'fusionModel':a0_0x566d('0x32'),'connection':{'type':'none'},'fusionTick':0x3c*0x3c*0x3e8,'nodes':[{'type':a0_0x566d('0x21'),'nodeid':'N1','aggrConfigId':a0_0x566d('0x21'),'master':!![],'fusionTick':0x3c*0x3c*0x3e8,'attributes':[{'time':0x0,'attributes':[{'type':'value','name':a0_0x566d('0x3')},{'type':'value','name':a0_0x566d('0x2e')},{'type':a0_0x566d('0x3'),'name':a0_0x566d('0x2f')},{'type':a0_0x566d('0x3'),'name':a0_0x566d('0x17')},{'type':a0_0x566d('0x3'),'name':a0_0x566d('0x7')},{'type':a0_0x566d('0x3'),'name':a0_0x566d('0xc')},{'type':'value','name':a0_0x566d('0x34')},{'type':a0_0x566d('0x3'),'name':a0_0x566d('0x1e')},{'type':a0_0x566d('0x3'),'name':a0_0x566d('0x12')}]},{'time':-0x18,'attributes':[{'type':'value','name':a0_0x566d('0x3')}]}]},{'type':'static','nodeid':'S1','aggrConfigId':a0_0x566d('0x27'),'fusionTick':0x3c*0x3c*0x3e8,'master':![],'attributes':[{'time':0x18,'attributes':[{'type':a0_0x566d('0x3'),'name':a0_0x566d('0x1')},{'type':a0_0x566d('0x3'),'name':a0_0x566d('0x3c')},{'type':'value','name':'holiday'},{'type':a0_0x566d('0x3'),'name':a0_0x566d('0x0')},{'type':a0_0x566d('0x3'),'name':'dayBeforeHoliday'},{'type':a0_0x566d('0x3'),'name':a0_0x566d('0xf')},{'type':a0_0x566d('0x3'),'name':'dayOfYear'},{'type':a0_0x566d('0x3'),'name':a0_0x566d('0x37')}]}]}]}};describe('streamFusion',function(){let _0x263734;before(function(){fileManager[a0_0x566d('0x1c')](a0_0x566d('0x19')),fileManager[a0_0x566d('0x23')](a0_0x566d('0x19')),_0x263734=new StreamFusion(connectionConfig,smConf[a0_0x566d('0xb')],smConf['aggr']);}),after(function(){}),describe(a0_0x566d('0x16'),function(){it(a0_0x566d('0x5'),function(){assert[a0_0x566d('0x39')](typeof _0x263734[a0_0x566d('0x10')],a0_0x566d('0xd'));}),it('check\x20number\x20of\x20fusion\x20objects',function(){assert[a0_0x566d('0x39')](_0x263734[a0_0x566d('0x1d')]['length'],0x2);}),it(a0_0x566d('0xa'),function(){assert[a0_0x566d('0x39')](_0x263734['base']['getStats']()[a0_0x566d('0x1f')][a0_0x566d('0x38')],0x2);}),it(a0_0x566d('0x31'),function(){assert[a0_0x566d('0x39')](_0x263734[a0_0x566d('0x28')],a0_0x566d('0x32'));}),it(a0_0x566d('0x22'),function(){assert[a0_0x566d('0x39')](_0x263734[a0_0x566d('0x13')],a0_0x566d('0x2a'));}),it('check\x20types\x20of\x20nodes',function(){assert[a0_0x566d('0x39')](_0x263734[a0_0x566d('0x1d')][0x0][a0_0x566d('0x15')][a0_0x566d('0x2b')],a0_0x566d('0x36')),assert[a0_0x566d('0x39')](_0x263734['nodes'][0x1][a0_0x566d('0x15')][a0_0x566d('0x2b')],a0_0x566d('0x8'));}),it(a0_0x566d('0x9'),function(){assert[a0_0x566d('0x1b')](_0x263734[a0_0x566d('0x2d')],smConf[a0_0x566d('0xb')]);}),it(a0_0x566d('0x26'),function(){let _0x1a8f0e=JSON[a0_0x566d('0x24')](a0_0x566d('0x3b'));_0x263734[a0_0x566d('0x1d')][0x1]['processRecord'](_0x1a8f0e);for(let _0x2b0fdb=0x1;_0x2b0fdb<=0x49;_0x2b0fdb++){_0x1a8f0e['timestamp']=_0x2b0fdb*0x3c*0x3c*0x3e8,_0x1a8f0e['timeOfDay']=_0x2b0fdb%0x18,_0x1a8f0e[a0_0x566d('0x11')]=Math[a0_0x566d('0x3a')](_0x2b0fdb/0x18)+0x1,_0x1a8f0e[a0_0x566d('0xf')]=Math[a0_0x566d('0x3a')](_0x2b0fdb/0x18)+0x2,_0x1a8f0e[a0_0x566d('0x30')]=Math[a0_0x566d('0x3a')](_0x2b0fdb/0x18)+0x1,_0x1a8f0e[a0_0x566d('0x11')]=Math[a0_0x566d('0x3a')](_0x2b0fdb/0x18)+0x1,_0x1a8f0e[a0_0x566d('0x20')]=0x0,_0x263734[a0_0x566d('0x1d')][0x1][a0_0x566d('0x18')](_0x1a8f0e);}for(let _0x4232c8=0x1;_0x4232c8<=0x30;_0x4232c8++){let _0x23fb8c=_0x4232c8*0x3c*0x3c;_0x263734['nodes'][0x0][a0_0x566d('0x18')]({'time':_0x23fb8c,'value':_0x4232c8});}_0x263734[a0_0x566d('0x1d')][0x0]['setMasterOffset'](),_0x263734[a0_0x566d('0x1d')][0x1][a0_0x566d('0x14')](0x0),assert[a0_0x566d('0x39')](_0x263734[a0_0x566d('0x1d')][0x0][a0_0x566d('0xe')](),0x30*0x3c*0x3c*0x3e8),assert[a0_0x566d('0x1b')](_0x263734[a0_0x566d('0x33')](),[0x30,0x2d,0x2a,0x30,4.666666666666667,0x24,0x18,0x30,54.166666666666664,0x18,0x1,0x0,0x0,0x0,0x0,0x5,0x4,0x1]),assert[a0_0x566d('0x39')](_0x263734['lastTimestamp'],0x30*0x3c*0x3c*0x3e8);});});});