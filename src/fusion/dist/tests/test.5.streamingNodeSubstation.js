var _0x2dce=['{\x22timestamp\x22:1538737202000,\x22current\x22:14,\x22voltage\x22:252.45}','{\x22timestamp\x22:1538737213000,\x22current\x22:15,\x22voltage\x22:262.45}','{\x22timestamp\x22:1538737200000,\x22current\x22:16,\x22voltage\x22:232.45}','{\x22timestamp\x22:1538737201000,\x22current\x22:17,\x22voltage\x22:242.45}','{\x22timestamp\x22:1538737202000,\x22current\x22:18,\x22voltage\x22:252.45}','{\x22timestamp\x22:1538737213000,\x22current\x22:19,\x22voltage\x22:262.45}','log','buffer\x20values','buffer','../nodes/streamingNode.js','../nodes/streamingEnergyNode.js','../nodes/streamingWeatherNode.js','../nodes/streamingStaticNode.js','../../common/utils/fileManager.js','qminer','192.168.85.98:2181','current','winbuf','max','variance','min','voltage','holiday','N1_24h','kafka','Substation','value','voltage|ma|000','current|ma|3600000','voltage|ma|3600000','current|ma|21600000','voltage|ma|21600000','voltage|variance|21600000','current|min|86400000','voltage|ma|86400000','voltage|max|86400000','voltage|min|86400000','voltage|variance|86400000','current|ma|604800000','voltage|ma|604800000','static','timeOfDay','weekEnd','dayBeforeHoliday','dayOfYear','monthOfYear','weather','humidity1','pressure1','windBearing1','cloudCover1','streamingSubstationNode','removeFolder','createFolder','Base','createClean','nodes','close','base\x20saved','equal','check\x20if\x20store\x20exists','name','check\x20store\x20structure','deepEqual','rawstore','fields','Time','datetime','float','power','aggregates\x20initialized\x20-\x20number','keys','aggregate','length','aggregates\x20initialized\x20-\x20key\x20names','current|tick','current|winbuf|3600000','current|winbuf|21600000','current|variance|21600000','current|winbuf|86400000','current|ma|86400000','current|max|86400000','current|variance|86400000','voltage|tick','voltage|winbuf|3600000','voltage|winbuf|21600000','voltage|max|21600000','voltage|min|21600000','voltage|winbuf|86400000','voltage|winbuf|604800000','fusionNodeI\x20correctly\x20saved','fusionNodeI','callback\x20function\x20should\x20be\x20set','processRecordCb','function','parent\x20saved','buffer\x20position\x20is\x200','position','master\x20flag\x20set\x20correctly','master','isMaster','connectToKafka\x20function\x20exists','broadcastAggregates\x20function\x20exists','broadcastAggregates','createAggregates\x20function\x20exists','offsetExists\x20function\x20exists','offsetExists','deleteObsoleteRows\x20function\x20exists','checkDataAvailability','setSlaveOffset','getOffsetTimestamp','setMasterOffset\x20function\x20exists','getAggregates','getPartialFeatureVector\x20function\x20exists','master\x20set\x20correctly','master\x20offset\x20set\x20correctly','setMasterOffset','slave\x20offset\x20set\x20correctly:\x20no\x20data','data\x20insertion','processRecord','parse','{\x22timestamp\x22:1538737200000,\x22current\x22:12,\x22voltage\x22:232.45}','{\x22timestamp\x22:1538737201000,\x22current\x22:13,\x22voltage\x22:242.45}'];(function(_0x3a48a1,_0x565840){var _0x2f6604=function(_0x19e4fb){while(--_0x19e4fb){_0x3a48a1['push'](_0x3a48a1['shift']());}};var _0x2a26aa=function(){var _0x5a8f8c={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x10f6b6,_0x30a3f1,_0x237bf1,_0x38e291){_0x38e291=_0x38e291||{};var _0x596813=_0x30a3f1+'='+_0x237bf1;var _0x37c6e8=0x0;for(var _0x37c6e8=0x0,_0x36e632=_0x10f6b6['length'];_0x37c6e8<_0x36e632;_0x37c6e8++){var _0x43df19=_0x10f6b6[_0x37c6e8];_0x596813+=';\x20'+_0x43df19;var _0x4b39be=_0x10f6b6[_0x43df19];_0x10f6b6['push'](_0x4b39be);_0x36e632=_0x10f6b6['length'];if(_0x4b39be!==!![]){_0x596813+='='+_0x4b39be;}}_0x38e291['cookie']=_0x596813;},'removeCookie':function(){return'dev';},'getCookie':function(_0x1d2964,_0x5c31a2){_0x1d2964=_0x1d2964||function(_0x4d1f38){return _0x4d1f38;};var _0x2be30a=_0x1d2964(new RegExp('(?:^|;\x20)'+_0x5c31a2['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x58e1ed=function(_0x4a2051,_0x31d1e6){_0x4a2051(++_0x31d1e6);};_0x58e1ed(_0x2f6604,_0x565840);return _0x2be30a?decodeURIComponent(_0x2be30a[0x1]):undefined;}};var _0x192833=function(){var _0x58727c=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x58727c['test'](_0x5a8f8c['removeCookie']['toString']());};_0x5a8f8c['updateCookie']=_0x192833;var _0x226511='';var _0x4c1ff0=_0x5a8f8c['updateCookie']();if(!_0x4c1ff0){_0x5a8f8c['setCookie'](['*'],'counter',0x1);}else if(_0x4c1ff0){_0x226511=_0x5a8f8c['getCookie'](null,'counter');}else{_0x5a8f8c['removeCookie']();}};_0x2a26aa();}(_0x2dce,0xff));var _0x193f=function(_0x2fbeca,_0x302170){_0x2fbeca=_0x2fbeca-0x0;var _0x1ae02f=_0x2dce[_0x2fbeca];return _0x1ae02f;};var _0x52e50e=function(){var _0x4cb1df=!![];return function(_0x568097,_0x58c87c){var _0x2400a3=_0x4cb1df?function(){if(_0x58c87c){var _0x3ab396=_0x58c87c['apply'](_0x568097,arguments);_0x58c87c=null;return _0x3ab396;}}:function(){};_0x4cb1df=![];return _0x2400a3;};}();var _0x13dd17=_0x52e50e(this,function(){var _0x48ee22=function(){return'\x64\x65\x76';},_0x3e6386=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x3f8697=function(){var _0x669314=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x669314['\x74\x65\x73\x74'](_0x48ee22['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x177660=function(){var _0x1f3bc9=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x1f3bc9['\x74\x65\x73\x74'](_0x3e6386['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x4eb950=function(_0x521bdc){var _0x3b614a=~-0x1>>0x1+0xff%0x0;if(_0x521bdc['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x3b614a)){_0x24fe8a(_0x521bdc);}};var _0x24fe8a=function(_0x4de162){var _0x42b89b=~-0x4>>0x1+0xff%0x0;if(_0x4de162['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x42b89b){_0x4eb950(_0x4de162);}};if(!_0x3f8697()){if(!_0x177660()){_0x4eb950('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x4eb950('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x4eb950('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x13dd17();const streamingNode=require(_0x193f('0x0'));const streamingEnergyNode=require(_0x193f('0x1'));const streamingWeatherNode=require(_0x193f('0x2'));const streamingStaticNode=require(_0x193f('0x3'));const streamingTrainNode=require('../nodes/streamingTrainNode.js');const streamingSubstationNode=require('../nodes/streamingSubstationNode.js');const fileManager=require(_0x193f('0x4'));const qm=require(_0x193f('0x5'));const fs=require('fs');var assert=require('assert');let connectionConfig={'zookeeper':_0x193f('0x6')};let aggrConfigs={'Substation':[{'field':_0x193f('0x7'),'tick':[{'type':_0x193f('0x8'),'winsize':0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]},{'type':_0x193f('0x8'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x193f('0x9')},{'type':'min'},{'type':_0x193f('0xa')}]},{'type':_0x193f('0x8'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x193f('0x9')},{'type':_0x193f('0xb')},{'type':_0x193f('0xa')}]},{'type':_0x193f('0x8'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]},{'field':_0x193f('0xc'),'tick':[{'type':_0x193f('0x8'),'winsize':0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]},{'type':_0x193f('0x8'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x193f('0x9')},{'type':_0x193f('0xb')},{'type':_0x193f('0xa')}]},{'type':_0x193f('0x8'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x193f('0x9')},{'type':_0x193f('0xb')},{'type':_0x193f('0xa')}]},{'type':_0x193f('0x8'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}],'weather':[],'static':[{'field':_0x193f('0xd'),'tick':[{'type':_0x193f('0x8'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]};let fusionConfig={'fusionModel':_0x193f('0xe'),'connection':{'type':_0x193f('0xf')},'fusionTick':0x3e8,'nodes':[{'type':_0x193f('0x10'),'fusionTick':0x3e8,'nodeid':'N1','aggrConfigId':_0x193f('0x10'),'master':!![],'attributes':[{'time':0x0,'attributes':[{'type':_0x193f('0x11'),'name':'current|ma|000'},{'type':'value','name':_0x193f('0x12')}]},{'time':-0xe10*0x3e8,'attributes':[{'type':_0x193f('0x11'),'name':_0x193f('0x13')},{'type':_0x193f('0x11'),'name':_0x193f('0x14')}]},{'time':-0x6*0xe10*0x3e8,'attributes':[{'type':_0x193f('0x11'),'name':_0x193f('0x15')},{'type':_0x193f('0x11'),'name':'current|max|21600000'},{'type':'value','name':'current|min|21600000'},{'type':_0x193f('0x11'),'name':'current|variance|21600000'},{'type':'value','name':_0x193f('0x16')},{'type':_0x193f('0x11'),'name':'voltage|max|21600000'},{'type':_0x193f('0x11'),'name':'voltage|min|21600000'},{'type':_0x193f('0x11'),'name':_0x193f('0x17')}]},{'time':-0x18*0xe10*0x3e8,'attributes':[{'type':'value','name':'current|ma|86400000'},{'type':_0x193f('0x11'),'name':'current|max|86400000'},{'type':_0x193f('0x11'),'name':_0x193f('0x18')},{'type':'value','name':'current|variance|86400000'},{'type':_0x193f('0x11'),'name':_0x193f('0x19')},{'type':_0x193f('0x11'),'name':_0x193f('0x1a')},{'type':_0x193f('0x11'),'name':_0x193f('0x1b')},{'type':_0x193f('0x11'),'name':_0x193f('0x1c')}]},{'time':-0x7*0x18*0xe10*0x3e8,'attributes':[{'type':_0x193f('0x11'),'name':_0x193f('0x1d')},{'type':'value','name':_0x193f('0x1e')}]}]},{'type':_0x193f('0x1f'),'nodeid':'S1','aggrConfigId':_0x193f('0x1f'),'master':![],'attributes':[{'time':0x18*0x168*0x3e8,'attributes':[{'type':'value','name':_0x193f('0x20')},{'type':_0x193f('0x11'),'name':_0x193f('0x21')},{'type':'value','name':_0x193f('0xd')},{'type':'value','name':'dayAfterHoliday'},{'type':'value','name':_0x193f('0x22')},{'type':_0x193f('0x11'),'name':'dayOfWeek'},{'type':_0x193f('0x11'),'name':_0x193f('0x23')},{'type':'value','name':_0x193f('0x24')}]}]},{'type':_0x193f('0x25'),'nodeid':'W1','aggrConfigId':_0x193f('0x25'),'master':![],'attributes':[{'time':0x0,'attributes':[{'type':'value','name':'temperature1'},{'type':_0x193f('0x11'),'name':_0x193f('0x26')},{'type':_0x193f('0x11'),'name':_0x193f('0x27')},{'type':_0x193f('0x11'),'name':'windSpeed1'},{'type':_0x193f('0x11'),'name':_0x193f('0x28')},{'type':_0x193f('0x11'),'name':_0x193f('0x29')}]}]}]};function processRecordDummyCb(_0x396a67,_0x20a225){return!![];}describe(_0x193f('0x2a'),function(){let _0x24114a;let _0x3a0821;before(function(){fileManager[_0x193f('0x2b')]('./db2/');fileManager[_0x193f('0x2c')]('./db2/');_0x24114a=new qm[(_0x193f('0x2d'))]({'dbPath':'./db2/','mode':_0x193f('0x2e')});sen=new streamingSubstationNode(_0x24114a,connectionConfig,fusionConfig[_0x193f('0x2f')][0x0],aggrConfigs,processRecordDummyCb,0x63,null);});after(function(){_0x24114a[_0x193f('0x30')]();});describe('initialization',function(){it(_0x193f('0x31'),function(){assert[_0x193f('0x32')](_0x24114a,sen['base']);});it(_0x193f('0x33'),function(){assert[_0x193f('0x32')](sen['rawstore'][_0x193f('0x34')],'N1');});it(_0x193f('0x35'),function(){assert[_0x193f('0x36')](sen[_0x193f('0x37')][_0x193f('0x38')],[{'id':0x0,'name':_0x193f('0x39'),'type':_0x193f('0x3a'),'nullable':![],'internal':![],'primary':![]},{'id':0x1,'name':_0x193f('0x7'),'type':_0x193f('0x3b'),'nullable':![],'internal':![],'primary':![]},{'id':0x2,'name':_0x193f('0xc'),'type':'float','nullable':![],'internal':![],'primary':![]},{'id':0x3,'name':_0x193f('0x3c'),'type':'float','nullable':![],'internal':![],'primary':![]}]);});it(_0x193f('0x3d'),function(){assert[_0x193f('0x32')](Object[_0x193f('0x3e')](sen[_0x193f('0x3f')])[_0x193f('0x40')],0x1e);});it(_0x193f('0x41'),function(){assert[_0x193f('0x36')](Object[_0x193f('0x3e')](sen[_0x193f('0x3f')]),[_0x193f('0x42'),_0x193f('0x43'),_0x193f('0x13'),_0x193f('0x44'),'current|ma|21600000','current|max|21600000','current|min|21600000',_0x193f('0x45'),_0x193f('0x46'),_0x193f('0x47'),_0x193f('0x48'),_0x193f('0x18'),_0x193f('0x49'),'current|winbuf|604800000',_0x193f('0x1d'),_0x193f('0x4a'),_0x193f('0x4b'),_0x193f('0x14'),_0x193f('0x4c'),_0x193f('0x16'),_0x193f('0x4d'),_0x193f('0x4e'),'voltage|variance|21600000',_0x193f('0x4f'),_0x193f('0x19'),_0x193f('0x1a'),_0x193f('0x1b'),_0x193f('0x1c'),_0x193f('0x50'),_0x193f('0x1e')]);});it('config\x20saved',function(){assert['deepEqual'](sen['config'],fusionConfig[_0x193f('0x2f')][0x0]);});it(_0x193f('0x51'),function(){assert[_0x193f('0x32')](sen[_0x193f('0x52')],0x63);});it(_0x193f('0x53'),function(){assert['equal'](typeof sen[_0x193f('0x54')],_0x193f('0x55'));});it(_0x193f('0x56'),function(){assert['equal'](sen['parent'],null);});it('buffer\x20empty',function(){assert[_0x193f('0x36')](sen['buffer'],[]);});it(_0x193f('0x57'),function(){assert[_0x193f('0x32')](sen[_0x193f('0x58')],0x0);});it(_0x193f('0x59'),function(){assert['equal'](sen[_0x193f('0x5a')],!![]);});it('isMaster\x20function',function(){assert[_0x193f('0x32')](sen[_0x193f('0x5b')](),!![]);});it(_0x193f('0x5c'),function(){assert[_0x193f('0x32')](typeof sen['connectToKafka'],_0x193f('0x55'));});it(_0x193f('0x5d'),function(){assert[_0x193f('0x32')](typeof sen[_0x193f('0x5e')],_0x193f('0x55'));});it(_0x193f('0x5f'),function(){assert[_0x193f('0x32')](typeof sen['createAggregates'],_0x193f('0x55'));});it(_0x193f('0x60'),function(){assert[_0x193f('0x32')](typeof sen[_0x193f('0x61')],_0x193f('0x55'));});it(_0x193f('0x62'),function(){assert[_0x193f('0x32')](typeof sen['deleteObsoleteRows'],_0x193f('0x55'));});it('checkDataAvailability\x20function\x20exists',function(){assert[_0x193f('0x32')](typeof sen[_0x193f('0x63')],'function');});it('setSlaveOffset\x20function\x20exists',function(){assert[_0x193f('0x32')](typeof sen[_0x193f('0x64')],_0x193f('0x55'));});it('getOffsetTimestamp\x20function\x20exists',function(){assert['equal'](typeof sen[_0x193f('0x65')],_0x193f('0x55'));});it(_0x193f('0x66'),function(){assert[_0x193f('0x32')](typeof sen[_0x193f('0x65')],_0x193f('0x55'));});it('getAggregates\x20function\x20exists',function(){assert[_0x193f('0x32')](typeof sen[_0x193f('0x67')],_0x193f('0x55'));});it(_0x193f('0x68'),function(){assert[_0x193f('0x32')](typeof sen['getPartialFeatureVector'],'function');});it(_0x193f('0x69'),function(){assert[_0x193f('0x32')](sen[_0x193f('0x5b')](),!![]);});it(_0x193f('0x6a'),function(){sen[_0x193f('0x6b')]();assert['equal'](sen[_0x193f('0x58')],-0x1);});it(_0x193f('0x6c'),function(){assert[_0x193f('0x32')](sen[_0x193f('0x64')](0x0),![]);});});describe(_0x193f('0x6d'),function(){it('data\x20record\x20saved\x20correctly',function(){sen[_0x193f('0x6e')](JSON[_0x193f('0x6f')](_0x193f('0x70')));sen[_0x193f('0x6e')](JSON[_0x193f('0x6f')](_0x193f('0x71')));sen['processRecord'](JSON[_0x193f('0x6f')](_0x193f('0x72')));sen['processRecord'](JSON[_0x193f('0x6f')](_0x193f('0x73')));sen['processRecord'](JSON[_0x193f('0x6f')](_0x193f('0x74')));sen[_0x193f('0x6e')](JSON[_0x193f('0x6f')](_0x193f('0x75')));sen['processRecord'](JSON[_0x193f('0x6f')](_0x193f('0x76')));sen[_0x193f('0x6e')](JSON[_0x193f('0x6f')](_0x193f('0x77')));console[_0x193f('0x78')](_0x193f('0x79'));console[_0x193f('0x78')](sen[_0x193f('0x7a')]);});});});