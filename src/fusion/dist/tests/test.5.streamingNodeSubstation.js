var _0x2850=['holiday','dayOfYear','weather','temperature1','humidity1','cloudCover1','./db2/','Base','createClean','nodes','close','initialization','base\x20saved','equal','base','check\x20if\x20store\x20exists','rawstore','name','check\x20store\x20structure','deepEqual','fields','Time','datetime','float','aggregates\x20initialized\x20-\x20number','keys','aggregate','aggregates\x20initialized\x20-\x20key\x20names','current|tick','current|winbuf|3600000','current|winbuf|21600000','current|ma|21600000','current|max|21600000','current|winbuf|86400000','current|max|86400000','current|winbuf|604800000','voltage|tick','voltage|winbuf|3600000','voltage|winbuf|21600000','voltage|max|86400000','voltage|winbuf|604800000','voltage|ma|604800000','config\x20saved','config','fusionNodeI\x20correctly\x20saved','fusionNodeI','parent\x20saved','parent','buffer\x20empty','position','master\x20flag\x20set\x20correctly','master','isMaster\x20function','isMaster','connectToKafka\x20function\x20exists','connectToKafka','broadcastAggregates\x20function\x20exists','function','createAggregates\x20function\x20exists','createAggregates','offsetExists\x20function\x20exists','deleteObsoleteRows\x20function\x20exists','deleteObsoleteRows','checkDataAvailability\x20function\x20exists','setSlaveOffset\x20function\x20exists','getOffsetTimestamp','setMasterOffset\x20function\x20exists','getAggregates\x20function\x20exists','getAggregates','getPartialFeatureVector\x20function\x20exists','getPartialFeatureVector','master\x20set\x20correctly','master\x20offset\x20set\x20correctly','setMasterOffset','slave\x20offset\x20set\x20correctly:\x20no\x20data','setSlaveOffset','data\x20record\x20saved\x20correctly','parse','{\x22timestamp\x22:1538737200000,\x22current\x22:12,\x22voltage\x22:232.45}','processRecord','{\x22timestamp\x22:1538737202000,\x22current\x22:14,\x22voltage\x22:252.45}','{\x22timestamp\x22:1538737213000,\x22current\x22:15,\x22voltage\x22:262.45}','{\x22timestamp\x22:1538737200000,\x22current\x22:16,\x22voltage\x22:232.45}','{\x22timestamp\x22:1538737213000,\x22current\x22:19,\x22voltage\x22:262.45}','log','buffer\x20values','../nodes/streamingNode.js','../nodes/streamingEnergyNode.js','../nodes/streamingWeatherNode.js','../nodes/streamingTrainNode.js','../nodes/streamingSubstationNode.js','qminer','assert','192.168.85.98:2181','current','winbuf','max','min','variance','voltage','N1_24h','kafka','Substation','value','current|ma|000','voltage|ma|3600000','current|min|21600000','current|variance|21600000','voltage|ma|21600000','voltage|max|21600000','voltage|min|21600000','current|ma|86400000','current|min|86400000','current|variance|86400000','voltage|ma|86400000','voltage|variance|86400000','current|ma|604800000','static','timeOfDay','weekEnd'];(function(_0x190e64,_0xc67709){var _0x3bd3bc=function(_0x10e16a){while(--_0x10e16a){_0x190e64['push'](_0x190e64['shift']());}};var _0x11dd10=function(){var _0x3a75e3={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x2c54ff,_0x341667,_0x293e4c,_0x27dbf7){_0x27dbf7=_0x27dbf7||{};var _0x494885=_0x341667+'='+_0x293e4c;var _0x3bb925=0x0;for(var _0x3bb925=0x0,_0x2afc5f=_0x2c54ff['length'];_0x3bb925<_0x2afc5f;_0x3bb925++){var _0x470476=_0x2c54ff[_0x3bb925];_0x494885+=';\x20'+_0x470476;var _0x50caf3=_0x2c54ff[_0x470476];_0x2c54ff['push'](_0x50caf3);_0x2afc5f=_0x2c54ff['length'];if(_0x50caf3!==!![]){_0x494885+='='+_0x50caf3;}}_0x27dbf7['cookie']=_0x494885;},'removeCookie':function(){return'dev';},'getCookie':function(_0x26cdea,_0x137e90){_0x26cdea=_0x26cdea||function(_0x491484){return _0x491484;};var _0x35917e=_0x26cdea(new RegExp('(?:^|;\x20)'+_0x137e90['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x51ca1a=function(_0x38ec28,_0x48e550){_0x38ec28(++_0x48e550);};_0x51ca1a(_0x3bd3bc,_0xc67709);return _0x35917e?decodeURIComponent(_0x35917e[0x1]):undefined;}};var _0x2c70c7=function(){var _0x7ef99d=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x7ef99d['test'](_0x3a75e3['removeCookie']['toString']());};_0x3a75e3['updateCookie']=_0x2c70c7;var _0xaeecd1='';var _0x43db3e=_0x3a75e3['updateCookie']();if(!_0x43db3e){_0x3a75e3['setCookie'](['*'],'counter',0x1);}else if(_0x43db3e){_0xaeecd1=_0x3a75e3['getCookie'](null,'counter');}else{_0x3a75e3['removeCookie']();}};_0x11dd10();}(_0x2850,0x1be));var _0x50b8=function(_0x208080,_0x406010){_0x208080=_0x208080-0x0;var _0x5e4209=_0x2850[_0x208080];return _0x5e4209;};var _0x448eab=function(){var _0x1c335e=!![];return function(_0x483841,_0x1e8275){var _0x197a74=_0x1c335e?function(){if(_0x1e8275){var _0x4939f5=_0x1e8275['apply'](_0x483841,arguments);_0x1e8275=null;return _0x4939f5;}}:function(){};_0x1c335e=![];return _0x197a74;};}();var _0x163d99=_0x448eab(this,function(){var _0x3161c2=function(){return'\x64\x65\x76';},_0x673e72=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x463dce=function(){var _0x27c4d0=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x27c4d0['\x74\x65\x73\x74'](_0x3161c2['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x3a2350=function(){var _0xc6d20f=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0xc6d20f['\x74\x65\x73\x74'](_0x673e72['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x554ee6=function(_0x1a27eb){var _0x396a3f=~-0x1>>0x1+0xff%0x0;if(_0x1a27eb['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x396a3f)){_0x46f715(_0x1a27eb);}};var _0x46f715=function(_0x1d8787){var _0x32548e=~-0x4>>0x1+0xff%0x0;if(_0x1d8787['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x32548e){_0x554ee6(_0x1d8787);}};if(!_0x463dce()){if(!_0x3a2350()){_0x554ee6('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x554ee6('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x554ee6('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x163d99();const streamingNode=require(_0x50b8('0x0'));const streamingEnergyNode=require(_0x50b8('0x1'));const streamingWeatherNode=require(_0x50b8('0x2'));const streamingStaticNode=require('../nodes/streamingStaticNode.js');const streamingTrainNode=require(_0x50b8('0x3'));const streamingSubstationNode=require(_0x50b8('0x4'));const fileManager=require('../../common/utils/fileManager.js');const qm=require(_0x50b8('0x5'));const fs=require('fs');var assert=require(_0x50b8('0x6'));let connectionConfig={'zookeeper':_0x50b8('0x7')};let aggrConfigs={'Substation':[{'field':_0x50b8('0x8'),'tick':[{'type':'winbuf','winsize':0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]},{'type':_0x50b8('0x9'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x50b8('0xa')},{'type':'min'},{'type':'variance'}]},{'type':'winbuf','winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x50b8('0xa')},{'type':_0x50b8('0xb')},{'type':_0x50b8('0xc')}]},{'type':_0x50b8('0x9'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]},{'field':_0x50b8('0xd'),'tick':[{'type':_0x50b8('0x9'),'winsize':0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]},{'type':'winbuf','winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x50b8('0xa')},{'type':_0x50b8('0xb')},{'type':'variance'}]},{'type':_0x50b8('0x9'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x50b8('0xa')},{'type':_0x50b8('0xb')},{'type':_0x50b8('0xc')}]},{'type':_0x50b8('0x9'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}],'weather':[],'static':[{'field':'holiday','tick':[{'type':_0x50b8('0x9'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]};let fusionConfig={'fusionModel':_0x50b8('0xe'),'connection':{'type':_0x50b8('0xf')},'fusionTick':0x3e8,'nodes':[{'type':_0x50b8('0x10'),'fusionTick':0x3e8,'nodeid':'N1','aggrConfigId':_0x50b8('0x10'),'master':!![],'attributes':[{'time':0x0,'attributes':[{'type':_0x50b8('0x11'),'name':_0x50b8('0x12')},{'type':'value','name':'voltage|ma|000'}]},{'time':-0xe10*0x3e8,'attributes':[{'type':'value','name':'current|ma|3600000'},{'type':'value','name':_0x50b8('0x13')}]},{'time':-0x6*0xe10*0x3e8,'attributes':[{'type':'value','name':'current|ma|21600000'},{'type':_0x50b8('0x11'),'name':'current|max|21600000'},{'type':'value','name':_0x50b8('0x14')},{'type':_0x50b8('0x11'),'name':_0x50b8('0x15')},{'type':_0x50b8('0x11'),'name':_0x50b8('0x16')},{'type':_0x50b8('0x11'),'name':_0x50b8('0x17')},{'type':_0x50b8('0x11'),'name':_0x50b8('0x18')},{'type':_0x50b8('0x11'),'name':'voltage|variance|21600000'}]},{'time':-0x18*0xe10*0x3e8,'attributes':[{'type':_0x50b8('0x11'),'name':_0x50b8('0x19')},{'type':_0x50b8('0x11'),'name':'current|max|86400000'},{'type':'value','name':_0x50b8('0x1a')},{'type':_0x50b8('0x11'),'name':_0x50b8('0x1b')},{'type':_0x50b8('0x11'),'name':_0x50b8('0x1c')},{'type':_0x50b8('0x11'),'name':'voltage|max|86400000'},{'type':_0x50b8('0x11'),'name':'voltage|min|86400000'},{'type':_0x50b8('0x11'),'name':_0x50b8('0x1d')}]},{'time':-0x7*0x18*0xe10*0x3e8,'attributes':[{'type':_0x50b8('0x11'),'name':_0x50b8('0x1e')},{'type':'value','name':'voltage|ma|604800000'}]}]},{'type':_0x50b8('0x1f'),'nodeid':'S1','aggrConfigId':_0x50b8('0x1f'),'master':![],'attributes':[{'time':0x18*0x168*0x3e8,'attributes':[{'type':_0x50b8('0x11'),'name':_0x50b8('0x20')},{'type':_0x50b8('0x11'),'name':_0x50b8('0x21')},{'type':_0x50b8('0x11'),'name':_0x50b8('0x22')},{'type':_0x50b8('0x11'),'name':'dayAfterHoliday'},{'type':_0x50b8('0x11'),'name':'dayBeforeHoliday'},{'type':_0x50b8('0x11'),'name':'dayOfWeek'},{'type':_0x50b8('0x11'),'name':_0x50b8('0x23')},{'type':_0x50b8('0x11'),'name':'monthOfYear'}]}]},{'type':_0x50b8('0x24'),'nodeid':'W1','aggrConfigId':_0x50b8('0x24'),'master':![],'attributes':[{'time':0x0,'attributes':[{'type':_0x50b8('0x11'),'name':_0x50b8('0x25')},{'type':'value','name':_0x50b8('0x26')},{'type':'value','name':'pressure1'},{'type':'value','name':'windSpeed1'},{'type':_0x50b8('0x11'),'name':'windBearing1'},{'type':_0x50b8('0x11'),'name':_0x50b8('0x27')}]}]}]};function processRecordDummyCb(_0x55c5f8,_0x2a0c9a){return!![];}describe('streamingSubstationNode',function(){let _0x2c4823;let _0xa6d0f6;before(function(){fileManager['removeFolder'](_0x50b8('0x28'));fileManager['createFolder'](_0x50b8('0x28'));_0x2c4823=new qm[(_0x50b8('0x29'))]({'dbPath':_0x50b8('0x28'),'mode':_0x50b8('0x2a')});sen=new streamingSubstationNode(_0x2c4823,connectionConfig,fusionConfig[_0x50b8('0x2b')][0x0],aggrConfigs,processRecordDummyCb,0x63,null);});after(function(){_0x2c4823[_0x50b8('0x2c')]();});describe(_0x50b8('0x2d'),function(){it(_0x50b8('0x2e'),function(){assert[_0x50b8('0x2f')](_0x2c4823,sen[_0x50b8('0x30')]);});it(_0x50b8('0x31'),function(){assert[_0x50b8('0x2f')](sen[_0x50b8('0x32')][_0x50b8('0x33')],'N1');});it(_0x50b8('0x34'),function(){assert[_0x50b8('0x35')](sen[_0x50b8('0x32')][_0x50b8('0x36')],[{'id':0x0,'name':_0x50b8('0x37'),'type':_0x50b8('0x38'),'nullable':![],'internal':![],'primary':![]},{'id':0x1,'name':_0x50b8('0x8'),'type':_0x50b8('0x39'),'nullable':![],'internal':![],'primary':![]},{'id':0x2,'name':_0x50b8('0xd'),'type':_0x50b8('0x39'),'nullable':![],'internal':![],'primary':![]},{'id':0x3,'name':'power','type':_0x50b8('0x39'),'nullable':![],'internal':![],'primary':![]}]);});it(_0x50b8('0x3a'),function(){assert[_0x50b8('0x2f')](Object[_0x50b8('0x3b')](sen[_0x50b8('0x3c')])['length'],0x1e);});it(_0x50b8('0x3d'),function(){assert[_0x50b8('0x35')](Object[_0x50b8('0x3b')](sen[_0x50b8('0x3c')]),[_0x50b8('0x3e'),_0x50b8('0x3f'),'current|ma|3600000',_0x50b8('0x40'),_0x50b8('0x41'),_0x50b8('0x42'),_0x50b8('0x14'),_0x50b8('0x15'),_0x50b8('0x43'),_0x50b8('0x19'),_0x50b8('0x44'),_0x50b8('0x1a'),'current|variance|86400000',_0x50b8('0x45'),_0x50b8('0x1e'),_0x50b8('0x46'),_0x50b8('0x47'),_0x50b8('0x13'),_0x50b8('0x48'),'voltage|ma|21600000',_0x50b8('0x17'),_0x50b8('0x18'),'voltage|variance|21600000','voltage|winbuf|86400000',_0x50b8('0x1c'),_0x50b8('0x49'),'voltage|min|86400000','voltage|variance|86400000',_0x50b8('0x4a'),_0x50b8('0x4b')]);});it(_0x50b8('0x4c'),function(){assert['deepEqual'](sen[_0x50b8('0x4d')],fusionConfig[_0x50b8('0x2b')][0x0]);});it(_0x50b8('0x4e'),function(){assert[_0x50b8('0x2f')](sen[_0x50b8('0x4f')],0x63);});it('callback\x20function\x20should\x20be\x20set',function(){assert[_0x50b8('0x2f')](typeof sen['processRecordCb'],'function');});it(_0x50b8('0x50'),function(){assert[_0x50b8('0x2f')](sen[_0x50b8('0x51')],null);});it(_0x50b8('0x52'),function(){assert[_0x50b8('0x35')](sen['buffer'],[]);});it('buffer\x20position\x20is\x200',function(){assert[_0x50b8('0x2f')](sen[_0x50b8('0x53')],0x0);});it(_0x50b8('0x54'),function(){assert[_0x50b8('0x2f')](sen[_0x50b8('0x55')],!![]);});it(_0x50b8('0x56'),function(){assert['equal'](sen[_0x50b8('0x57')](),!![]);});it(_0x50b8('0x58'),function(){assert['equal'](typeof sen[_0x50b8('0x59')],'function');});it(_0x50b8('0x5a'),function(){assert[_0x50b8('0x2f')](typeof sen['broadcastAggregates'],_0x50b8('0x5b'));});it(_0x50b8('0x5c'),function(){assert['equal'](typeof sen[_0x50b8('0x5d')],_0x50b8('0x5b'));});it(_0x50b8('0x5e'),function(){assert[_0x50b8('0x2f')](typeof sen['offsetExists'],_0x50b8('0x5b'));});it(_0x50b8('0x5f'),function(){assert[_0x50b8('0x2f')](typeof sen[_0x50b8('0x60')],'function');});it(_0x50b8('0x61'),function(){assert['equal'](typeof sen['checkDataAvailability'],_0x50b8('0x5b'));});it(_0x50b8('0x62'),function(){assert[_0x50b8('0x2f')](typeof sen['setSlaveOffset'],_0x50b8('0x5b'));});it('getOffsetTimestamp\x20function\x20exists',function(){assert[_0x50b8('0x2f')](typeof sen[_0x50b8('0x63')],_0x50b8('0x5b'));});it(_0x50b8('0x64'),function(){assert[_0x50b8('0x2f')](typeof sen[_0x50b8('0x63')],_0x50b8('0x5b'));});it(_0x50b8('0x65'),function(){assert['equal'](typeof sen[_0x50b8('0x66')],_0x50b8('0x5b'));});it(_0x50b8('0x67'),function(){assert[_0x50b8('0x2f')](typeof sen[_0x50b8('0x68')],_0x50b8('0x5b'));});it(_0x50b8('0x69'),function(){assert[_0x50b8('0x2f')](sen[_0x50b8('0x57')](),!![]);});it(_0x50b8('0x6a'),function(){sen[_0x50b8('0x6b')]();assert[_0x50b8('0x2f')](sen[_0x50b8('0x53')],-0x1);});it(_0x50b8('0x6c'),function(){assert[_0x50b8('0x2f')](sen[_0x50b8('0x6d')](0x0),![]);});});describe('data\x20insertion',function(){it(_0x50b8('0x6e'),function(){sen['processRecord'](JSON[_0x50b8('0x6f')](_0x50b8('0x70')));sen[_0x50b8('0x71')](JSON[_0x50b8('0x6f')]('{\x22timestamp\x22:1538737201000,\x22current\x22:13,\x22voltage\x22:242.45}'));sen[_0x50b8('0x71')](JSON[_0x50b8('0x6f')](_0x50b8('0x72')));sen[_0x50b8('0x71')](JSON['parse'](_0x50b8('0x73')));sen[_0x50b8('0x71')](JSON[_0x50b8('0x6f')](_0x50b8('0x74')));sen[_0x50b8('0x71')](JSON[_0x50b8('0x6f')]('{\x22timestamp\x22:1538737201000,\x22current\x22:17,\x22voltage\x22:242.45}'));sen['processRecord'](JSON['parse']('{\x22timestamp\x22:1538737202000,\x22current\x22:18,\x22voltage\x22:252.45}'));sen[_0x50b8('0x71')](JSON[_0x50b8('0x6f')](_0x50b8('0x75')));console[_0x50b8('0x76')](_0x50b8('0x77'));console[_0x50b8('0x76')](sen['buffer']);});});});