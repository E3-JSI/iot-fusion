var _0x550c=['removeFolder','createFolder','./db2/','Base','createClean','nodes','close','initialization','base\x20saved','base','equal','rawstore','name','check\x20store\x20structure','deepEqual','fields','Time','datetime','float','power','aggregates\x20initialized\x20-\x20number','keys','aggregate','length','aggregates\x20initialized\x20-\x20key\x20names','current|tick','current|winbuf|3600000','current|winbuf|86400000','current|winbuf|604800000','voltage|tick','voltage|winbuf|3600000','voltage|max|21600000','voltage|min|21600000','voltage|winbuf|86400000','config\x20saved','config','fusionNodeI\x20correctly\x20saved','fusionNodeI','callback\x20function\x20should\x20be\x20set','processRecordCb','function','parent\x20saved','parent','buffer\x20empty','buffer','buffer\x20position\x20is\x200','position','master\x20flag\x20set\x20correctly','isMaster\x20function','isMaster','connectToKafka\x20function\x20exists','connectToKafka','broadcastAggregates\x20function\x20exists','broadcastAggregates','createAggregates\x20function\x20exists','createAggregates','offsetExists\x20function\x20exists','offsetExists','deleteObsoleteRows\x20function\x20exists','checkDataAvailability','setSlaveOffset','getOffsetTimestamp\x20function\x20exists','getOffsetTimestamp','getAggregates\x20function\x20exists','getAggregates','getPartialFeatureVector\x20function\x20exists','master\x20set\x20correctly','setMasterOffset','slave\x20offset\x20set\x20correctly:\x20no\x20data','data\x20insertion','data\x20record\x20saved\x20correctly','processRecord','parse','{\x22timestamp\x22:1538737201000,\x22current\x22:13,\x22voltage\x22:242.45}','{\x22timestamp\x22:1538737202000,\x22current\x22:14,\x22voltage\x22:252.45}','{\x22timestamp\x22:1538737213000,\x22current\x22:15,\x22voltage\x22:262.45}','{\x22timestamp\x22:1538737201000,\x22current\x22:17,\x22voltage\x22:242.45}','{\x22timestamp\x22:1538737202000,\x22current\x22:18,\x22voltage\x22:252.45}','{\x22timestamp\x22:1538737213000,\x22current\x22:19,\x22voltage\x22:262.45}','log','../nodes/streamingNode.js','../nodes/streamingEnergyNode.js','../nodes/streamingWeatherNode.js','../nodes/streamingStaticNode.js','../nodes/streamingSubstationNode.js','../common/utils/fileManager.js','qminer','assert','current','winbuf','max','min','variance','voltage','holiday','N1_24h','kafka','Substation','value','current|ma|3600000','voltage|ma|3600000','current|ma|21600000','current|max|21600000','current|min|21600000','current|variance|21600000','voltage|variance|21600000','current|ma|86400000','current|max|86400000','current|min|86400000','current|variance|86400000','voltage|ma|86400000','voltage|max|86400000','voltage|min|86400000','current|ma|604800000','voltage|ma|604800000','timeOfDay','weekEnd','dayAfterHoliday','dayBeforeHoliday','dayOfWeek','monthOfYear','weather','temperature1','humidity1','pressure1','windSpeed1','windBearing1','cloudCover1','streamingSubstationNode'];(function(_0x1960e4,_0x3ab3b3){var _0x357dfa=function(_0x58a55b){while(--_0x58a55b){_0x1960e4['push'](_0x1960e4['shift']());}};var _0x5dc59b=function(){var _0x22d48d={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x1b493b,_0x2a708b,_0x2706a4,_0x50f6d3){_0x50f6d3=_0x50f6d3||{};var _0x11652c=_0x2a708b+'='+_0x2706a4;var _0x28aa13=0x0;for(var _0x28aa13=0x0,_0x443022=_0x1b493b['length'];_0x28aa13<_0x443022;_0x28aa13++){var _0x59faa3=_0x1b493b[_0x28aa13];_0x11652c+=';\x20'+_0x59faa3;var _0x3143f2=_0x1b493b[_0x59faa3];_0x1b493b['push'](_0x3143f2);_0x443022=_0x1b493b['length'];if(_0x3143f2!==!![]){_0x11652c+='='+_0x3143f2;}}_0x50f6d3['cookie']=_0x11652c;},'removeCookie':function(){return'dev';},'getCookie':function(_0x373659,_0x33f791){_0x373659=_0x373659||function(_0xbb9294){return _0xbb9294;};var _0x2073b0=_0x373659(new RegExp('(?:^|;\x20)'+_0x33f791['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x5308af=function(_0x270e67,_0xa39145){_0x270e67(++_0xa39145);};_0x5308af(_0x357dfa,_0x3ab3b3);return _0x2073b0?decodeURIComponent(_0x2073b0[0x1]):undefined;}};var _0x45e9bd=function(){var _0x2c94ea=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x2c94ea['test'](_0x22d48d['removeCookie']['toString']());};_0x22d48d['updateCookie']=_0x45e9bd;var _0xc85cf3='';var _0x40c51b=_0x22d48d['updateCookie']();if(!_0x40c51b){_0x22d48d['setCookie'](['*'],'counter',0x1);}else if(_0x40c51b){_0xc85cf3=_0x22d48d['getCookie'](null,'counter');}else{_0x22d48d['removeCookie']();}};_0x5dc59b();}(_0x550c,0xd1));var _0x56ae=function(_0x542f36,_0x44f787){_0x542f36=_0x542f36-0x0;var _0x4de5bd=_0x550c[_0x542f36];return _0x4de5bd;};var _0x5be702=function(){var _0x408b0c=!![];return function(_0x2eb11c,_0x3f6f9c){var _0x2752d3=_0x408b0c?function(){if(_0x3f6f9c){var _0x1da5e2=_0x3f6f9c['apply'](_0x2eb11c,arguments);_0x3f6f9c=null;return _0x1da5e2;}}:function(){};_0x408b0c=![];return _0x2752d3;};}();var _0x523cd2=_0x5be702(this,function(){var _0x33cd73=function(){return'\x64\x65\x76';},_0x3fc458=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x180bff=function(){var _0x3e3113=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x3e3113['\x74\x65\x73\x74'](_0x33cd73['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x27c417=function(){var _0x550ce1=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x550ce1['\x74\x65\x73\x74'](_0x3fc458['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x16789c=function(_0x9320da){var _0x1cc5d0=~-0x1>>0x1+0xff%0x0;if(_0x9320da['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x1cc5d0)){_0x2ca27b(_0x9320da);}};var _0x2ca27b=function(_0x1855ea){var _0x542eea=~-0x4>>0x1+0xff%0x0;if(_0x1855ea['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x542eea){_0x16789c(_0x1855ea);}};if(!_0x180bff()){if(!_0x27c417()){_0x16789c('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x16789c('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x16789c('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x523cd2();const streamingNode=require(_0x56ae('0x0'));const streamingEnergyNode=require(_0x56ae('0x1'));const streamingWeatherNode=require(_0x56ae('0x2'));const streamingStaticNode=require(_0x56ae('0x3'));const streamingTrainNode=require('../nodes/streamingTrainNode.js');const streamingSubstationNode=require(_0x56ae('0x4'));const fileManager=require(_0x56ae('0x5'));const qm=require(_0x56ae('0x6'));const fs=require('fs');var assert=require(_0x56ae('0x7'));let connectionConfig={'zookeeper':'192.168.85.98:2181'};let aggrConfigs={'Substation':[{'field':_0x56ae('0x8'),'tick':[{'type':_0x56ae('0x9'),'winsize':0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]},{'type':_0x56ae('0x9'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x56ae('0xa')},{'type':'min'},{'type':'variance'}]},{'type':_0x56ae('0x9'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':'max'},{'type':_0x56ae('0xb')},{'type':_0x56ae('0xc')}]},{'type':_0x56ae('0x9'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]},{'field':_0x56ae('0xd'),'tick':[{'type':_0x56ae('0x9'),'winsize':0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]},{'type':'winbuf','winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x56ae('0xa')},{'type':_0x56ae('0xb')},{'type':_0x56ae('0xc')}]},{'type':'winbuf','winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':'max'},{'type':_0x56ae('0xb')},{'type':'variance'}]},{'type':'winbuf','winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}],'weather':[],'static':[{'field':_0x56ae('0xe'),'tick':[{'type':_0x56ae('0x9'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]};let fusionConfig={'fusionModel':_0x56ae('0xf'),'connection':{'type':_0x56ae('0x10')},'fusionTick':0x3e8,'nodes':[{'type':_0x56ae('0x11'),'fusionTick':0x3e8,'nodeid':'N1','aggrConfigId':_0x56ae('0x11'),'master':!![],'attributes':[{'time':0x0,'attributes':[{'type':'value','name':'current|ma|000'},{'type':'value','name':'voltage|ma|000'}]},{'time':-0xe10*0x3e8,'attributes':[{'type':_0x56ae('0x12'),'name':_0x56ae('0x13')},{'type':_0x56ae('0x12'),'name':_0x56ae('0x14')}]},{'time':-0x6*0xe10*0x3e8,'attributes':[{'type':_0x56ae('0x12'),'name':_0x56ae('0x15')},{'type':'value','name':_0x56ae('0x16')},{'type':_0x56ae('0x12'),'name':_0x56ae('0x17')},{'type':_0x56ae('0x12'),'name':_0x56ae('0x18')},{'type':_0x56ae('0x12'),'name':'voltage|ma|21600000'},{'type':_0x56ae('0x12'),'name':'voltage|max|21600000'},{'type':_0x56ae('0x12'),'name':'voltage|min|21600000'},{'type':_0x56ae('0x12'),'name':_0x56ae('0x19')}]},{'time':-0x18*0xe10*0x3e8,'attributes':[{'type':'value','name':_0x56ae('0x1a')},{'type':'value','name':_0x56ae('0x1b')},{'type':_0x56ae('0x12'),'name':_0x56ae('0x1c')},{'type':_0x56ae('0x12'),'name':_0x56ae('0x1d')},{'type':_0x56ae('0x12'),'name':_0x56ae('0x1e')},{'type':_0x56ae('0x12'),'name':_0x56ae('0x1f')},{'type':_0x56ae('0x12'),'name':_0x56ae('0x20')},{'type':_0x56ae('0x12'),'name':'voltage|variance|86400000'}]},{'time':-0x7*0x18*0xe10*0x3e8,'attributes':[{'type':_0x56ae('0x12'),'name':_0x56ae('0x21')},{'type':'value','name':_0x56ae('0x22')}]}]},{'type':'static','nodeid':'S1','aggrConfigId':'static','master':![],'attributes':[{'time':0x18*0x168*0x3e8,'attributes':[{'type':_0x56ae('0x12'),'name':_0x56ae('0x23')},{'type':_0x56ae('0x12'),'name':_0x56ae('0x24')},{'type':'value','name':_0x56ae('0xe')},{'type':_0x56ae('0x12'),'name':_0x56ae('0x25')},{'type':_0x56ae('0x12'),'name':_0x56ae('0x26')},{'type':_0x56ae('0x12'),'name':_0x56ae('0x27')},{'type':'value','name':'dayOfYear'},{'type':_0x56ae('0x12'),'name':_0x56ae('0x28')}]}]},{'type':_0x56ae('0x29'),'nodeid':'W1','aggrConfigId':_0x56ae('0x29'),'master':![],'attributes':[{'time':0x0,'attributes':[{'type':'value','name':_0x56ae('0x2a')},{'type':'value','name':_0x56ae('0x2b')},{'type':'value','name':_0x56ae('0x2c')},{'type':_0x56ae('0x12'),'name':_0x56ae('0x2d')},{'type':_0x56ae('0x12'),'name':_0x56ae('0x2e')},{'type':_0x56ae('0x12'),'name':_0x56ae('0x2f')}]}]}]};function processRecordDummyCb(_0x14de77,_0x5a101a){return!![];}describe(_0x56ae('0x30'),function(){let _0x468813;let _0x2b1f27;before(function(){fileManager[_0x56ae('0x31')]('./db2/');fileManager[_0x56ae('0x32')](_0x56ae('0x33'));_0x468813=new qm[(_0x56ae('0x34'))]({'dbPath':_0x56ae('0x33'),'mode':_0x56ae('0x35')});sen=new streamingSubstationNode(_0x468813,connectionConfig,fusionConfig[_0x56ae('0x36')][0x0],aggrConfigs,processRecordDummyCb,0x63,null);});after(function(){_0x468813[_0x56ae('0x37')]();});describe(_0x56ae('0x38'),function(){it(_0x56ae('0x39'),function(){assert['equal'](_0x468813,sen[_0x56ae('0x3a')]);});it('check\x20if\x20store\x20exists',function(){assert[_0x56ae('0x3b')](sen[_0x56ae('0x3c')][_0x56ae('0x3d')],'N1');});it(_0x56ae('0x3e'),function(){assert[_0x56ae('0x3f')](sen['rawstore'][_0x56ae('0x40')],[{'id':0x0,'name':_0x56ae('0x41'),'type':_0x56ae('0x42'),'nullable':![],'internal':![],'primary':![]},{'id':0x1,'name':_0x56ae('0x8'),'type':_0x56ae('0x43'),'nullable':![],'internal':![],'primary':![]},{'id':0x2,'name':_0x56ae('0xd'),'type':_0x56ae('0x43'),'nullable':![],'internal':![],'primary':![]},{'id':0x3,'name':_0x56ae('0x44'),'type':'float','nullable':![],'internal':![],'primary':![]}]);});it(_0x56ae('0x45'),function(){assert['equal'](Object[_0x56ae('0x46')](sen[_0x56ae('0x47')])[_0x56ae('0x48')],0x1e);});it(_0x56ae('0x49'),function(){assert['deepEqual'](Object[_0x56ae('0x46')](sen[_0x56ae('0x47')]),[_0x56ae('0x4a'),_0x56ae('0x4b'),'current|ma|3600000','current|winbuf|21600000',_0x56ae('0x15'),'current|max|21600000',_0x56ae('0x17'),_0x56ae('0x18'),_0x56ae('0x4c'),_0x56ae('0x1a'),'current|max|86400000',_0x56ae('0x1c'),_0x56ae('0x1d'),_0x56ae('0x4d'),'current|ma|604800000',_0x56ae('0x4e'),_0x56ae('0x4f'),_0x56ae('0x14'),'voltage|winbuf|21600000','voltage|ma|21600000',_0x56ae('0x50'),_0x56ae('0x51'),'voltage|variance|21600000',_0x56ae('0x52'),_0x56ae('0x1e'),_0x56ae('0x1f'),_0x56ae('0x20'),'voltage|variance|86400000','voltage|winbuf|604800000',_0x56ae('0x22')]);});it(_0x56ae('0x53'),function(){assert['deepEqual'](sen[_0x56ae('0x54')],fusionConfig[_0x56ae('0x36')][0x0]);});it(_0x56ae('0x55'),function(){assert['equal'](sen[_0x56ae('0x56')],0x63);});it(_0x56ae('0x57'),function(){assert[_0x56ae('0x3b')](typeof sen[_0x56ae('0x58')],_0x56ae('0x59'));});it(_0x56ae('0x5a'),function(){assert[_0x56ae('0x3b')](sen[_0x56ae('0x5b')],null);});it(_0x56ae('0x5c'),function(){assert[_0x56ae('0x3f')](sen[_0x56ae('0x5d')],[]);});it(_0x56ae('0x5e'),function(){assert[_0x56ae('0x3b')](sen[_0x56ae('0x5f')],0x0);});it(_0x56ae('0x60'),function(){assert['equal'](sen['master'],!![]);});it(_0x56ae('0x61'),function(){assert[_0x56ae('0x3b')](sen[_0x56ae('0x62')](),!![]);});it(_0x56ae('0x63'),function(){assert[_0x56ae('0x3b')](typeof sen[_0x56ae('0x64')],_0x56ae('0x59'));});it(_0x56ae('0x65'),function(){assert[_0x56ae('0x3b')](typeof sen[_0x56ae('0x66')],_0x56ae('0x59'));});it(_0x56ae('0x67'),function(){assert['equal'](typeof sen[_0x56ae('0x68')],_0x56ae('0x59'));});it(_0x56ae('0x69'),function(){assert[_0x56ae('0x3b')](typeof sen[_0x56ae('0x6a')],_0x56ae('0x59'));});it(_0x56ae('0x6b'),function(){assert[_0x56ae('0x3b')](typeof sen['deleteObsoleteRows'],_0x56ae('0x59'));});it('checkDataAvailability\x20function\x20exists',function(){assert[_0x56ae('0x3b')](typeof sen[_0x56ae('0x6c')],_0x56ae('0x59'));});it('setSlaveOffset\x20function\x20exists',function(){assert[_0x56ae('0x3b')](typeof sen[_0x56ae('0x6d')],_0x56ae('0x59'));});it(_0x56ae('0x6e'),function(){assert[_0x56ae('0x3b')](typeof sen[_0x56ae('0x6f')],_0x56ae('0x59'));});it('setMasterOffset\x20function\x20exists',function(){assert[_0x56ae('0x3b')](typeof sen[_0x56ae('0x6f')],_0x56ae('0x59'));});it(_0x56ae('0x70'),function(){assert[_0x56ae('0x3b')](typeof sen[_0x56ae('0x71')],_0x56ae('0x59'));});it(_0x56ae('0x72'),function(){assert[_0x56ae('0x3b')](typeof sen['getPartialFeatureVector'],_0x56ae('0x59'));});it(_0x56ae('0x73'),function(){assert['equal'](sen['isMaster'](),!![]);});it('master\x20offset\x20set\x20correctly',function(){sen[_0x56ae('0x74')]();assert[_0x56ae('0x3b')](sen[_0x56ae('0x5f')],-0x1);});it(_0x56ae('0x75'),function(){assert[_0x56ae('0x3b')](sen[_0x56ae('0x6d')](0x0),![]);});});describe(_0x56ae('0x76'),function(){it(_0x56ae('0x77'),function(){sen['processRecord'](JSON['parse']('{\x22timestamp\x22:1538737200000,\x22current\x22:12,\x22voltage\x22:232.45}'));sen[_0x56ae('0x78')](JSON[_0x56ae('0x79')](_0x56ae('0x7a')));sen['processRecord'](JSON[_0x56ae('0x79')](_0x56ae('0x7b')));sen['processRecord'](JSON['parse'](_0x56ae('0x7c')));sen['processRecord'](JSON[_0x56ae('0x79')]('{\x22timestamp\x22:1538737200000,\x22current\x22:16,\x22voltage\x22:232.45}'));sen[_0x56ae('0x78')](JSON[_0x56ae('0x79')](_0x56ae('0x7d')));sen['processRecord'](JSON[_0x56ae('0x79')](_0x56ae('0x7e')));sen['processRecord'](JSON['parse'](_0x56ae('0x7f')));console[_0x56ae('0x80')]('buffer\x20values');console[_0x56ae('0x80')](sen['buffer']);});});});