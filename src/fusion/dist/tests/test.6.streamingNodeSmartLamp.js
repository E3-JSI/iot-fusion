var _0x5ccc=['max','variance','winbuf','pact','smartlamp','value','pact|ma|21600','dimml|ma|86400000','dimml|min|86400000','dimml|max|86400000','dimml|variance|86400000','streamingSmartLampNode','removeFolder','createFolder','./db4/','createClean','nodes','close','base\x20saved','base','check\x20if\x20store\x20exists','equal','rawstore','name','check\x20store\x20structure','deepEqual','fields','Time','float','aggregates\x20initialized\x20-\x20number','keys','length','aggregates\x20initialized\x20-\x20key\x20names','aggregate','dimml|tick','dimml|ma|21600000','dimml|min|21600000','dimml|max|21600000','dimml|variance|21600000','dimml|winbuf|604800000','dimml|ma|604800000','pact|winbuf|21600000','pact|ma|21600000','pact|min|21600000','pact|max|21600000','pact|variance|21600000','pact|winbuf|86400000','pact|min|86400000','pact|max|86400000','pact|variance|86400000','pact|winbuf|604800000','config','fusionNodeI\x20correctly\x20saved','fusionNodeI','callback\x20function\x20should\x20be\x20set','function','parent\x20saved','parent','buffer\x20empty','buffer\x20position\x20is\x200','position','master\x20flag\x20set\x20correctly','isMaster\x20function','isMaster','connectToKafka\x20function\x20exists','connectToKafka','broadcastAggregates\x20function\x20exists','broadcastAggregates','createAggregates\x20function\x20exists','createAggregates','offsetExists','deleteObsoleteRows\x20function\x20exists','deleteObsoleteRows','checkDataAvailability\x20function\x20exists','setSlaveOffset','getOffsetTimestamp\x20function\x20exists','getOffsetTimestamp','setMasterOffset\x20function\x20exists','getAggregates\x20function\x20exists','getAggregates','getPartialFeatureVector\x20function\x20exists','getPartialFeatureVector','master\x20set\x20correctly','master\x20offset\x20set\x20correctly','setMasterOffset','slave\x20offset\x20set\x20correctly:\x20no\x20data','data\x20record\x20saved\x20correctly','parse','processRecord','{\x22stampm\x22:\x201468493072000,\x20\x22pact\x22:\x201.0,\x20\x22dimml\x22:\x201\x20}','buffer','Empty\x20values\x20in\x20message\x20set\x20to\x200','{\x22stampm\x22:\x201468493073000}','stream\x20aggregates\x20calculated\x20correctly\x20for\x20#2\x20insertion','9\x20more\x20data\x20insertions','{\x22stampm\x22:',',\x22dimml\x22:\x20',',\x22pact\x22:\x20','duplicate\x20insertions\x20test','{\x22stampm\x22:\x201468493071000,\x20\x22pact\x22:\x200.0,\x20\x22dimml\x22:\x200\x20}','../nodes/streamingNode.js','../nodes/streamingWeatherNode.js','../nodes/streamingStaticNode.js','../nodes/streamingTimeValueNode.js','../nodes/streamingSmartLampNode.js','../../common/utils/fileManager.js','qminer','assert','192.168.85.98:2181','dimml','min'];(function(_0x36e920,_0x2fc182){var _0x554e06=function(_0x567f09){while(--_0x567f09){_0x36e920['push'](_0x36e920['shift']());}};var _0x4db8b5=function(){var _0x1fd187={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x2af8f3,_0x433b6a,_0x157b0c,_0x142c06){_0x142c06=_0x142c06||{};var _0x491361=_0x433b6a+'='+_0x157b0c;var _0x37c755=0x0;for(var _0x37c755=0x0,_0x442a58=_0x2af8f3['length'];_0x37c755<_0x442a58;_0x37c755++){var _0x500df0=_0x2af8f3[_0x37c755];_0x491361+=';\x20'+_0x500df0;var _0x50f7be=_0x2af8f3[_0x500df0];_0x2af8f3['push'](_0x50f7be);_0x442a58=_0x2af8f3['length'];if(_0x50f7be!==!![]){_0x491361+='='+_0x50f7be;}}_0x142c06['cookie']=_0x491361;},'removeCookie':function(){return'dev';},'getCookie':function(_0x37a5c7,_0x43d48a){_0x37a5c7=_0x37a5c7||function(_0x4df52c){return _0x4df52c;};var _0x3659ef=_0x37a5c7(new RegExp('(?:^|;\x20)'+_0x43d48a['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x427347=function(_0x4026f0,_0x4cf4f9){_0x4026f0(++_0x4cf4f9);};_0x427347(_0x554e06,_0x2fc182);return _0x3659ef?decodeURIComponent(_0x3659ef[0x1]):undefined;}};var _0x3529c1=function(){var _0x34430a=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x34430a['test'](_0x1fd187['removeCookie']['toString']());};_0x1fd187['updateCookie']=_0x3529c1;var _0x296c7e='';var _0x294228=_0x1fd187['updateCookie']();if(!_0x294228){_0x1fd187['setCookie'](['*'],'counter',0x1);}else if(_0x294228){_0x296c7e=_0x1fd187['getCookie'](null,'counter');}else{_0x1fd187['removeCookie']();}};_0x4db8b5();}(_0x5ccc,0x64));var _0x3c09=function(_0xb5a54d,_0x9a7955){_0xb5a54d=_0xb5a54d-0x0;var _0x531e9d=_0x5ccc[_0xb5a54d];return _0x531e9d;};var _0x4c4533=function(){var _0x599a45=!![];return function(_0x3bef25,_0x455c87){var _0x51c4a8=_0x599a45?function(){if(_0x455c87){var _0xe8716b=_0x455c87['apply'](_0x3bef25,arguments);_0x455c87=null;return _0xe8716b;}}:function(){};_0x599a45=![];return _0x51c4a8;};}();var _0x5e89fa=_0x4c4533(this,function(){var _0x2a1331=function(){return'\x64\x65\x76';},_0x52258a=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x132ccc=function(){var _0x95bd00=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x95bd00['\x74\x65\x73\x74'](_0x2a1331['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x47ec71=function(){var _0x578b6f=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x578b6f['\x74\x65\x73\x74'](_0x52258a['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x489323=function(_0x50cc94){var _0x5d4d25=~-0x1>>0x1+0xff%0x0;if(_0x50cc94['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x5d4d25)){_0x2458dd(_0x50cc94);}};var _0x2458dd=function(_0x2a6e9a){var _0x47bf38=~-0x4>>0x1+0xff%0x0;if(_0x2a6e9a['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x47bf38){_0x489323(_0x2a6e9a);}};if(!_0x132ccc()){if(!_0x47ec71()){_0x489323('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x489323('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x489323('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x5e89fa();const streamingNode=require(_0x3c09('0x0'));const streamingEnergyNode=require('../nodes/streamingEnergyNode.js');const streamingWeatherNode=require(_0x3c09('0x1'));const streamingStaticNode=require(_0x3c09('0x2'));const streamingTimeValueNode=require(_0x3c09('0x3'));const streamingSmartLampNode=require(_0x3c09('0x4'));const fileManager=require(_0x3c09('0x5'));const qm=require(_0x3c09('0x6'));const fs=require('fs');var assert=require(_0x3c09('0x7'));let connectionConfig={'zookeeper':_0x3c09('0x8')};let aggrConfigs={'smartlamp':[{'field':_0x3c09('0x9'),'tick':[{'type':'winbuf','winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x3c09('0xa')},{'type':_0x3c09('0xb')},{'type':_0x3c09('0xc')}]},{'type':_0x3c09('0xd'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x3c09('0xa')},{'type':_0x3c09('0xb')},{'type':_0x3c09('0xc')}]},{'type':_0x3c09('0xd'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]},{'field':_0x3c09('0xe'),'tick':[{'type':_0x3c09('0xd'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x3c09('0xa')},{'type':_0x3c09('0xb')},{'type':_0x3c09('0xc')}]},{'type':_0x3c09('0xd'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x3c09('0xa')},{'type':_0x3c09('0xb')},{'type':_0x3c09('0xc')}]},{'type':_0x3c09('0xd'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]};let fusionConfig={'fusionModel':_0x3c09('0xf'),'connection':{'type':'mqtt'},'fusionTick':0x3c*0x3c*0x3e8,'nodes':[{'type':'smartlamp','nodeid':_0x3c09('0xf'),'aggrConfigId':'smartlamp','master':!![],'attributes':[{'time':0x0,'attributes':[{'type':_0x3c09('0x10'),'name':_0x3c09('0x9')},{'type':_0x3c09('0x10'),'name':_0x3c09('0x11')},{'type':_0x3c09('0x10'),'name':_0x3c09('0x12')},{'type':_0x3c09('0x10'),'name':_0x3c09('0x13')},{'type':_0x3c09('0x10'),'name':_0x3c09('0x14')},{'type':_0x3c09('0x10'),'name':'dimml|variance|86400000'}]},{'time':-0x18*0x3c*0x3c*0x3e8,'attributes':[{'type':_0x3c09('0x10'),'name':_0x3c09('0x9')},{'type':'value','name':_0x3c09('0xe')},{'type':_0x3c09('0x10'),'name':_0x3c09('0x12')},{'type':_0x3c09('0x10'),'name':_0x3c09('0x13')},{'type':_0x3c09('0x10'),'name':_0x3c09('0x14')},{'type':'value','name':_0x3c09('0x15')}]}]}]};function processRecordDummyCb(_0x2e2e73,_0x5655c7){return!![];}describe(_0x3c09('0x16'),function(){let _0x375475;let _0x1c0fcd;before(function(){fileManager[_0x3c09('0x17')]('./db4/');fileManager[_0x3c09('0x18')](_0x3c09('0x19'));_0x375475=new qm['Base']({'dbPath':_0x3c09('0x19'),'mode':_0x3c09('0x1a')});ssln=new streamingSmartLampNode(_0x375475,connectionConfig,fusionConfig[_0x3c09('0x1b')][0x0],aggrConfigs,processRecordDummyCb,0x63,null);});after(function(){_0x375475[_0x3c09('0x1c')]();});describe('initialization',function(){it(_0x3c09('0x1d'),function(){assert['equal'](_0x375475,ssln[_0x3c09('0x1e')]);});it(_0x3c09('0x1f'),function(){assert[_0x3c09('0x20')](ssln[_0x3c09('0x21')][_0x3c09('0x22')],_0x3c09('0xf'));});it(_0x3c09('0x23'),function(){assert[_0x3c09('0x24')](ssln['rawstore'][_0x3c09('0x25')],[{'id':0x0,'name':_0x3c09('0x26'),'type':'datetime','nullable':![],'internal':![],'primary':![]},{'id':0x1,'name':_0x3c09('0xe'),'type':_0x3c09('0x27'),'nullable':![],'internal':![],'primary':![]},{'id':0x2,'name':'dimml','type':'float','nullable':![],'internal':![],'primary':![]}]);});it(_0x3c09('0x28'),function(){assert['equal'](Object[_0x3c09('0x29')](ssln['aggregate'])[_0x3c09('0x2a')],0x1a);});it(_0x3c09('0x2b'),function(){assert['deepEqual'](Object[_0x3c09('0x29')](ssln[_0x3c09('0x2c')]),[_0x3c09('0x2d'),'dimml|winbuf|21600000',_0x3c09('0x2e'),_0x3c09('0x2f'),_0x3c09('0x30'),_0x3c09('0x31'),'dimml|winbuf|86400000',_0x3c09('0x12'),_0x3c09('0x13'),'dimml|max|86400000',_0x3c09('0x15'),_0x3c09('0x32'),_0x3c09('0x33'),'pact|tick',_0x3c09('0x34'),_0x3c09('0x35'),_0x3c09('0x36'),_0x3c09('0x37'),_0x3c09('0x38'),_0x3c09('0x39'),'pact|ma|86400000',_0x3c09('0x3a'),_0x3c09('0x3b'),_0x3c09('0x3c'),_0x3c09('0x3d'),'pact|ma|604800000']);});it('config\x20saved',function(){assert['deepEqual'](ssln[_0x3c09('0x3e')],fusionConfig[_0x3c09('0x1b')][0x0]);});it(_0x3c09('0x3f'),function(){assert[_0x3c09('0x20')](ssln[_0x3c09('0x40')],0x63);});it(_0x3c09('0x41'),function(){assert[_0x3c09('0x20')](typeof ssln['processRecordCb'],_0x3c09('0x42'));});it(_0x3c09('0x43'),function(){assert[_0x3c09('0x20')](ssln[_0x3c09('0x44')],null);});it(_0x3c09('0x45'),function(){assert[_0x3c09('0x24')](ssln['buffer'],[]);});it(_0x3c09('0x46'),function(){assert[_0x3c09('0x20')](ssln[_0x3c09('0x47')],0x0);});it(_0x3c09('0x48'),function(){assert['equal'](ssln['master'],!![]);});it(_0x3c09('0x49'),function(){assert[_0x3c09('0x20')](ssln[_0x3c09('0x4a')](),!![]);});it(_0x3c09('0x4b'),function(){assert[_0x3c09('0x20')](typeof ssln[_0x3c09('0x4c')],_0x3c09('0x42'));});it(_0x3c09('0x4d'),function(){assert[_0x3c09('0x20')](typeof ssln[_0x3c09('0x4e')],'function');});it(_0x3c09('0x4f'),function(){assert[_0x3c09('0x20')](typeof ssln[_0x3c09('0x50')],'function');});it('offsetExists\x20function\x20exists',function(){assert[_0x3c09('0x20')](typeof ssln[_0x3c09('0x51')],_0x3c09('0x42'));});it(_0x3c09('0x52'),function(){assert[_0x3c09('0x20')](typeof ssln[_0x3c09('0x53')],'function');});it(_0x3c09('0x54'),function(){assert[_0x3c09('0x20')](typeof ssln['checkDataAvailability'],_0x3c09('0x42'));});it('setSlaveOffset\x20function\x20exists',function(){assert[_0x3c09('0x20')](typeof ssln[_0x3c09('0x55')],_0x3c09('0x42'));});it(_0x3c09('0x56'),function(){assert[_0x3c09('0x20')](typeof ssln[_0x3c09('0x57')],_0x3c09('0x42'));});it(_0x3c09('0x58'),function(){assert[_0x3c09('0x20')](typeof ssln['getOffsetTimestamp'],_0x3c09('0x42'));});it(_0x3c09('0x59'),function(){assert[_0x3c09('0x20')](typeof ssln[_0x3c09('0x5a')],_0x3c09('0x42'));});it(_0x3c09('0x5b'),function(){assert['equal'](typeof ssln[_0x3c09('0x5c')],_0x3c09('0x42'));});it(_0x3c09('0x5d'),function(){assert[_0x3c09('0x20')](ssln[_0x3c09('0x4a')](),!![]);});it(_0x3c09('0x5e'),function(){ssln[_0x3c09('0x5f')]();assert[_0x3c09('0x20')](ssln['position'],-0x1);});it(_0x3c09('0x60'),function(){assert[_0x3c09('0x20')](ssln[_0x3c09('0x55')](0x0),![]);});});describe('data\x20insertion',function(){it(_0x3c09('0x61'),function(){ssln['processRecord'](JSON[_0x3c09('0x62')]('{\x22stampm\x22:\x201468493071000,\x20\x22pact\x22:\x200.0,\x20\x22dimml\x22:\x200\x20}'));ssln[_0x3c09('0x63')](JSON[_0x3c09('0x62')](_0x3c09('0x64')));assert[_0x3c09('0x20')](ssln[_0x3c09('0x65')][_0x3c09('0x2a')],0x2);assert[_0x3c09('0x20')](ssln[_0x3c09('0x65')][0x0][_0x3c09('0x9')],0x0);assert[_0x3c09('0x20')](ssln['buffer'][0x1]['pact'],0x1);});it(_0x3c09('0x66'),function(){ssln[_0x3c09('0x63')](JSON[_0x3c09('0x62')](_0x3c09('0x67')));assert[_0x3c09('0x20')](ssln[_0x3c09('0x65')]['length'],0x3);assert[_0x3c09('0x20')](ssln[_0x3c09('0x65')][0x2][_0x3c09('0x9')],0x0);});it(_0x3c09('0x68'),function(){assert[_0x3c09('0x24')](ssln[_0x3c09('0x65')][0x1],{'stampm':0x155e9020680,'dimml':0x1,'dimml|max|21600000':0x1,'dimml|max|86400000':0x1,'dimml|ma|21600000':0.5,'dimml|ma|604800000':0.5,'dimml|ma|86400000':0.5,'dimml|min|21600000':0x0,'dimml|min|86400000':0x0,'dimml|variance|21600000':0.5,'dimml|variance|86400000':0.5,'pact':0x1,'pact|max|21600000':0x1,'pact|max|86400000':0x1,'pact|ma|21600000':0.5,'pact|ma|604800000':0.5,'pact|ma|86400000':0.5,'pact|min|21600000':0x0,'pact|min|86400000':0x0,'pact|variance|21600000':0.5,'pact|variance|86400000':0.5});});it(_0x3c09('0x69'),function(){for(let _0x3da419=0x1;_0x3da419<=0x9;_0x3da419++){let _0x3302ef=0x155e9020a68+_0x3da419*0x3e8;let _0x1fa5de=_0x3da419+0x1;let _0x1826ba=_0x3da419+0x1;ssln[_0x3c09('0x63')](JSON['parse'](_0x3c09('0x6a')+_0x3302ef+_0x3c09('0x6b')+_0x1fa5de+_0x3c09('0x6c')+_0x1826ba+'}'));}assert[_0x3c09('0x20')](ssln['buffer'][_0x3c09('0x2a')],0xc);assert[_0x3c09('0x24')](ssln[_0x3c09('0x65')][0xb],{'stampm':0x155e9022d90,'dimml':0xa,'dimml|max|21600000':0xa,'dimml|max|86400000':0xa,'dimml|ma|21600000':4.583333333333333,'dimml|ma|604800000':4.583333333333333,'dimml|ma|86400000':4.583333333333333,'dimml|min|21600000':0x0,'dimml|min|86400000':0x0,'dimml|variance|21600000':12.083333333333336,'dimml|variance|86400000':12.083333333333336,'pact':0xa,'pact|max|21600000':0xa,'pact|max|86400000':0xa,'pact|ma|21600000':4.583333333333333,'pact|ma|604800000':4.583333333333333,'pact|ma|86400000':4.583333333333333,'pact|min|21600000':0x0,'pact|min|86400000':0x0,'pact|variance|21600000':12.083333333333336,'pact|variance|86400000':12.083333333333336});});it(_0x3c09('0x6d'),function(){ssln[_0x3c09('0x63')](JSON[_0x3c09('0x62')](_0x3c09('0x6e')));ssln[_0x3c09('0x63')](JSON['parse'](_0x3c09('0x64')));assert[_0x3c09('0x20')](ssln[_0x3c09('0x65')]['length'],0xc);});});});