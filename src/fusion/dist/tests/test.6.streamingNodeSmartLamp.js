var _0x1e29=['parse','{\x22stampm\x22:\x201468493071000,\x20\x22pact\x22:\x200.0,\x20\x22dimml\x22:\x200\x20}','{\x22stampm\x22:\x201468493072000,\x20\x22pact\x22:\x201.0,\x20\x22dimml\x22:\x201\x20}','Empty\x20values\x20in\x20message\x20set\x20to\x200','{\x22stampm\x22:\x201468493073000}','9\x20more\x20data\x20insertions','{\x22stampm\x22:',',\x22pact\x22:\x20','length','duplicate\x20insertions\x20test','../nodes/streamingNode.js','../nodes/streamingEnergyNode.js','../nodes/streamingWeatherNode.js','../nodes/streamingStaticNode.js','../nodes/streamingTimeValueNode.js','../nodes/streamingSmartLampNode.js','../common/utils/fileManager.js','qminer','192.168.85.98:2181','dimml','winbuf','min','variance','max','pact','mqtt','smartlamp','value','pact|ma|21600','dimml|ma|86400000','dimml|min|86400000','dimml|max|86400000','removeFolder','./db4/','createFolder','Base','createClean','close','initialization','base\x20saved','equal','base','name','check\x20store\x20structure','deepEqual','rawstore','fields','Time','datetime','float','aggregates\x20initialized\x20-\x20number','keys','aggregate','aggregates\x20initialized\x20-\x20key\x20names','dimml|max|21600000','dimml|variance|21600000','pact|tick','pact|winbuf|21600000','pact|min|21600000','pact|winbuf|86400000','pact|ma|86400000','pact|min|86400000','pact|max|86400000','pact|variance|86400000','pact|ma|604800000','config\x20saved','config','nodes','fusionNodeI\x20correctly\x20saved','fusionNodeI','callback\x20function\x20should\x20be\x20set','function','parent\x20saved','buffer\x20empty','buffer','buffer\x20position\x20is\x200','position','master\x20flag\x20set\x20correctly','master','isMaster\x20function','isMaster','connectToKafka\x20function\x20exists','broadcastAggregates\x20function\x20exists','broadcastAggregates','createAggregates','deleteObsoleteRows\x20function\x20exists','deleteObsoleteRows','checkDataAvailability\x20function\x20exists','setSlaveOffset','getOffsetTimestamp\x20function\x20exists','getOffsetTimestamp','getAggregates\x20function\x20exists','getPartialFeatureVector\x20function\x20exists','getPartialFeatureVector','master\x20set\x20correctly','slave\x20offset\x20set\x20correctly:\x20no\x20data','data\x20insertion','data\x20record\x20saved\x20correctly','processRecord'];(function(_0x10ee2b,_0x42b076){var _0xce772c=function(_0x22e8fc){while(--_0x22e8fc){_0x10ee2b['push'](_0x10ee2b['shift']());}};var _0x3bef63=function(){var _0x4fb449={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x5ee53f,_0x57bc20,_0x21f8e3,_0x4616fb){_0x4616fb=_0x4616fb||{};var _0x56308b=_0x57bc20+'='+_0x21f8e3;var _0x8a5f79=0x0;for(var _0x8a5f79=0x0,_0x51091a=_0x5ee53f['length'];_0x8a5f79<_0x51091a;_0x8a5f79++){var _0x452bad=_0x5ee53f[_0x8a5f79];_0x56308b+=';\x20'+_0x452bad;var _0x315385=_0x5ee53f[_0x452bad];_0x5ee53f['push'](_0x315385);_0x51091a=_0x5ee53f['length'];if(_0x315385!==!![]){_0x56308b+='='+_0x315385;}}_0x4616fb['cookie']=_0x56308b;},'removeCookie':function(){return'dev';},'getCookie':function(_0x36a7d2,_0x3fbf66){_0x36a7d2=_0x36a7d2||function(_0x2a8abe){return _0x2a8abe;};var _0x1f8937=_0x36a7d2(new RegExp('(?:^|;\x20)'+_0x3fbf66['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x2d3580=function(_0x44c81e,_0x1b5c60){_0x44c81e(++_0x1b5c60);};_0x2d3580(_0xce772c,_0x42b076);return _0x1f8937?decodeURIComponent(_0x1f8937[0x1]):undefined;}};var _0xced13f=function(){var _0x32b0d8=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x32b0d8['test'](_0x4fb449['removeCookie']['toString']());};_0x4fb449['updateCookie']=_0xced13f;var _0x2ccce0='';var _0x5ea509=_0x4fb449['updateCookie']();if(!_0x5ea509){_0x4fb449['setCookie'](['*'],'counter',0x1);}else if(_0x5ea509){_0x2ccce0=_0x4fb449['getCookie'](null,'counter');}else{_0x4fb449['removeCookie']();}};_0x3bef63();}(_0x1e29,0x6d));var _0xf1ee=function(_0x33e037,_0x39c643){_0x33e037=_0x33e037-0x0;var _0x39460e=_0x1e29[_0x33e037];return _0x39460e;};var _0x393ded=function(){var _0x995edd=!![];return function(_0x3a4bbc,_0x203d35){var _0x363952=_0x995edd?function(){if(_0x203d35){var _0x18f98e=_0x203d35['apply'](_0x3a4bbc,arguments);_0x203d35=null;return _0x18f98e;}}:function(){};_0x995edd=![];return _0x363952;};}();var _0x26f8a5=_0x393ded(this,function(){var _0x4347ce=function(){return'\x64\x65\x76';},_0x50abbf=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0xc9a24f=function(){var _0xcf8690=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0xcf8690['\x74\x65\x73\x74'](_0x4347ce['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x543aef=function(){var _0x4a9a34=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x4a9a34['\x74\x65\x73\x74'](_0x50abbf['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x3e6e68=function(_0x81e07d){var _0x50a70a=~-0x1>>0x1+0xff%0x0;if(_0x81e07d['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x50a70a)){_0x8020ce(_0x81e07d);}};var _0x8020ce=function(_0x26e03e){var _0x778f59=~-0x4>>0x1+0xff%0x0;if(_0x26e03e['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x778f59){_0x3e6e68(_0x26e03e);}};if(!_0xc9a24f()){if(!_0x543aef()){_0x3e6e68('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x3e6e68('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x3e6e68('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x26f8a5();const streamingNode=require(_0xf1ee('0x0'));const streamingEnergyNode=require(_0xf1ee('0x1'));const streamingWeatherNode=require(_0xf1ee('0x2'));const streamingStaticNode=require(_0xf1ee('0x3'));const streamingTimeValueNode=require(_0xf1ee('0x4'));const streamingSmartLampNode=require(_0xf1ee('0x5'));const fileManager=require(_0xf1ee('0x6'));const qm=require(_0xf1ee('0x7'));const fs=require('fs');var assert=require('assert');let connectionConfig={'zookeeper':_0xf1ee('0x8')};let aggrConfigs={'smartlamp':[{'field':_0xf1ee('0x9'),'tick':[{'type':_0xf1ee('0xa'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0xf1ee('0xb')},{'type':'max'},{'type':_0xf1ee('0xc')}]},{'type':_0xf1ee('0xa'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0xf1ee('0xb')},{'type':_0xf1ee('0xd')},{'type':_0xf1ee('0xc')}]},{'type':_0xf1ee('0xa'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]},{'field':_0xf1ee('0xe'),'tick':[{'type':_0xf1ee('0xa'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0xf1ee('0xb')},{'type':'max'},{'type':_0xf1ee('0xc')}]},{'type':_0xf1ee('0xa'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':'min'},{'type':_0xf1ee('0xd')},{'type':'variance'}]},{'type':_0xf1ee('0xa'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]};let fusionConfig={'fusionModel':'smartlamp','connection':{'type':_0xf1ee('0xf')},'fusionTick':0x3c*0x3c*0x3e8,'nodes':[{'type':_0xf1ee('0x10'),'nodeid':_0xf1ee('0x10'),'aggrConfigId':'smartlamp','master':!![],'attributes':[{'time':0x0,'attributes':[{'type':_0xf1ee('0x11'),'name':_0xf1ee('0x9')},{'type':_0xf1ee('0x11'),'name':_0xf1ee('0x12')},{'type':_0xf1ee('0x11'),'name':_0xf1ee('0x13')},{'type':_0xf1ee('0x11'),'name':'dimml|min|86400000'},{'type':_0xf1ee('0x11'),'name':'dimml|max|86400000'},{'type':_0xf1ee('0x11'),'name':'dimml|variance|86400000'}]},{'time':-0x18*0x3c*0x3c*0x3e8,'attributes':[{'type':'value','name':_0xf1ee('0x9')},{'type':'value','name':_0xf1ee('0xe')},{'type':_0xf1ee('0x11'),'name':_0xf1ee('0x13')},{'type':_0xf1ee('0x11'),'name':_0xf1ee('0x14')},{'type':_0xf1ee('0x11'),'name':_0xf1ee('0x15')},{'type':_0xf1ee('0x11'),'name':'dimml|variance|86400000'}]}]}]};function processRecordDummyCb(_0x118a46,_0xf6d650){return!![];}describe('streamingSmartLampNode',function(){let _0xe0addf;let _0x17ec6f;before(function(){fileManager[_0xf1ee('0x16')](_0xf1ee('0x17'));fileManager[_0xf1ee('0x18')](_0xf1ee('0x17'));_0xe0addf=new qm[(_0xf1ee('0x19'))]({'dbPath':'./db4/','mode':_0xf1ee('0x1a')});ssln=new streamingSmartLampNode(_0xe0addf,connectionConfig,fusionConfig['nodes'][0x0],aggrConfigs,processRecordDummyCb,0x63,null);});after(function(){_0xe0addf[_0xf1ee('0x1b')]();});describe(_0xf1ee('0x1c'),function(){it(_0xf1ee('0x1d'),function(){assert[_0xf1ee('0x1e')](_0xe0addf,ssln[_0xf1ee('0x1f')]);});it('check\x20if\x20store\x20exists',function(){assert['equal'](ssln['rawstore'][_0xf1ee('0x20')],_0xf1ee('0x10'));});it(_0xf1ee('0x21'),function(){assert[_0xf1ee('0x22')](ssln[_0xf1ee('0x23')][_0xf1ee('0x24')],[{'id':0x0,'name':_0xf1ee('0x25'),'type':_0xf1ee('0x26'),'nullable':![],'internal':![],'primary':![]},{'id':0x1,'name':_0xf1ee('0xe'),'type':_0xf1ee('0x27'),'nullable':![],'internal':![],'primary':![]},{'id':0x2,'name':_0xf1ee('0x9'),'type':_0xf1ee('0x27'),'nullable':![],'internal':![],'primary':![]}]);});it(_0xf1ee('0x28'),function(){assert[_0xf1ee('0x1e')](Object[_0xf1ee('0x29')](ssln[_0xf1ee('0x2a')])['length'],0x1a);});it(_0xf1ee('0x2b'),function(){assert[_0xf1ee('0x22')](Object['keys'](ssln['aggregate']),['dimml|tick','dimml|winbuf|21600000','dimml|ma|21600000','dimml|min|21600000',_0xf1ee('0x2c'),_0xf1ee('0x2d'),'dimml|winbuf|86400000',_0xf1ee('0x13'),_0xf1ee('0x14'),_0xf1ee('0x15'),'dimml|variance|86400000','dimml|winbuf|604800000','dimml|ma|604800000',_0xf1ee('0x2e'),_0xf1ee('0x2f'),'pact|ma|21600000',_0xf1ee('0x30'),'pact|max|21600000','pact|variance|21600000',_0xf1ee('0x31'),_0xf1ee('0x32'),_0xf1ee('0x33'),_0xf1ee('0x34'),_0xf1ee('0x35'),'pact|winbuf|604800000',_0xf1ee('0x36')]);});it(_0xf1ee('0x37'),function(){assert[_0xf1ee('0x22')](ssln[_0xf1ee('0x38')],fusionConfig[_0xf1ee('0x39')][0x0]);});it(_0xf1ee('0x3a'),function(){assert[_0xf1ee('0x1e')](ssln[_0xf1ee('0x3b')],0x63);});it(_0xf1ee('0x3c'),function(){assert[_0xf1ee('0x1e')](typeof ssln['processRecordCb'],_0xf1ee('0x3d'));});it(_0xf1ee('0x3e'),function(){assert[_0xf1ee('0x1e')](ssln['parent'],null);});it(_0xf1ee('0x3f'),function(){assert[_0xf1ee('0x22')](ssln[_0xf1ee('0x40')],[]);});it(_0xf1ee('0x41'),function(){assert[_0xf1ee('0x1e')](ssln[_0xf1ee('0x42')],0x0);});it(_0xf1ee('0x43'),function(){assert['equal'](ssln[_0xf1ee('0x44')],!![]);});it(_0xf1ee('0x45'),function(){assert[_0xf1ee('0x1e')](ssln[_0xf1ee('0x46')](),!![]);});it(_0xf1ee('0x47'),function(){assert['equal'](typeof ssln['connectToKafka'],_0xf1ee('0x3d'));});it(_0xf1ee('0x48'),function(){assert[_0xf1ee('0x1e')](typeof ssln[_0xf1ee('0x49')],_0xf1ee('0x3d'));});it('createAggregates\x20function\x20exists',function(){assert[_0xf1ee('0x1e')](typeof ssln[_0xf1ee('0x4a')],_0xf1ee('0x3d'));});it('offsetExists\x20function\x20exists',function(){assert[_0xf1ee('0x1e')](typeof ssln['offsetExists'],_0xf1ee('0x3d'));});it(_0xf1ee('0x4b'),function(){assert[_0xf1ee('0x1e')](typeof ssln[_0xf1ee('0x4c')],_0xf1ee('0x3d'));});it(_0xf1ee('0x4d'),function(){assert[_0xf1ee('0x1e')](typeof ssln['checkDataAvailability'],'function');});it('setSlaveOffset\x20function\x20exists',function(){assert[_0xf1ee('0x1e')](typeof ssln[_0xf1ee('0x4e')],_0xf1ee('0x3d'));});it(_0xf1ee('0x4f'),function(){assert[_0xf1ee('0x1e')](typeof ssln['getOffsetTimestamp'],_0xf1ee('0x3d'));});it('setMasterOffset\x20function\x20exists',function(){assert['equal'](typeof ssln[_0xf1ee('0x50')],_0xf1ee('0x3d'));});it(_0xf1ee('0x51'),function(){assert['equal'](typeof ssln['getAggregates'],_0xf1ee('0x3d'));});it(_0xf1ee('0x52'),function(){assert[_0xf1ee('0x1e')](typeof ssln[_0xf1ee('0x53')],_0xf1ee('0x3d'));});it(_0xf1ee('0x54'),function(){assert[_0xf1ee('0x1e')](ssln[_0xf1ee('0x46')](),!![]);});it('master\x20offset\x20set\x20correctly',function(){ssln['setMasterOffset']();assert['equal'](ssln['position'],-0x1);});it(_0xf1ee('0x55'),function(){assert[_0xf1ee('0x1e')](ssln[_0xf1ee('0x4e')](0x0),![]);});});describe(_0xf1ee('0x56'),function(){it(_0xf1ee('0x57'),function(){ssln[_0xf1ee('0x58')](JSON[_0xf1ee('0x59')](_0xf1ee('0x5a')));ssln['processRecord'](JSON[_0xf1ee('0x59')](_0xf1ee('0x5b')));assert[_0xf1ee('0x1e')](ssln[_0xf1ee('0x40')]['length'],0x2);assert[_0xf1ee('0x1e')](ssln[_0xf1ee('0x40')][0x0][_0xf1ee('0x9')],0x0);assert[_0xf1ee('0x1e')](ssln[_0xf1ee('0x40')][0x1][_0xf1ee('0xe')],0x1);});it(_0xf1ee('0x5c'),function(){ssln[_0xf1ee('0x58')](JSON[_0xf1ee('0x59')](_0xf1ee('0x5d')));assert[_0xf1ee('0x1e')](ssln[_0xf1ee('0x40')]['length'],0x3);assert['equal'](ssln[_0xf1ee('0x40')][0x2]['dimml'],0x0);});it('stream\x20aggregates\x20calculated\x20correctly\x20for\x20#2\x20insertion',function(){assert[_0xf1ee('0x22')](ssln['buffer'][0x1],{'stampm':0x155e9020680,'dimml':0x1,'dimml|max|21600000':0x1,'dimml|max|86400000':0x1,'dimml|ma|21600000':0.5,'dimml|ma|604800000':0.5,'dimml|ma|86400000':0.5,'dimml|min|21600000':0x0,'dimml|min|86400000':0x0,'dimml|variance|21600000':0.5,'dimml|variance|86400000':0.5,'pact':0x1,'pact|max|21600000':0x1,'pact|max|86400000':0x1,'pact|ma|21600000':0.5,'pact|ma|604800000':0.5,'pact|ma|86400000':0.5,'pact|min|21600000':0x0,'pact|min|86400000':0x0,'pact|variance|21600000':0.5,'pact|variance|86400000':0.5});});it(_0xf1ee('0x5e'),function(){for(let _0xd5748d=0x1;_0xd5748d<=0x9;_0xd5748d++){let _0x3ce481=0x155e9020a68+_0xd5748d*0x3e8;let _0x31b953=_0xd5748d+0x1;let _0x50935e=_0xd5748d+0x1;ssln[_0xf1ee('0x58')](JSON['parse'](_0xf1ee('0x5f')+_0x3ce481+',\x22dimml\x22:\x20'+_0x31b953+_0xf1ee('0x60')+_0x50935e+'}'));}assert[_0xf1ee('0x1e')](ssln[_0xf1ee('0x40')][_0xf1ee('0x61')],0xc);assert[_0xf1ee('0x22')](ssln[_0xf1ee('0x40')][0xb],{'stampm':0x155e9022d90,'dimml':0xa,'dimml|max|21600000':0xa,'dimml|max|86400000':0xa,'dimml|ma|21600000':4.583333333333333,'dimml|ma|604800000':4.583333333333333,'dimml|ma|86400000':4.583333333333333,'dimml|min|21600000':0x0,'dimml|min|86400000':0x0,'dimml|variance|21600000':12.083333333333336,'dimml|variance|86400000':12.083333333333336,'pact':0xa,'pact|max|21600000':0xa,'pact|max|86400000':0xa,'pact|ma|21600000':4.583333333333333,'pact|ma|604800000':4.583333333333333,'pact|ma|86400000':4.583333333333333,'pact|min|21600000':0x0,'pact|min|86400000':0x0,'pact|variance|21600000':12.083333333333336,'pact|variance|86400000':12.083333333333336});});it(_0xf1ee('0x62'),function(){ssln[_0xf1ee('0x58')](JSON[_0xf1ee('0x59')](_0xf1ee('0x5a')));ssln[_0xf1ee('0x58')](JSON[_0xf1ee('0x59')]('{\x22stampm\x22:\x201468493072000,\x20\x22pact\x22:\x201.0,\x20\x22dimml\x22:\x201\x20}'));assert[_0xf1ee('0x1e')](ssln['buffer'][_0xf1ee('0x61')],0xc);});});});