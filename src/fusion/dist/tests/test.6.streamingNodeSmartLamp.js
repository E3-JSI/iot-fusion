var _0x2866=['setMasterOffset','data\x20insertion','processRecord','parse','{\x22stampm\x22:\x201468493071000,\x20\x22pact\x22:\x200.0,\x20\x22dimml\x22:\x200\x20}','Empty\x20values\x20in\x20message\x20set\x20to\x200','{\x22stampm\x22:\x201468493073000}','stream\x20aggregates\x20calculated\x20correctly\x20for\x20#2\x20insertion','{\x22stampm\x22:',',\x22dimml\x22:\x20',',\x22pact\x22:\x20','duplicate\x20insertions\x20test','{\x22stampm\x22:\x201468493072000,\x20\x22pact\x22:\x201.0,\x20\x22dimml\x22:\x201\x20}','../nodes/streamingNode.js','../nodes/streamingEnergyNode.js','../nodes/streamingWeatherNode.js','../nodes/streamingTimeValueNode.js','../../common/utils/fileManager.js','qminer','assert','192.168.85.98:2181','dimml','winbuf','min','max','variance','smartlamp','mqtt','value','pact|ma|21600','dimml|ma|86400000','dimml|min|86400000','dimml|max|86400000','dimml|variance|86400000','pact','streamingSmartLampNode','./db4/','createFolder','nodes','initialization','base\x20saved','equal','base','check\x20if\x20store\x20exists','rawstore','name','deepEqual','fields','datetime','float','aggregates\x20initialized\x20-\x20number','keys','aggregate','length','aggregates\x20initialized\x20-\x20key\x20names','dimml|tick','dimml|winbuf|21600000','dimml|ma|21600000','dimml|max|21600000','dimml|variance|21600000','dimml|winbuf|86400000','dimml|winbuf|604800000','dimml|ma|604800000','pact|winbuf|21600000','pact|ma|21600000','pact|min|21600000','pact|max|21600000','pact|variance|21600000','pact|ma|86400000','pact|max|86400000','pact|variance|86400000','pact|ma|604800000','config','fusionNodeI\x20correctly\x20saved','fusionNodeI','callback\x20function\x20should\x20be\x20set','processRecordCb','function','parent\x20saved','parent','buffer','buffer\x20position\x20is\x200','position','master\x20flag\x20set\x20correctly','master','isMaster\x20function','isMaster','connectToKafka\x20function\x20exists','connectToKafka','broadcastAggregates','createAggregates\x20function\x20exists','createAggregates','offsetExists\x20function\x20exists','deleteObsoleteRows\x20function\x20exists','deleteObsoleteRows','checkDataAvailability\x20function\x20exists','checkDataAvailability','setSlaveOffset','getOffsetTimestamp\x20function\x20exists','setMasterOffset\x20function\x20exists','getOffsetTimestamp','getAggregates','getPartialFeatureVector\x20function\x20exists','getPartialFeatureVector','master\x20offset\x20set\x20correctly'];(function(_0x254c17,_0x23dddd){var _0x4987f1=function(_0x1a2bcd){while(--_0x1a2bcd){_0x254c17['push'](_0x254c17['shift']());}};var _0x2a462c=function(){var _0x4aac3a={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x1e1218,_0x3660ff,_0x477d59,_0x2b121d){_0x2b121d=_0x2b121d||{};var _0x303f76=_0x3660ff+'='+_0x477d59;var _0x343769=0x0;for(var _0x343769=0x0,_0x3cf37c=_0x1e1218['length'];_0x343769<_0x3cf37c;_0x343769++){var _0x239cbb=_0x1e1218[_0x343769];_0x303f76+=';\x20'+_0x239cbb;var _0x453b45=_0x1e1218[_0x239cbb];_0x1e1218['push'](_0x453b45);_0x3cf37c=_0x1e1218['length'];if(_0x453b45!==!![]){_0x303f76+='='+_0x453b45;}}_0x2b121d['cookie']=_0x303f76;},'removeCookie':function(){return'dev';},'getCookie':function(_0x25d2fd,_0x2f77c6){_0x25d2fd=_0x25d2fd||function(_0x1f9134){return _0x1f9134;};var _0x2e6618=_0x25d2fd(new RegExp('(?:^|;\x20)'+_0x2f77c6['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x217301=function(_0x38a249,_0x55a78f){_0x38a249(++_0x55a78f);};_0x217301(_0x4987f1,_0x23dddd);return _0x2e6618?decodeURIComponent(_0x2e6618[0x1]):undefined;}};var _0x29e08d=function(){var _0x4e8d0b=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x4e8d0b['test'](_0x4aac3a['removeCookie']['toString']());};_0x4aac3a['updateCookie']=_0x29e08d;var _0x14436b='';var _0x5b3784=_0x4aac3a['updateCookie']();if(!_0x5b3784){_0x4aac3a['setCookie'](['*'],'counter',0x1);}else if(_0x5b3784){_0x14436b=_0x4aac3a['getCookie'](null,'counter');}else{_0x4aac3a['removeCookie']();}};_0x2a462c();}(_0x2866,0x76));var _0x1e9a=function(_0x3470b5,_0x1743be){_0x3470b5=_0x3470b5-0x0;var _0xa9ac32=_0x2866[_0x3470b5];return _0xa9ac32;};var _0x2eac6a=function(){var _0x1f1d39=!![];return function(_0x38840c,_0x13b0ac){var _0x24b3f2=_0x1f1d39?function(){if(_0x13b0ac){var _0x3c06ae=_0x13b0ac['apply'](_0x38840c,arguments);_0x13b0ac=null;return _0x3c06ae;}}:function(){};_0x1f1d39=![];return _0x24b3f2;};}();var _0x18c5cd=_0x2eac6a(this,function(){var _0x1314b0=function(){return'\x64\x65\x76';},_0x2f1e84=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x4e32b4=function(){var _0x3aad0c=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x3aad0c['\x74\x65\x73\x74'](_0x1314b0['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x30dd2a=function(){var _0x73f226=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x73f226['\x74\x65\x73\x74'](_0x2f1e84['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x3c1bcc=function(_0x492dd3){var _0x110f1a=~-0x1>>0x1+0xff%0x0;if(_0x492dd3['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x110f1a)){_0x41bf81(_0x492dd3);}};var _0x41bf81=function(_0x547c83){var _0x22fda5=~-0x4>>0x1+0xff%0x0;if(_0x547c83['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x22fda5){_0x3c1bcc(_0x547c83);}};if(!_0x4e32b4()){if(!_0x30dd2a()){_0x3c1bcc('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x3c1bcc('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x3c1bcc('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x18c5cd();const streamingNode=require(_0x1e9a('0x0'));const streamingEnergyNode=require(_0x1e9a('0x1'));const streamingWeatherNode=require(_0x1e9a('0x2'));const streamingStaticNode=require('../nodes/streamingStaticNode.js');const streamingTimeValueNode=require(_0x1e9a('0x3'));const streamingSmartLampNode=require('../nodes/streamingSmartLampNode.js');const fileManager=require(_0x1e9a('0x4'));const qm=require(_0x1e9a('0x5'));const fs=require('fs');var assert=require(_0x1e9a('0x6'));let connectionConfig={'zookeeper':_0x1e9a('0x7')};let aggrConfigs={'smartlamp':[{'field':_0x1e9a('0x8'),'tick':[{'type':_0x1e9a('0x9'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x1e9a('0xa')},{'type':_0x1e9a('0xb')},{'type':_0x1e9a('0xc')}]},{'type':_0x1e9a('0x9'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':'min'},{'type':_0x1e9a('0xb')},{'type':'variance'}]},{'type':_0x1e9a('0x9'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]},{'field':'pact','tick':[{'type':'winbuf','winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':'min'},{'type':_0x1e9a('0xb')},{'type':_0x1e9a('0xc')}]},{'type':'winbuf','winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'},{'type':_0x1e9a('0xa')},{'type':_0x1e9a('0xb')},{'type':_0x1e9a('0xc')}]},{'type':_0x1e9a('0x9'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]};let fusionConfig={'fusionModel':_0x1e9a('0xd'),'connection':{'type':_0x1e9a('0xe')},'fusionTick':0x3c*0x3c*0x3e8,'nodes':[{'type':'smartlamp','nodeid':_0x1e9a('0xd'),'aggrConfigId':'smartlamp','master':!![],'attributes':[{'time':0x0,'attributes':[{'type':_0x1e9a('0xf'),'name':_0x1e9a('0x8')},{'type':_0x1e9a('0xf'),'name':_0x1e9a('0x10')},{'type':_0x1e9a('0xf'),'name':_0x1e9a('0x11')},{'type':_0x1e9a('0xf'),'name':_0x1e9a('0x12')},{'type':_0x1e9a('0xf'),'name':_0x1e9a('0x13')},{'type':_0x1e9a('0xf'),'name':_0x1e9a('0x14')}]},{'time':-0x18*0x3c*0x3c*0x3e8,'attributes':[{'type':_0x1e9a('0xf'),'name':_0x1e9a('0x8')},{'type':_0x1e9a('0xf'),'name':_0x1e9a('0x15')},{'type':_0x1e9a('0xf'),'name':_0x1e9a('0x11')},{'type':_0x1e9a('0xf'),'name':_0x1e9a('0x12')},{'type':'value','name':_0x1e9a('0x13')},{'type':_0x1e9a('0xf'),'name':_0x1e9a('0x14')}]}]}]};function processRecordDummyCb(_0x34aee6,_0x1de912){return!![];}describe(_0x1e9a('0x16'),function(){let _0x3229e0;let _0x2cb8ae;before(function(){fileManager['removeFolder'](_0x1e9a('0x17'));fileManager[_0x1e9a('0x18')](_0x1e9a('0x17'));_0x3229e0=new qm['Base']({'dbPath':_0x1e9a('0x17'),'mode':'createClean'});ssln=new streamingSmartLampNode(_0x3229e0,connectionConfig,fusionConfig[_0x1e9a('0x19')][0x0],aggrConfigs,processRecordDummyCb,0x63,null);});after(function(){_0x3229e0['close']();});describe(_0x1e9a('0x1a'),function(){it(_0x1e9a('0x1b'),function(){assert[_0x1e9a('0x1c')](_0x3229e0,ssln[_0x1e9a('0x1d')]);});it(_0x1e9a('0x1e'),function(){assert[_0x1e9a('0x1c')](ssln[_0x1e9a('0x1f')][_0x1e9a('0x20')],_0x1e9a('0xd'));});it('check\x20store\x20structure',function(){assert[_0x1e9a('0x21')](ssln['rawstore'][_0x1e9a('0x22')],[{'id':0x0,'name':'Time','type':_0x1e9a('0x23'),'nullable':![],'internal':![],'primary':![]},{'id':0x1,'name':_0x1e9a('0x15'),'type':'float','nullable':![],'internal':![],'primary':![]},{'id':0x2,'name':_0x1e9a('0x8'),'type':_0x1e9a('0x24'),'nullable':![],'internal':![],'primary':![]}]);});it(_0x1e9a('0x25'),function(){assert['equal'](Object[_0x1e9a('0x26')](ssln[_0x1e9a('0x27')])[_0x1e9a('0x28')],0x1a);});it(_0x1e9a('0x29'),function(){assert[_0x1e9a('0x21')](Object[_0x1e9a('0x26')](ssln['aggregate']),[_0x1e9a('0x2a'),_0x1e9a('0x2b'),_0x1e9a('0x2c'),'dimml|min|21600000',_0x1e9a('0x2d'),_0x1e9a('0x2e'),_0x1e9a('0x2f'),'dimml|ma|86400000',_0x1e9a('0x12'),'dimml|max|86400000',_0x1e9a('0x14'),_0x1e9a('0x30'),_0x1e9a('0x31'),'pact|tick',_0x1e9a('0x32'),_0x1e9a('0x33'),_0x1e9a('0x34'),_0x1e9a('0x35'),_0x1e9a('0x36'),'pact|winbuf|86400000',_0x1e9a('0x37'),'pact|min|86400000',_0x1e9a('0x38'),_0x1e9a('0x39'),'pact|winbuf|604800000',_0x1e9a('0x3a')]);});it('config\x20saved',function(){assert[_0x1e9a('0x21')](ssln[_0x1e9a('0x3b')],fusionConfig[_0x1e9a('0x19')][0x0]);});it(_0x1e9a('0x3c'),function(){assert[_0x1e9a('0x1c')](ssln[_0x1e9a('0x3d')],0x63);});it(_0x1e9a('0x3e'),function(){assert[_0x1e9a('0x1c')](typeof ssln[_0x1e9a('0x3f')],_0x1e9a('0x40'));});it(_0x1e9a('0x41'),function(){assert[_0x1e9a('0x1c')](ssln[_0x1e9a('0x42')],null);});it('buffer\x20empty',function(){assert[_0x1e9a('0x21')](ssln[_0x1e9a('0x43')],[]);});it(_0x1e9a('0x44'),function(){assert[_0x1e9a('0x1c')](ssln[_0x1e9a('0x45')],0x0);});it(_0x1e9a('0x46'),function(){assert[_0x1e9a('0x1c')](ssln[_0x1e9a('0x47')],!![]);});it(_0x1e9a('0x48'),function(){assert[_0x1e9a('0x1c')](ssln[_0x1e9a('0x49')](),!![]);});it(_0x1e9a('0x4a'),function(){assert[_0x1e9a('0x1c')](typeof ssln[_0x1e9a('0x4b')],_0x1e9a('0x40'));});it('broadcastAggregates\x20function\x20exists',function(){assert[_0x1e9a('0x1c')](typeof ssln[_0x1e9a('0x4c')],_0x1e9a('0x40'));});it(_0x1e9a('0x4d'),function(){assert[_0x1e9a('0x1c')](typeof ssln[_0x1e9a('0x4e')],_0x1e9a('0x40'));});it(_0x1e9a('0x4f'),function(){assert[_0x1e9a('0x1c')](typeof ssln['offsetExists'],_0x1e9a('0x40'));});it(_0x1e9a('0x50'),function(){assert[_0x1e9a('0x1c')](typeof ssln[_0x1e9a('0x51')],_0x1e9a('0x40'));});it(_0x1e9a('0x52'),function(){assert['equal'](typeof ssln[_0x1e9a('0x53')],_0x1e9a('0x40'));});it('setSlaveOffset\x20function\x20exists',function(){assert[_0x1e9a('0x1c')](typeof ssln[_0x1e9a('0x54')],'function');});it(_0x1e9a('0x55'),function(){assert[_0x1e9a('0x1c')](typeof ssln['getOffsetTimestamp'],'function');});it(_0x1e9a('0x56'),function(){assert[_0x1e9a('0x1c')](typeof ssln[_0x1e9a('0x57')],'function');});it('getAggregates\x20function\x20exists',function(){assert[_0x1e9a('0x1c')](typeof ssln[_0x1e9a('0x58')],_0x1e9a('0x40'));});it(_0x1e9a('0x59'),function(){assert[_0x1e9a('0x1c')](typeof ssln[_0x1e9a('0x5a')],_0x1e9a('0x40'));});it('master\x20set\x20correctly',function(){assert['equal'](ssln[_0x1e9a('0x49')](),!![]);});it(_0x1e9a('0x5b'),function(){ssln[_0x1e9a('0x5c')]();assert[_0x1e9a('0x1c')](ssln[_0x1e9a('0x45')],-0x1);});it('slave\x20offset\x20set\x20correctly:\x20no\x20data',function(){assert[_0x1e9a('0x1c')](ssln[_0x1e9a('0x54')](0x0),![]);});});describe(_0x1e9a('0x5d'),function(){it('data\x20record\x20saved\x20correctly',function(){ssln[_0x1e9a('0x5e')](JSON[_0x1e9a('0x5f')](_0x1e9a('0x60')));ssln[_0x1e9a('0x5e')](JSON[_0x1e9a('0x5f')]('{\x22stampm\x22:\x201468493072000,\x20\x22pact\x22:\x201.0,\x20\x22dimml\x22:\x201\x20}'));assert[_0x1e9a('0x1c')](ssln[_0x1e9a('0x43')][_0x1e9a('0x28')],0x2);assert[_0x1e9a('0x1c')](ssln[_0x1e9a('0x43')][0x0][_0x1e9a('0x8')],0x0);assert[_0x1e9a('0x1c')](ssln[_0x1e9a('0x43')][0x1]['pact'],0x1);});it(_0x1e9a('0x61'),function(){ssln[_0x1e9a('0x5e')](JSON[_0x1e9a('0x5f')](_0x1e9a('0x62')));assert[_0x1e9a('0x1c')](ssln[_0x1e9a('0x43')]['length'],0x3);assert['equal'](ssln[_0x1e9a('0x43')][0x2][_0x1e9a('0x8')],0x0);});it(_0x1e9a('0x63'),function(){assert[_0x1e9a('0x21')](ssln[_0x1e9a('0x43')][0x1],{'stampm':0x155e9020680,'dimml':0x1,'dimml|max|21600000':0x1,'dimml|max|86400000':0x1,'dimml|ma|21600000':0.5,'dimml|ma|604800000':0.5,'dimml|ma|86400000':0.5,'dimml|min|21600000':0x0,'dimml|min|86400000':0x0,'dimml|variance|21600000':0.5,'dimml|variance|86400000':0.5,'pact':0x1,'pact|max|21600000':0x1,'pact|max|86400000':0x1,'pact|ma|21600000':0.5,'pact|ma|604800000':0.5,'pact|ma|86400000':0.5,'pact|min|21600000':0x0,'pact|min|86400000':0x0,'pact|variance|21600000':0.5,'pact|variance|86400000':0.5});});it('9\x20more\x20data\x20insertions',function(){for(let _0x3ba9ee=0x1;_0x3ba9ee<=0x9;_0x3ba9ee++){let _0xfaca1a=0x155e9020a68+_0x3ba9ee*0x3e8;let _0x3e2865=_0x3ba9ee+0x1;let _0x23bd0a=_0x3ba9ee+0x1;ssln[_0x1e9a('0x5e')](JSON[_0x1e9a('0x5f')](_0x1e9a('0x64')+_0xfaca1a+_0x1e9a('0x65')+_0x3e2865+_0x1e9a('0x66')+_0x23bd0a+'}'));}assert[_0x1e9a('0x1c')](ssln[_0x1e9a('0x43')][_0x1e9a('0x28')],0xc);assert[_0x1e9a('0x21')](ssln[_0x1e9a('0x43')][0xb],{'stampm':0x155e9022d90,'dimml':0xa,'dimml|max|21600000':0xa,'dimml|max|86400000':0xa,'dimml|ma|21600000':4.583333333333333,'dimml|ma|604800000':4.583333333333333,'dimml|ma|86400000':4.583333333333333,'dimml|min|21600000':0x0,'dimml|min|86400000':0x0,'dimml|variance|21600000':12.083333333333336,'dimml|variance|86400000':12.083333333333336,'pact':0xa,'pact|max|21600000':0xa,'pact|max|86400000':0xa,'pact|ma|21600000':4.583333333333333,'pact|ma|604800000':4.583333333333333,'pact|ma|86400000':4.583333333333333,'pact|min|21600000':0x0,'pact|min|86400000':0x0,'pact|variance|21600000':12.083333333333336,'pact|variance|86400000':12.083333333333336});});it(_0x1e9a('0x67'),function(){ssln[_0x1e9a('0x5e')](JSON[_0x1e9a('0x5f')](_0x1e9a('0x60')));ssln[_0x1e9a('0x5e')](JSON[_0x1e9a('0x5f')](_0x1e9a('0x68')));assert[_0x1e9a('0x1c')](ssln[_0x1e9a('0x43')][_0x1e9a('0x28')],0xc);});});});