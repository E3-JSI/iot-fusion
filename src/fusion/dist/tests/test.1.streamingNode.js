var _0xf342=['getOffsetTimestamp','getAggregates\x20function\x20exists','getAggregates','getPartialFeatureVector\x20function\x20exists','getPartialFeatureVector','master\x20set\x20correctly','setMasterOffset','../nodes/streamingNode.js','../nodes/streamingWeatherNode.js','../nodes/streamingStaticNode.js','qminer','assert','192.168.85.98:2181','winbuf','variance','min','max','holiday','none','test','energy','pc|ma|3600000','pc|ma|21600000','value','pc|ma|604800000','pc|ma|2592000000','pc|min|86400000','pc|max|86400000','pc|max|604800000','pc|variance|21600000','pc|variance|86400000','static','timeOfDay','weekEnd','dayAfterHoliday','dayBeforeHoliday','dayOfYear','monthOfYear','weather','humidity24','pressure24','windSpeed24','windBearing24','cloudCover24','removeFolder','createFolder','./db2/','Base','createClean','nodes','initialization','base\x20saved','equal','base','aggregates\x20initialized','deepEqual','aggregate','config\x20saved','callback\x20function\x20should\x20be\x20set','processRecordCb','parent\x20saved','parent','buffer\x20empty','buffer\x20position\x20is\x200','master','isMaster\x20function','isMaster','connectToKafka\x20function\x20exists','connectToKafka','broadcastAggregates','function','createAggregates\x20function\x20exists','createAggregates','offsetExists\x20function\x20exists','deleteObsoleteRows\x20function\x20exists','deleteObsoleteRows','checkDataAvailability\x20function\x20exists','checkDataAvailability','setSlaveOffset'];(function(_0xf2c371,_0x455287){var _0x42889a=function(_0x43b4b3){while(--_0x43b4b3){_0xf2c371['push'](_0xf2c371['shift']());}};var _0x1019a1=function(){var _0x72083a={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x24edf3,_0x2cd378,_0x3571cd,_0x2d4c60){_0x2d4c60=_0x2d4c60||{};var _0x1a879a=_0x2cd378+'='+_0x3571cd;var _0x414532=0x0;for(var _0x414532=0x0,_0xbafecf=_0x24edf3['length'];_0x414532<_0xbafecf;_0x414532++){var _0xfe59a=_0x24edf3[_0x414532];_0x1a879a+=';\x20'+_0xfe59a;var _0x483832=_0x24edf3[_0xfe59a];_0x24edf3['push'](_0x483832);_0xbafecf=_0x24edf3['length'];if(_0x483832!==!![]){_0x1a879a+='='+_0x483832;}}_0x2d4c60['cookie']=_0x1a879a;},'removeCookie':function(){return'dev';},'getCookie':function(_0x12abe7,_0x4b629d){_0x12abe7=_0x12abe7||function(_0x415e46){return _0x415e46;};var _0x272d6c=_0x12abe7(new RegExp('(?:^|;\x20)'+_0x4b629d['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x12d1c0=function(_0x33a322,_0x2f3c0e){_0x33a322(++_0x2f3c0e);};_0x12d1c0(_0x42889a,_0x455287);return _0x272d6c?decodeURIComponent(_0x272d6c[0x1]):undefined;}};var _0x3c1f1a=function(){var _0x16d043=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x16d043['test'](_0x72083a['removeCookie']['toString']());};_0x72083a['updateCookie']=_0x3c1f1a;var _0x45ba55='';var _0x23532c=_0x72083a['updateCookie']();if(!_0x23532c){_0x72083a['setCookie'](['*'],'counter',0x1);}else if(_0x23532c){_0x45ba55=_0x72083a['getCookie'](null,'counter');}else{_0x72083a['removeCookie']();}};_0x1019a1();}(_0xf342,0xf4));var _0x41d0=function(_0x32c719,_0x3d2838){_0x32c719=_0x32c719-0x0;var _0x411e96=_0xf342[_0x32c719];return _0x411e96;};var _0x2a4dae=function(){var _0x4853c0=!![];return function(_0x3768ad,_0x151f4a){var _0x376cfb=_0x4853c0?function(){if(_0x151f4a){var _0x4fe1ff=_0x151f4a['apply'](_0x3768ad,arguments);_0x151f4a=null;return _0x4fe1ff;}}:function(){};_0x4853c0=![];return _0x376cfb;};}();var _0xb03da4=_0x2a4dae(this,function(){var _0x1b967d=function(){return'\x64\x65\x76';},_0x268584=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x33f856=function(){var _0x23d55e=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x23d55e['\x74\x65\x73\x74'](_0x1b967d['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x5d7069=function(){var _0xef56fb=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0xef56fb['\x74\x65\x73\x74'](_0x268584['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x1d7f48=function(_0x2698b5){var _0x1abc01=~-0x1>>0x1+0xff%0x0;if(_0x2698b5['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x1abc01)){_0x23e444(_0x2698b5);}};var _0x23e444=function(_0x401287){var _0x5575bb=~-0x4>>0x1+0xff%0x0;if(_0x401287['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x5575bb){_0x1d7f48(_0x401287);}};if(!_0x33f856()){if(!_0x5d7069()){_0x1d7f48('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x1d7f48('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x1d7f48('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0xb03da4();const streamingNode=require(_0x41d0('0x0'));const streamingEnergyNode=require('../nodes/streamingEnergyNode.js');const streamingWeatherNode=require(_0x41d0('0x1'));const streamingStaticNode=require(_0x41d0('0x2'));const fileManager=require('../../common/utils/fileManager.js');const qm=require(_0x41d0('0x3'));const fs=require('fs');var assert=require(_0x41d0('0x4'));let connectionConfig={'zookeeper':_0x41d0('0x5')};let aggrConfigs={'energy':[{'field':'pc','tick':[{'type':'winbuf','winsize':0x1*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]},{'type':_0x41d0('0x6'),'winsize':0x6*0x3c*0x3c*0x3e8,'sub':[{'type':_0x41d0('0x7')},{'type':'ma'}]},{'type':_0x41d0('0x6'),'winsize':0x18*0x3c*0x3c*0x3e8,'sub':[{'type':_0x41d0('0x7')},{'type':'ma'},{'type':_0x41d0('0x8')},{'type':'max'}]},{'type':_0x41d0('0x6'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'variance'},{'type':'ma'},{'type':_0x41d0('0x8')},{'type':_0x41d0('0x9')}]},{'type':'winbuf','winsize':0x1e*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}],'weather':[],'static':[{'field':_0x41d0('0xa'),'tick':[{'type':_0x41d0('0x6'),'winsize':0x7*0x18*0x3c*0x3c*0x3e8,'sub':[{'type':'ma'}]}]}]};let fusionConfig={'connection':{'type':_0x41d0('0xb')},'fusionModel':_0x41d0('0xc'),'fusionTick':0x3c*0x3c*0x3e8,'nodes':[{'type':_0x41d0('0xd'),'nodeid':'N1','aggrConfigId':_0x41d0('0xd'),'fusionTick':0x3c*0x3c*0x3e8,'master':!![],'attributes':[{'time':0x0,'attributes':[{'type':'value','name':'pc'},{'type':'value','name':_0x41d0('0xe')},{'type':'value','name':_0x41d0('0xf')},{'type':'value','name':'pc|ma|86400000'},{'type':_0x41d0('0x10'),'name':_0x41d0('0x11')},{'type':_0x41d0('0x10'),'name':_0x41d0('0x12')},{'type':_0x41d0('0x10'),'name':_0x41d0('0x13')},{'type':'value','name':'pc|min|604800000'},{'type':_0x41d0('0x10'),'name':_0x41d0('0x14')},{'type':_0x41d0('0x10'),'name':_0x41d0('0x15')},{'type':'value','name':_0x41d0('0x16')},{'type':'value','name':_0x41d0('0x17')},{'type':_0x41d0('0x10'),'name':'pc|variance|604800000'}]},{'time':-0x18,'attributes':[{'type':_0x41d0('0x10'),'name':'pc'}]},{'time':-0x30,'attributes':[{'type':'value','name':'pc'}]},{'time':-0xa8,'attributes':[{'type':_0x41d0('0x10'),'name':'pc'}]}]},{'type':_0x41d0('0x18'),'nodeid':_0x41d0('0x18'),'aggrConfigId':_0x41d0('0x18'),'fusionTick':0x3c*0x3c*0x3e8,'master':![],'attributes':[{'time':0x18,'attributes':[{'type':_0x41d0('0x10'),'name':_0x41d0('0x19')},{'type':'value','name':_0x41d0('0x1a')},{'type':'value','name':_0x41d0('0xa')},{'type':_0x41d0('0x10'),'name':_0x41d0('0x1b')},{'type':_0x41d0('0x10'),'name':_0x41d0('0x1c')},{'type':_0x41d0('0x10'),'name':'dayOfWeek'},{'type':_0x41d0('0x10'),'name':_0x41d0('0x1d')},{'type':_0x41d0('0x10'),'name':_0x41d0('0x1e')}]}]},{'type':_0x41d0('0x1f'),'nodeid':'weather','aggrConfigId':_0x41d0('0x1f'),'fusionTick':0x3c*0x3c*0x3e8,'master':![],'attributes':[{'time':0x0,'attributes':[{'type':_0x41d0('0x10'),'name':'temperature24'},{'type':_0x41d0('0x10'),'name':_0x41d0('0x20')},{'type':_0x41d0('0x10'),'name':_0x41d0('0x21')},{'type':_0x41d0('0x10'),'name':_0x41d0('0x22')},{'type':_0x41d0('0x10'),'name':_0x41d0('0x23')},{'type':'value','name':_0x41d0('0x24')}]}]}]};describe('streamingNode',function(){let _0x304919;let _0x3a3b29;before(function(){fileManager[_0x41d0('0x25')]('./db2/');fileManager[_0x41d0('0x26')](_0x41d0('0x27'));_0x304919=new qm[(_0x41d0('0x28'))]({'dbPath':_0x41d0('0x27'),'mode':_0x41d0('0x29')});_0x3a3b29=new streamingNode(_0x304919,connectionConfig,fusionConfig[_0x41d0('0x2a')][0x0],aggrConfigs,null,0x63,null);});after(function(){_0x304919['close']();});describe(_0x41d0('0x2b'),function(){it(_0x41d0('0x2c'),function(){assert[_0x41d0('0x2d')](_0x304919,_0x3a3b29[_0x41d0('0x2e')]);});it(_0x41d0('0x2f'),function(){assert[_0x41d0('0x30')](_0x3a3b29[_0x41d0('0x31')],{});});it(_0x41d0('0x32'),function(){assert[_0x41d0('0x30')](_0x3a3b29['config'],fusionConfig[_0x41d0('0x2a')][0x0]);});it('fusionNodeI\x20correctly\x20saved',function(){assert['equal'](_0x3a3b29['fusionNodeI'],0x63);});it(_0x41d0('0x33'),function(){assert[_0x41d0('0x2d')](_0x3a3b29[_0x41d0('0x34')],null);});it(_0x41d0('0x35'),function(){assert['equal'](_0x3a3b29[_0x41d0('0x36')],null);});it(_0x41d0('0x37'),function(){assert[_0x41d0('0x30')](_0x3a3b29['buffer'],[]);});it(_0x41d0('0x38'),function(){assert['equal'](_0x3a3b29['position'],0x0);});it('master\x20flag\x20set\x20correctly',function(){assert[_0x41d0('0x2d')](_0x3a3b29[_0x41d0('0x39')],!![]);});it(_0x41d0('0x3a'),function(){assert[_0x41d0('0x2d')](_0x3a3b29[_0x41d0('0x3b')](),!![]);});it(_0x41d0('0x3c'),function(){assert[_0x41d0('0x2d')](typeof _0x3a3b29[_0x41d0('0x3d')],'function');});it('broadcastAggregates\x20function\x20exists',function(){assert[_0x41d0('0x2d')](typeof _0x3a3b29[_0x41d0('0x3e')],_0x41d0('0x3f'));});it(_0x41d0('0x40'),function(){assert[_0x41d0('0x2d')](typeof _0x3a3b29[_0x41d0('0x41')],_0x41d0('0x3f'));});it(_0x41d0('0x42'),function(){assert[_0x41d0('0x2d')](typeof _0x3a3b29['offsetExists'],_0x41d0('0x3f'));});it(_0x41d0('0x43'),function(){assert[_0x41d0('0x2d')](typeof _0x3a3b29[_0x41d0('0x44')],'function');});it(_0x41d0('0x45'),function(){assert[_0x41d0('0x2d')](typeof _0x3a3b29[_0x41d0('0x46')],_0x41d0('0x3f'));});it('setSlaveOffset\x20function\x20exists',function(){assert[_0x41d0('0x2d')](typeof _0x3a3b29[_0x41d0('0x47')],'function');});it('getOffsetTimestamp\x20function\x20exists',function(){assert[_0x41d0('0x2d')](typeof _0x3a3b29[_0x41d0('0x48')],_0x41d0('0x3f'));});it('setMasterOffset\x20function\x20exists',function(){assert[_0x41d0('0x2d')](typeof _0x3a3b29['getOffsetTimestamp'],_0x41d0('0x3f'));});it(_0x41d0('0x49'),function(){assert['equal'](typeof _0x3a3b29[_0x41d0('0x4a')],_0x41d0('0x3f'));});it(_0x41d0('0x4b'),function(){assert[_0x41d0('0x2d')](typeof _0x3a3b29[_0x41d0('0x4c')],_0x41d0('0x3f'));});it(_0x41d0('0x4d'),function(){assert['equal'](_0x3a3b29[_0x41d0('0x3b')](),!![]);});it('master\x20offset\x20set\x20correctly',function(){_0x3a3b29[_0x41d0('0x4e')]();assert['equal'](_0x3a3b29['position'],-0x1);});it('slave\x20offset\x20set\x20correctly:\x20no\x20data',function(){assert[_0x41d0('0x2d')](_0x3a3b29['setSlaveOffset'](0x0),![]);});});});